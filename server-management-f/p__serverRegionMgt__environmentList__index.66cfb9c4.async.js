"use strict";(self.webpackChunkservermgmt=self.webpackChunkservermgmt||[]).push([[835],{41379:function($,P,e){var b=e(26068),n=e.n(b),f=e(48305),d=e.n(f),h=e(90801),u=e(27610),l=e(82113),c=e(50959),T=e(11527),g=function(o){var i,s,v,D,O,L=o.label,B=o.syncUrlParams,fe=B===void 0?!0:B,K=o.disabled,k=K===void 0?!1:K,q=o.display,ee=q===void 0?!0:q,ne=(0,h.useModel)("@@initialState"),j=ne.initialState,V=ne.setInitialState,U=(0,l.Z)("tenantid",{defaultValue:"502",serializer:function(_){return _},deserializer:function(_){return _}}),R=d()(U,2),w=R[0],re=R[1],Z=(0,l.Z)("tenant",{defaultValue:"",serializer:function(_){return _},deserializer:function(_){return _}}),te=d()(Z,2),_e=te[0],ae=te[1],ue=(j==null||(i=j.bizListData)===null||i===void 0?void 0:i.data)||[],z=(s=(v=j==null?void 0:j.currentBizId)!==null&&v!==void 0?v:w)!==null&&s!==void 0?s:"502",t=(D=(O=j==null?void 0:j.currentBizName)!==null&&O!==void 0?O:_e)!==null&&D!==void 0?D:"",he=(0,h.useSearchParams)(),se=d()(he,2),H=se[0],le=se[1];return(0,c.useEffect)(function(){var F=new URLSearchParams(H.toString());F.set("tenantid",z),F.set("tenant",t),le(F),re(z),ae(t)},[z,t]),(0,T.jsx)(u.Z,{name:"tenantid",label:L,showSearch:!0,allowClear:!1,fieldProps:{defaultValue:z,disabled:k},valueEnum:ue.reduce(function(F,_){return F[_.biz_id]=_.biz_cn_name,F},{}),style:n()({width:200},ee?{}:{display:"none"}),placeholder:"\u8BF7\u9009\u62E9\u9879\u76EE",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9879\u76EE"}],onChange:function(_,ge){if(fe){var G=ge.title,I=new URLSearchParams(H.toString());I.set("tenantid",_),I.set("tenant",G),le(I),re(_),ae(G),V(n()(n()({},j),{},{currentBizId:_,currentBizName:G}))}}})};P.Z=g},60602:function($,P,e){e.d(P,{j:function(){return n}});var b=e(90801);function n(f,d,h,u,l){var c=(0,b.useRequest)(f(d,h),{manual:!0,onSuccess:function(o){var i,s;o.code!==-1&&(l==null||l.success(o.msg)),u==null||(i=u.current)===null||i===void 0||(s=i.reloadAndRest)===null||s===void 0||s.call(i)},onError:function(){l==null||l.error("\u64CD\u4F5C\u5931\u8D25")}}),T=c.run,g=c.loading;return{runOpt:T,loading:g}}},16934:function($,P,e){e.d(P,{t:function(){return b}});var b=function(n){return n[n.Development=0]="Development",n[n.Test=1]="Test",n[n.Production=2]="Production",n}({})},8974:function($,P,e){e.r(P),e.d(P,{default:function(){return ge}});var b=e(90228),n=e.n(b),f=e(26068),d=e.n(f),h=e(87999),u=e.n(h),l=e(48305),c=e.n(l),T=e(41379),g=e(60602),M=e(12876),o=e(58207),i=e(41841),s=e(94071),v=e(90801),D=e(40460),O=e(75343),L=e(16030),B=e(31381),fe=e(44599),K=e(47698),k=e(38546),q=e(12400),ee=e(54748),ne=e(63463),j=e(41268),V=e(50159),U=e(50959),R=e(16934),w=e(49547),re=e(78420),Z=e(19014),te=e(27610),_e=e(34927),ae=e(20902),ue=e(36735),z=e(13179),t=e(11527),he=(0,z.kc)(function(){return{IDIPContainer:{"& .ant-space-item:first-child":{flex:1}}}}),se=function(I){var N=I.mode,J=I.initialValues,ie=I.onFinish,Ee=I.trigger,Pe=w.A.useForm(),De=c()(Pe,1),S=De[0],Q=he(),oe=Q.styles,Ie=K.ZP.useMessage(),de=c()(Ie,2),X=de[0],be=de[1],Oe=(0,U.useState)(!1),Y=c()(Oe,2),Fe=Y[0],ce=Y[1],Ae=(0,U.useState)(!1),ve=c()(Ae,2),Ce=ve[0],me=ve[1],je=(0,U.useRef)(),A=(0,g.j)(M._q,"/".concat(o.Hg,"/cmdb/cbb_area/env/idip/check/"),"POST",je,X),m=A.runOpt,C=function(){var p=u()(n()().mark(function a(){var E;return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(E=S.getFieldValue("idip"),E){r.next=4;break}return X.warning("\u8BF7\u5148\u8F93\u5165\u5185\u90E8IDIP\u5730\u5740"),r.abrupt("return");case 4:return ce(!0),r.prev=5,r.next=8,m({idip:E});case 8:r.next=13;break;case 10:r.prev=10,r.t0=r.catch(5),console.log("\u5185\u90E8IDIP\u8FDE\u63A5\u6D4B\u8BD5\u5931\u8D25");case 13:return r.prev=13,ce(!1),r.finish(13);case 16:case"end":return r.stop()}},a,null,[[5,10,13,16]])}));return function(){return p.apply(this,arguments)}}(),y=function(){var p=u()(n()().mark(function a(){var E;return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(E=S.getFieldValue("client_idip"),E){r.next=4;break}return X.warning("\u8BF7\u5148\u8F93\u5165\u5BA2\u6237\u7AEFIDIP\u5730\u5740"),r.abrupt("return");case 4:return me(!0),r.prev=5,r.next=8,m({idip:E});case 8:r.next=13;break;case 10:r.prev=10,r.t0=r.catch(5),console.log("\u5BA2\u6237\u7AEFIDIP\u8FDE\u63A5\u6D4B\u8BD5\u5931\u8D25");case 13:return r.prev=13,me(!1),r.finish(13);case 16:case"end":return r.stop()}},a,null,[[5,10,13,16]])}));return function(){return p.apply(this,arguments)}}();return(0,t.jsxs)(re.a,{title:N==="create"?"\u65B0\u5EFA\u73AF\u5883":"\u7F16\u8F91\u73AF\u5883",form:S,drawerProps:{maskClosable:!1},onOpenChange:function(a){a?N==="create"?S.setFieldsValue({is_test:!0}):N==="edit"&&J&&S.setFieldsValue(J):S.resetFields()},onFinish:function(){var p=u()(n()().mark(function a(E){var W;return n()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,ie(E);case 2:if(W=x.sent,!W){x.next=5;break}return x.abrupt("return",!0);case 5:return x.abrupt("return",!1);case 6:case"end":return x.stop()}},a)}));return function(a){return p.apply(this,arguments)}}(),layout:"horizontal",labelCol:{flex:"120px"},trigger:Ee,width:1e3,children:[be,(0,t.jsx)(Z.Z,{name:"env_name",label:"\u73AF\u5883\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u73AF\u5883\u540D\u79F0",fieldProps:{maxLength:50},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u73AF\u5883\u540D\u79F0"}]}),(0,t.jsx)(te.Z,{name:"env_tags",label:"\u73AF\u5883\u6807\u7B7E",mode:"tags",placeholder:"\u8BF7\u8F93\u5165/\u9009\u62E9\u73AF\u5883\u6807\u7B7E\uFF0C\u652F\u6301\u591A\u4E2A\u6807\u7B7E",fieldProps:{maxTagCount:5,tokenSeparators:[","],onChange:function(a){Array.isArray(a)&&a.length>20&&(K.ZP.warning("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E"),S.setFieldsValue({tags:a.slice(0,20)}))}},rules:[{validator:function(){var p=u()(n()().mark(function E(W,r){return n()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(!(Array.isArray(r)&&r.length>20)){pe.next=2;break}throw new Error("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E");case 2:case"end":return pe.stop()}},E)}));function a(E,W){return p.apply(this,arguments)}return a}()}]}),(0,t.jsx)(_e.Z.Group,{name:"env_type",label:"\u73AF\u5883\u7C7B\u578B",options:[{label:s.MD[R.t.Production],value:R.t.Production},{label:s.MD[R.t.Test],value:R.t.Test},{label:s.MD[R.t.Development],value:R.t.Development}],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73AF\u5883\u7C7B\u578B"}],required:!0}),(0,t.jsx)(w.A.Item,{label:"\u5185\u90E8IDIP\u5730\u5740",required:!0,style:{width:"100%"},children:(0,t.jsxs)(ue.Z,{style:{width:"100%"},className:oe.IDIPContainer,children:[(0,t.jsx)(Z.Z,{name:"idip",placeholder:"\u8BF7\u8F93\u5165\u5185\u90E8IDIP\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u90E8IDIP\u5730\u5740"}],noStyle:!0}),(0,t.jsx)(V.ZP,{type:"primary",onClick:C,loading:Fe,children:"\u6D4B\u8BD5\u8FDE\u63A5"})]})}),(0,t.jsx)(Z.Z,{name:"app_id",label:"\u5185\u90E8AppID",placeholder:"\u8BF7\u8F93\u5165\u5185\u90E8AppID",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u90E8AppID"}]}),(0,t.jsx)(Z.Z,{name:"app_secret",label:"\u5185\u90E8AppSecret",placeholder:"\u8BF7\u8F93\u5165\u5185\u90E8AppSecret",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u90E8AppSecret"}]}),(0,t.jsx)(w.A.Item,{label:"\u5BA2\u6237\u7AEFIDIP\u5730\u5740",required:!0,style:{width:"100%"},children:(0,t.jsxs)(ue.Z,{style:{width:"100%"},className:oe.IDIPContainer,children:[(0,t.jsx)(Z.Z,{name:"client_idip",placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u7AEFIDIP\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BA2\u6237\u7AEFIDIP\u5730\u5740"}],noStyle:!0}),(0,t.jsx)(V.ZP,{type:"primary",onClick:y,loading:Ce,children:"\u6D4B\u8BD5\u8FDE\u63A5"})]})}),(0,t.jsx)(ae.Z,{name:"ext_info",label:"\u6269\u5C55\u4FE1\u606F",placeholder:"\u8BF7\u8F93\u5165\u6269\u5C55\u4FE1\u606F",fieldProps:{maxLength:500}})]})},H=se,le=e(60996);function F(){return(0,le.Jl)("/".concat(o.Hg,"/cmdb/cbb_area/env/"))}var _=function(){var I=(0,U.useRef)(),N=(0,U.useState)(""),J=c()(N,2),ie=J[0],Ee=J[1],Pe=(0,fe.Z)(ie,{wait:300}),De=K.ZP.useMessage(),S=c()(De,2),Q=S[0],oe=S[1],Ie=(0,v.useSearchParams)(),de=c()(Ie,1),X=de[0],be=(0,i.f)(),Oe=be.styles,Y=(0,g.j)(M._q,"/".concat(o.Hg,"/cmdb/cbb_area/env/"),"DELETE",I,Q),Fe=Y.runOpt,ce=Y.loading,Ae=(0,g.j)(M._q,"/".concat(o.Hg,"/cmdb/cbb_area/env/"),"PUT",I,Q),ve=Ae.runOpt,Ce=(0,g.j)(M._q,"/".concat(o.Hg,"/cmdb/cbb_area/env/"),"POST",I,Q),me=Ce.runOpt;(0,U.useEffect)(function(){var A,m;(A=I.current)===null||A===void 0||(m=A.reset)===null||m===void 0||m.call(A)},[X]);var je=[{title:"\u73AF\u5883\u540D\u79F0",dataIndex:"env_name",width:150,render:function(m){return(0,t.jsx)(k.Z,{title:m,children:(0,t.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden",textOverflow:"ellipsis"},children:m})})}},{title:"\u73AF\u5883\u6807\u7B7E",dataIndex:"env_tags",width:200,render:function(m,C){var y,p;return(0,t.jsx)(k.Z,{title:((y=C.env_tags)!==null&&y!==void 0?y:[]).join(", "),children:(0,t.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden",textOverflow:"ellipsis"},children:((p=C.env_tags)!==null&&p!==void 0?p:[]).map(function(a){return(0,t.jsx)(q.Z,{style:{marginTop:"4px",marginBottom:"4px"},children:a},a)})})})}},{title:"\u73AF\u5883\u7C7B\u578B",dataIndex:"env_type",width:100,render:function(m,C){return(0,s.nt)(C.env_type)}},{title:"\u5185\u90E8IDIP\u5730\u5740",dataIndex:"idip",width:350},{title:"\u5BA2\u6237\u7AEFIDIP\u5730\u5740",dataIndex:"client_idip",width:350},{title:"\u6269\u5C55\u4FE1\u606F",dataIndex:"ext_info",ellipsis:!0,width:200},{title:"\u64CD\u4F5C",width:180,key:"option",valueType:"option",fixed:"right",render:function(m,C){return[(0,t.jsx)(H,{mode:"edit",initialValues:C,onFinish:function(){var y=u()(n()().mark(function p(a){var E;return n()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,ve(d()(d()({},a),{},{id:C.id}));case 2:if(E=r.sent,!E){r.next=5;break}return r.abrupt("return",!0);case 5:return r.abrupt("return",!1);case 6:case"end":return r.stop()}},p)}));return function(p){return y.apply(this,arguments)}}(),trigger:(0,t.jsx)(ee.Z.Link,{children:"\u7F16\u8F91"})},"edit"),(0,t.jsx)(ne.Z,{title:"\u5220\u9664\u73AF\u5883",description:'\u786E\u5B9A\u8981\u5220\u9664\u73AF\u5883 "'.concat(C.env_name,'" \u5417\uFF1F'),onConfirm:function(){return Fe({id_list:[C.id]})},okButtonProps:{loading:ce},children:(0,t.jsx)(ee.Z.Link,{type:"danger",children:"\u5220\u9664"})},"delete")]}}];return(0,t.jsxs)(L._z,{title:!1,extra:(0,t.jsx)(T.Z,{}),className:Oe.pageContainer,children:[oe,(0,t.jsx)(B.Z,{actionRef:I,params:{searchValue:Pe},rowKey:"id",search:!1,toolbar:{search:(0,t.jsx)(j.Z,{prefix:(0,t.jsx)(D.Z,{}),style:{width:400},placeholder:"\u6A21\u7CCA\u641C\u7D22\u73AF\u5883\u540D\u3001\u73AF\u5883\u7F16\u53F7\u3001\u73AF\u5883\u6807\u7B7E\u3001\u6269\u5C55\u4FE1\u606F",allowClear:!0,value:ie,onChange:function(m){return Ee(m.target.value)}}),actions:[(0,t.jsx)(H,{mode:"create",onFinish:function(){var A=u()(n()().mark(function m(C){var y;return n()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,me(C);case 2:if(y=a.sent,!y){a.next=5;break}return a.abrupt("return",!0);case 5:return a.abrupt("return",!1);case 6:case"end":return a.stop()}},m)}));return function(m){return A.apply(this,arguments)}}(),trigger:(0,t.jsx)(V.ZP,{type:"primary",icon:(0,t.jsx)(O.Z,{}),children:"\u65B0\u5EFA\u73AF\u5883"})},"create")]},request:F(),columns:je,scroll:{x:1200},pagination:{defaultPageSize:10,showSizeChanger:!0}})]})},ge=_},12876:function($,P,e){e.d(P,{B9:function(){return l},RT:function(){return c},Rm:function(){return i},_q:function(){return o},xA:function(){return T}});var b=e(90228),n=e.n(b),f=e(87999),d=e.n(f),h=e(58207),u=e(60996);function l(v,D){return v?(0,u.Jl)("/".concat(h.Hg,"/cmdb/cbb_area/big_area/"),{env_id:v,env_type:D}):d()(n()().mark(function O(){return n()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.abrupt("return",{data:[],success:!0,total:0});case 1:case"end":return B.stop()}},O)}))}function c(v,D){return(0,u.Jl)("/".concat(h.Hg,"/cmdb/cbb_area/area/"),{env_id:v,big_area:D})}function T(v){return g.apply(this,arguments)}function g(){return g=d()(n()().mark(function v(D){return n()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.abrupt("return",(0,u.dT)("/".concat(h.Hg,"/cmdb/cbb_area/big_area/detail/"),D));case 1:case"end":return L.stop()}},v)})),g.apply(this,arguments)}function M(){return commonGetListForTable2("/api/job/v1/flow/design/draft/")}function o(v,D){return(0,u.S_)(v,D)}function i(){return s.apply(this,arguments)}function s(){return s=d()(n()().mark(function v(){return n()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.abrupt("return",(0,u.dT)("/".concat(h.Hg,"/cmdb/cbb_area/env/list/")));case 1:case"end":return O.stop()}},v)})),s.apply(this,arguments)}},41841:function($,P,e){e.d(P,{f:function(){return h}});var b=e(53649),n=e.n(b),f=e(13179),d,h=(0,f.kc)(function(u){var l=u.css;return{pageContainer:{"& .ant-page-header-heading-extra":l(d||(d=n()([`
      position: absolute;
      top: 17px;
      right: 20px;
    `])))}}})},94071:function($,P,e){e.d(P,{Dv:function(){return M},MD:function(){return c},nt:function(){return g}});var b=e(82092),n=e.n(b),f=e(16934),d=e(12400),h=e(38546),u=e(50959),l=e(11527),c=n()(n()(n()({},f.t.Production,"\u6B63\u5F0F"),f.t.Test,"\u6D4B\u8BD5"),f.t.Development,"\u5F00\u53D1"),T=function(i){var s=n()(n()(n()({},f.t.Production,"red"),f.t.Test,"blue"),f.t.Development,"green");return s[i]},g=function(i){return(0,l.jsx)(d.Z,{color:T(i),children:c[i]})},M=function(i,s){return(0,l.jsx)(h.Z,{title:s,children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:2,overflow:"hidden"},children:[g(i),(0,l.jsx)("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s})]})})}}}]);
