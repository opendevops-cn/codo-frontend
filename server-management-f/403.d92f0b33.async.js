"use strict";(self.webpackChunkservermgmt=self.webpackChunkservermgmt||[]).push([[403],{35748:function(G,h,e){var O=e(35361),n=e(56929),p=e(50959),u=e(5087),P=e(11527),r=["fieldProps","min","proFieldProps","max"],s=function(a,K){var i=a.fieldProps,t=a.min,l=a.proFieldProps,d=a.max,f=(0,n.Z)(a,r);return(0,P.jsx)(u.Z,(0,O.Z)({valueType:"digit",fieldProps:(0,O.Z)({min:t,max:d},i),ref:K,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:l},f))},b=p.forwardRef(s);h.Z=b},41379:function(G,h,e){var O=e(26068),n=e.n(O),p=e(48305),u=e.n(p),P=e(90801),r=e(27610),s=e(82113),b=e(50959),j=e(11527),a=function(i){var t,l,d,f,B,$=i.label,o=i.syncUrlParams,Y=o===void 0?!0:o,k=i.disabled,z=k===void 0?!1:k,S=i.display,U=S===void 0?!0:S,w=(0,P.useModel)("@@initialState"),L=w.initialState,H=w.setInitialState,q=(0,s.Z)("tenantid",{defaultValue:"502",serializer:function(C){return C},deserializer:function(C){return C}}),Q=u()(q,2),V=Q[0],T=Q[1],R=(0,s.Z)("tenant",{defaultValue:"",serializer:function(C){return C},deserializer:function(C){return C}}),g=u()(R,2),W=g[0],x=g[1],M=(L==null||(t=L.bizListData)===null||t===void 0?void 0:t.data)||[],_=(l=(d=L==null?void 0:L.currentBizId)!==null&&d!==void 0?d:V)!==null&&l!==void 0?l:"502",ee=(f=(B=L==null?void 0:L.currentBizName)!==null&&B!==void 0?B:W)!==null&&f!==void 0?f:"",oe=(0,P.useSearchParams)(),te=u()(oe,2),J=te[0],y=te[1];return(0,b.useEffect)(function(){var I=new URLSearchParams(J.toString());I.set("tenantid",_),I.set("tenant",ee),y(I),T(_),x(ee)},[_,ee]),(0,j.jsx)(r.Z,{name:"tenantid",label:$,showSearch:!0,allowClear:!1,fieldProps:{defaultValue:_,disabled:z},valueEnum:M.reduce(function(I,C){return I[C.biz_id]=C.biz_cn_name,I},{}),style:n()({width:200},U?{}:{display:"none"}),placeholder:"\u8BF7\u9009\u62E9\u9879\u76EE",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9879\u76EE"}],onChange:function(C,re){if(Y){var ne=re.title,_e=new URLSearchParams(J.toString());_e.set("tenantid",C),_e.set("tenant",ne),y(_e),T(C),x(ne),H(n()(n()({},L),{},{currentBizId:C,currentBizName:ne}))}}})};h.Z=a},60602:function(G,h,e){e.d(h,{j:function(){return n}});var O=e(90801);function n(p,u,P,r,s){var b=(0,O.useRequest)(p(u,P),{manual:!0,onSuccess:function(i){var t,l;i.code!==-1&&(s==null||s.success(i.msg)),r==null||(t=r.current)===null||t===void 0||(l=t.reloadAndRest)===null||l===void 0||l.call(t)},onError:function(){s==null||s.error("\u64CD\u4F5C\u5931\u8D25")}}),j=b.run,a=b.loading;return{runOpt:j,loading:a}}},16934:function(G,h,e){e.d(h,{t:function(){return O}});var O=function(n){return n[n.Development=0]="Development",n[n.Test=1]="Test",n[n.Production=2]="Production",n}({})},66777:function(G,h,e){var O=e(90228),n=e.n(O),p=e(87999),u=e.n(p),P=e(26068),r=e.n(P),s=e(48305),b=e.n(s),j=e(94071),a=e(49547),K=e(78420),i=e(27610),t=e(19014),l=e(35748),d=e(34927),f=e(20902),B=e(47698),$=e(50959),o=e(11527),Y=function(z){var S=z.mode,U=z.initialValues,w=z.onFinish,L=z.trigger,H=z.environmentOptions,q=a.A.useForm(),Q=b()(q,1),V=Q[0];return(0,o.jsxs)(K.a,{title:S==="create"?"\u65B0\u5EFA\u5927\u533A":"\u7F16\u8F91\u5927\u533A",form:V,drawerProps:{maskClosable:!1},onOpenChange:function(R){R?S==="create"?V.setFieldsValue({visible:!0,is_test:!0,enable:!0,env_id:U==null?void 0:U.env_id}):S==="edit"&&U&&V.setFieldsValue(r()(r()({},U),{},{env_id:Number(U==null?void 0:U.env_id)})):V.resetFields()},onFinish:function(){var T=u()(n()().mark(function R(g){var W;return n()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,w(g);case 2:if(W=M.sent,!W){M.next=5;break}return M.abrupt("return",!0);case 5:return M.abrupt("return",!1);case 6:case"end":return M.stop()}},R)}));return function(R){return T.apply(this,arguments)}}(),layout:"horizontal",labelCol:{span:4},trigger:L,children:[(0,o.jsx)(i.Z,{name:"env_id",label:"\u73AF\u5883",options:(H!=null?H:[]).map(function(T){return r()(r()({},T),{},{label:(0,j.Dv)(T.env_type,T.label)})}),disabled:S==="edit",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73AF\u5883"}]}),(0,o.jsx)(t.Z,{name:"name",label:"\u5927\u533A\u540D",placeholder:"\u8BF7\u8F93\u5165\u5927\u533A\u540D\u79F0",fieldProps:{maxLength:100},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5927\u533A\u540D\u79F0"}]}),(0,o.jsx)(t.Z,{name:"big_area",label:"\u5927\u533A\u7F16\u53F7",placeholder:"\u8BF7\u8F93\u5165\u5927\u533A\u7F16\u53F7",fieldProps:{maxLength:50,disabled:S==="edit"},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5927\u533A\u7F16\u53F7"},{validator:function(){var T=u()(n()().mark(function g(W,x){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:case 1:case"end":return _.stop()}},g)}));function R(g,W){return T.apply(this,arguments)}return R}()}]}),(0,o.jsx)(i.Z,{name:"tags",label:"\u5927\u533A\u6807\u7B7E",mode:"tags",placeholder:"\u8BF7\u8F93\u5165/\u9009\u62E9\u5927\u533A\u6807\u7B7E\uFF0C\u652F\u6301\u591A\u4E2A\u6807\u7B7E",fieldProps:{maxTagCount:5,tokenSeparators:[","],onChange:function(R){Array.isArray(R)&&R.length>20&&(B.ZP.warning("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E"),V.setFieldsValue({tags:R.slice(0,20)}))}},rules:[{validator:function(){var T=u()(n()().mark(function g(W,x){return n()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(!(Array.isArray(x)&&x.length>20)){_.next=2;break}throw new Error("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E");case 2:case"end":return _.stop()}},g)}));function R(g,W){return T.apply(this,arguments)}return R}()}]}),(0,o.jsx)(t.Z,{name:"idip",label:"IDIP\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165IDIP\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165IDIP\u5730\u5740"}]}),(0,o.jsx)(t.Z,{name:"app_secret",label:"AppSecret",placeholder:"\u8BF7\u8F93\u5165AppSecret",rules:[{required:!0,message:"\u8BF7\u8F93\u5165AppSecret"}]}),(0,o.jsx)(t.Z,{name:"address",label:"ping\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165\u5927\u533A\u5730\u5740\uFF0C\u53EF\u7528\u4E8Eping\u5927\u533A\u5EF6\u8FDF",fieldProps:{maxLength:50}}),(0,o.jsx)(l.Z,{name:"utc_offset",label:"UTC\u65F6\u95F4\u504F\u79FB",min:-12,max:14,fieldProps:{precision:0},rules:[{required:!0,message:"\u8BF7\u8F93\u5165UTC\u65F6\u95F4\u504F\u79FB"}]}),(0,o.jsx)(d.Z.Group,{name:"visible",label:"\u73A9\u5BB6\u53EF\u89C1",options:[{label:"\u662F",value:!0},{label:"\u5426",value:!1}],required:!0}),(0,o.jsx)(t.Z,{name:"protocol_converter_host",label:"GM\u56DE\u8C03\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165GM\u56DE\u8C03\u5730\u5740",fieldProps:{maxLength:1e3}}),(0,o.jsx)(f.Z,{name:"ext",label:"\u6269\u5C55\u4FE1\u606F",placeholder:"\u8BF7\u8F93\u5165\u6269\u5C55\u4FE1\u606F",fieldProps:{maxLength:500}})]})};h.Z=Y},92403:function(G,h,e){var O=e(26068),n=e.n(O),p=e(82092),u=e.n(p),P=e(90228),r=e.n(P),s=e(87999),b=e.n(s),j=e(48305),a=e.n(j),K=e(41379),i=e(60602),t=e(58207),l=e(41841),d=e(94071),f=e(90801),B=e(40460),$=e(75343),o=e(16030),Y=e(31381),k=e(2533),z=e(82113),S=e(44599),U=e(47698),w=e(38546),L=e(12400),H=e(54748),q=e(63463),Q=e(94770),V=e(98984),T=e(41268),R=e(50159),g=e(50959),W=e(16934),x=e(66777),M=e(12876),_=e(11527),ee=function(te){var J=te.envType,y=(0,g.useRef)(),I=(0,g.useState)(""),C=a()(I,2),re=C[0],ne=C[1],_e=(0,z.Z)("cmdb-current-environment-id-".concat(J),{defaultValue:void 0}),ie=a()(_e,2),Z=ie[0],se=ie[1],fe=(0,g.useState)([]),de=a()(fe,2),ae=de[0],De=de[1],Oe=(0,S.Z)(re,{wait:300}),ge=U.ZP.useMessage(),me=a()(ge,2),ue=me[0],Me=me[1],he=(0,f.useSearchParams)(),be=a()(he,1),Ce=be[0],Le=(0,g.useState)(!1),pe=a()(Le,2),Te=pe[0],Re=pe[1],Ae=(0,g.useState)(!0),Ee=a()(Ae,2),le=Ee[0],ve=Ee[1],Be=(0,l.f)(),Ie=Be.styles,ce=Ce.get("tenantid"),je=function(){var E=b()(r()().mark(function v(){var c,m,D;return r()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return ve(!0),A.prev=1,A.next=4,(0,M.Rm)();case 4:c=A.sent,m=c.filter(function(N){return N.env_type===J}),De(m.map(function(N){return{label:N.env_name,value:Number(N.id),env_type:N.env_type}})),D=(m!=null?m:[]).map(function(N){return N.id}),D.length>0?se(Z&&D.includes(Z)?Z:D[0]):se(void 0),A.next=15;break;case 11:A.prev=11,A.t0=A.catch(1),console.error("Failed to fetch environment list:",A.t0),ue.error("\u83B7\u53D6\u73AF\u5883\u5217\u8868\u5931\u8D25");case 15:return A.prev=15,ve(!1),A.finish(15);case 18:case"end":return A.stop()}},v,null,[[1,11,15,18]])}));return function(){return E.apply(this,arguments)}}();(0,g.useEffect)(function(){ce&&je()},[ce]),(0,g.useEffect)(function(){var E;y!=null&&(E=y.current)!==null&&E!==void 0&&E.reset&&y.current.reset()},[Z]);var Pe=(0,i.j)(M._q,"/".concat(t.Hg,"/cmdb/cbb_area/big_area/"),"DELETE",y,ue),Ue=Pe.runOpt,We=Pe.loading,Fe=(0,i.j)(M._q,"/".concat(t.Hg,"/cmdb/cbb_area/big_area/"),"PUT",y,ue),Ke=Fe.runOpt,Se=(0,i.j)(M._q,"/".concat(t.Hg,"/cmdb/cbb_area/big_area/"),"POST",y,ue),xe=Se.runOpt,ye=[{title:"\u5927\u533A\u540D",dataIndex:"name",width:150,render:function(v,c){var m=u()(u()(u()({},W.t.Development,"developmentServerRegion"),W.t.Test,"testServerRegion"),W.t.Production,"productionServerRegion");return(0,_.jsx)(f.Link,{to:"/serverRegionMgt/".concat(m[J],"/").concat(c.big_area,"?env_id=").concat(Z),children:v})}},{title:"\u5927\u533A\u7F16\u53F7",dataIndex:"big_area",ellipsis:!0,width:200},{title:"\u5927\u533A\u6807\u7B7E",dataIndex:"tags",width:200,render:function(v,c){var m,D;return(0,_.jsx)(w.Z,{title:((m=c.tags)!==null&&m!==void 0?m:[]).join(", "),children:(0,_.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden",textOverflow:"ellipsis"},children:((D=c.tags)!==null&&D!==void 0?D:[]).map(function(F){return(0,_.jsx)(L.Z,{style:{marginTop:"4px",marginBottom:"4px"},children:F},F)})})})}},{title:"\u73A9\u5BB6\u53EF\u89C1",dataIndex:"visible",width:90,render:function(v){return v?(0,_.jsx)(L.Z,{color:"green",children:"\u662F"}):(0,_.jsx)(L.Z,{color:"red",children:"\u5426"})}},{title:"UTC\u65F6\u95F4\u504F\u79FB",dataIndex:"utc_offset",width:100},{title:"IDIP\u5730\u5740",dataIndex:"idip",width:350},{title:"ping\u5730\u5740",dataIndex:"address",width:200},{title:"GM\u56DE\u8C03\u5730\u5740",dataIndex:"protocol_converter_host",width:200,render:function(v,c){return(0,_.jsx)(w.Z,{title:c.protocol_converter_host,children:(0,_.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden",textOverflow:"ellipsis"},children:c.protocol_converter_host})})}},{title:"\u6269\u5C55\u4FE1\u606F",dataIndex:"ext",ellipsis:!0,width:200},{title:"\u64CD\u4F5C",width:120,dataIndex:"option",valueType:"option",fixed:"right",render:function(v,c){return[(0,_.jsx)(x.Z,{mode:"edit",initialValues:n()(n()({},c),{},{env_id:Z}),environmentOptions:ae,onFinish:function(){var m=b()(r()().mark(function D(F){var A;return r()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,Ke(F);case 2:return A=X.sent,X.abrupt("return",A);case 4:case"end":return X.stop()}},D)}));return function(D){return m.apply(this,arguments)}}(),trigger:(0,_.jsx)(H.Z.Link,{children:"\u7F16\u8F91"})},"edit"),(0,_.jsx)(q.Z,{title:"\u5220\u9664\u5927\u533A",description:(0,_.jsxs)(_.Fragment,{children:["\u5220\u9664\u5927\u533A ",c.name," \u4E4B\u540E\u65E0\u6CD5\u627E\u56DE\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"]}),onConfirm:function(){Ue({big_area:c.big_area,env_id:Z})},okButtonProps:{loading:We},children:(0,_.jsx)(H.Z.Link,{type:"danger",children:"\u5220\u9664"})},"delete")]}}];return(0,_.jsxs)(o._z,{ghost:!1,title:!1,extra:(0,_.jsx)(K.Z,{}),className:Ie.pageContainer,children:[Me,(0,_.jsx)(Y.Z,{actionRef:y,params:{searchValue:Oe,env_id:Z},rowKey:"big_area",search:!1,request:(0,M.B9)(Z,J),columns:ye,scroll:{x:1200},onLoadingChange:function(v){Re(v)},pagination:{defaultPageSize:10,showSizeChanger:!0},toolbar:{filter:(0,_.jsx)(k.M,{children:(0,_.jsx)(Q.Z.Item,{label:"\u73AF\u5883",children:(0,_.jsx)(V.Z,{style:{width:250},value:ae.length>0?Z:void 0,onChange:function(v){se(v)},disabled:Te||le,options:ae.map(function(E){return n()(n()({},E),{},{label:(0,d.Dv)(E.env_type,E.label)})}),showSearch:!0,loading:le,filterOption:function(v,c){var m,D;return((m=c==null||(D=c.label)===null||D===void 0||(D=D.props)===null||D===void 0?void 0:D.title)!==null&&m!==void 0?m:"").toLowerCase().includes(v.toLowerCase())},notFoundContent:le?"\u52A0\u8F7D\u4E2D...":"\u6682\u65E0\u6570\u636E"})})}),search:(0,_.jsx)(T.Z,{prefix:(0,_.jsx)(B.Z,{}),style:{width:400},placeholder:"\u6A21\u7CCA\u641C\u7D22\u5927\u533A\u540D\u3001\u5927\u533A\u7F16\u53F7\u3001\u5927\u533A\u6807\u7B7E\u3001\u9644\u52A0\u4FE1\u606F",allowClear:!0,value:re,onChange:function(v){return ne(v.target.value)}}),actions:[(0,_.jsx)(x.Z,{mode:"create",initialValues:{env_id:Z},environmentOptions:ae,onFinish:function(){var E=b()(r()().mark(function v(c){var m;return r()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,xe(c);case 2:return m=F.sent,F.abrupt("return",m);case 4:case"end":return F.stop()}},v)}));return function(v){return E.apply(this,arguments)}}(),trigger:(0,_.jsx)(R.ZP,{type:"primary",icon:(0,_.jsx)($.Z,{}),children:"\u65B0\u5EFA\u5927\u533A"},"addFlowTemplate")},"create")]}})]})};h.Z=ee},12876:function(G,h,e){e.d(h,{B9:function(){return s},RT:function(){return b},Rm:function(){return t},_q:function(){return i},xA:function(){return j}});var O=e(90228),n=e.n(O),p=e(87999),u=e.n(p),P=e(58207),r=e(60996);function s(d,f){return d?(0,r.Jl)("/".concat(P.Hg,"/cmdb/cbb_area/big_area/"),{env_id:d,env_type:f}):u()(n()().mark(function B(){return n()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",{data:[],success:!0,total:0});case 1:case"end":return o.stop()}},B)}))}function b(d,f){return(0,r.Jl)("/".concat(P.Hg,"/cmdb/cbb_area/area/"),{env_id:d,big_area:f})}function j(d){return a.apply(this,arguments)}function a(){return a=u()(n()().mark(function d(f){return n()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",(0,r.dT)("/".concat(P.Hg,"/cmdb/cbb_area/big_area/detail/"),f));case 1:case"end":return $.stop()}},d)})),a.apply(this,arguments)}function K(){return commonGetListForTable2("/api/job/v1/flow/design/draft/")}function i(d,f){return(0,r.S_)(d,f)}function t(){return l.apply(this,arguments)}function l(){return l=u()(n()().mark(function d(){return n()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.abrupt("return",(0,r.dT)("/".concat(P.Hg,"/cmdb/cbb_area/env/list/")));case 1:case"end":return B.stop()}},d)})),l.apply(this,arguments)}},41841:function(G,h,e){e.d(h,{f:function(){return P}});var O=e(53649),n=e.n(O),p=e(13179),u,P=(0,p.kc)(function(r){var s=r.css;return{pageContainer:{"& .ant-page-header-heading-extra":s(u||(u=n()([`
      position: absolute;
      top: 17px;
      right: 20px;
    `])))}}})},94071:function(G,h,e){e.d(h,{Dv:function(){return K},MD:function(){return b},nt:function(){return a}});var O=e(82092),n=e.n(O),p=e(16934),u=e(12400),P=e(38546),r=e(50959),s=e(11527),b=n()(n()(n()({},p.t.Production,"\u6B63\u5F0F"),p.t.Test,"\u6D4B\u8BD5"),p.t.Development,"\u5F00\u53D1"),j=function(t){var l=n()(n()(n()({},p.t.Production,"red"),p.t.Test,"blue"),p.t.Development,"green");return l[t]},a=function(t){return(0,s.jsx)(u.Z,{color:j(t),children:b[t]})},K=function(t,l){return(0,s.jsx)(P.Z,{title:l,children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:2,overflow:"hidden"},children:[a(t),(0,s.jsx)("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:l})]})})}}}]);
