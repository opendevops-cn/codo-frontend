"use strict";(self.webpackChunkservermgmt=self.webpackChunkservermgmt||[]).push([[195],{35748:function(G,A,e){var L=e(35361),r=e(56929),T=e(50959),u=e(5087),f=e(11527),s=["fieldProps","min","proFieldProps","max"],v=function(t,g){var h=t.fieldProps,P=t.min,d=t.proFieldProps,m=t.max,_=(0,r.Z)(t,s);return(0,f.jsx)(u.Z,(0,L.Z)({valueType:"digit",fieldProps:(0,L.Z)({min:P,max:m},h),ref:g,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:d},_))},o=T.forwardRef(v);A.Z=o},41379:function(G,A,e){var L=e(26068),r=e.n(L),T=e(48305),u=e.n(T),f=e(90801),s=e(27610),v=e(50959),o=e(11527),I=function(g){var h,P,d,m=g.label,_=g.syncUrlParams,F=_===void 0?!0:_,K=g.disabled,S=K===void 0?!1:K,U=g.display,j=U===void 0?!0:U,Z=(0,f.useModel)("@@initialState"),C=Z.initialState,H=Z.setInitialState,w=(C==null||(h=C.bizListData)===null||h===void 0?void 0:h.data)||[],$=(P=C==null?void 0:C.currentBizId)!==null&&P!==void 0?P:"",x=(d=C==null?void 0:C.currentBizName)!==null&&d!==void 0?d:"",E=(0,f.useSearchParams)(),i=u()(E,2),O=i[0],n=i[1];return(0,v.useEffect)(function(){var M=new URLSearchParams(O.toString());M.set("tenantid",$),M.set("tenant",x),n(M)},[$,x]),(0,o.jsx)(s.Z,{name:"tenantid",label:m,showSearch:!0,allowClear:!1,fieldProps:{defaultValue:$,disabled:S},valueEnum:w.reduce(function(M,p){return M[p.biz_id]=p.biz_cn_name,M},{}),style:r()({width:200},j?{}:{display:"none"}),placeholder:"\u8BF7\u9009\u62E9\u9879\u76EE",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9879\u76EE"}],onChange:function(p,D){if(F){var J=D.title,z=new URLSearchParams(O.toString());z.set("tenantid",p),z.set("tenant",J),n(z),H(r()(r()({},C),{},{currentBizId:p,currentBizName:J}))}}})};A.Z=I},60602:function(G,A,e){e.d(A,{j:function(){return r}});var L=e(90801);function r(T,u,f,s,v){var o=(0,L.useRequest)(T(u,f),{manual:!0,onSuccess:function(h){var P,d;h.code!==-1&&(v==null||v.success(h.msg)),s==null||(P=s.current)===null||P===void 0||(d=P.reloadAndRest)===null||d===void 0||d.call(P)},onError:function(){v==null||v.error("\u64CD\u4F5C\u5931\u8D25")}}),I=o.run,t=o.loading;return{runOpt:I,loading:t}}},66777:function(G,A,e){var L=e(90228),r=e.n(L),T=e(87999),u=e.n(T),f=e(48305),s=e.n(f),v=e(49547),o=e(78420),I=e(27610),t=e(19014),g=e(35748),h=e(34927),P=e(20902),d=e(47698),m=e(50959),_=e(11527),F=function(S){var U=S.mode,j=S.initialValues,Z=S.onFinish,C=S.trigger,H=S.environmentOptions,w=v.A.useForm(),$=s()(w,1),x=$[0];return(0,_.jsxs)(o.a,{title:U==="create"?"\u65B0\u5EFA\u5927\u533A":"\u7F16\u8F91\u5927\u533A",form:x,onOpenChange:function(i){i?U==="create"?x.setFieldsValue({visible:!0,is_test:!0,enable:!0,env_id:j==null?void 0:j.env_id}):U==="edit"&&j&&x.setFieldsValue(j):x.resetFields()},onFinish:function(){var E=u()(r()().mark(function i(O){var n;return r()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Z(O);case 2:if(n=p.sent,!n){p.next=5;break}return p.abrupt("return",!0);case 5:return p.abrupt("return",!1);case 6:case"end":return p.stop()}},i)}));return function(i){return E.apply(this,arguments)}}(),layout:"horizontal",labelCol:{span:4},trigger:C,children:[(0,_.jsx)(I.Z,{name:"env_id",label:"\u73AF\u5883",options:H,disabled:U==="edit",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u73AF\u5883"}]}),(0,_.jsx)(t.Z,{name:"name",label:"\u5927\u533A\u540D",placeholder:"\u8BF7\u8F93\u5165\u5927\u533A\u540D\u79F0",fieldProps:{maxLength:100},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5927\u533A\u540D\u79F0"}]}),(0,_.jsx)(t.Z,{name:"big_area",label:"\u5927\u533A\u7F16\u53F7",placeholder:"\u8BF7\u8F93\u5165\u5927\u533A\u7F16\u53F7",fieldProps:{maxLength:50,disabled:U==="edit"},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5927\u533A\u7F16\u53F7"},{pattern:/^\d+$/,message:"\u5927\u533A\u7F16\u53F7\u5FC5\u987B\u662F\u6574\u6570"},{validator:function(){var E=u()(r()().mark(function O(n,M){return r()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:case 1:case"end":return D.stop()}},O)}));function i(O,n){return E.apply(this,arguments)}return i}()}]}),(0,_.jsx)(I.Z,{name:"tags",label:"\u5927\u533A\u6807\u7B7E",mode:"tags",placeholder:"\u8BF7\u8F93\u5165/\u9009\u62E9\u5927\u533A\u6807\u7B7E\uFF0C\u652F\u6301\u591A\u4E2A\u6807\u7B7E",fieldProps:{maxTagCount:5,tokenSeparators:[","],onChange:function(i){Array.isArray(i)&&i.length>20&&(d.ZP.warning("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E"),x.setFieldsValue({tags:i.slice(0,20)}))}},rules:[{validator:function(){var E=u()(r()().mark(function O(n,M){return r()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(!(Array.isArray(M)&&M.length>20)){D.next=2;break}throw new Error("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E");case 2:case"end":return D.stop()}},O)}));function i(O,n){return E.apply(this,arguments)}return i}()}]}),(0,_.jsx)(t.Z,{name:"address",label:"ping\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165\u5927\u533A\u5730\u5740\uFF0C\u53EF\u7528\u4E8Eping\u5927\u533A\u5EF6\u8FDF",fieldProps:{maxLength:50}}),(0,_.jsx)(g.Z,{name:"utc_offset",label:"UTC\u65F6\u95F4\u504F\u79FB",min:-12,max:14,fieldProps:{precision:0},rules:[{required:!0,message:"\u8BF7\u8F93\u5165UTC\u65F6\u95F4\u504F\u79FB"}]}),(0,_.jsx)(h.Z.Group,{name:"visible",label:"\u73A9\u5BB6\u53EF\u89C1",options:[{label:"\u662F",value:!0},{label:"\u5426",value:!1}],required:!0}),(0,_.jsx)(P.Z,{name:"ext",label:"\u6269\u5C55\u4FE1\u606F",placeholder:"\u8BF7\u8F93\u5165\u6269\u5C55\u4FE1\u606F",fieldProps:{maxLength:500}})]})};A.Z=F},21183:function(G,A,e){e.r(A);var L=e(26068),r=e.n(L),T=e(90228),u=e.n(T),f=e(87999),s=e.n(f),v=e(48305),o=e.n(v),I=e(41379),t=e(60602),g=e(58207),h=e(90801),P=e(40460),d=e(75343),m=e(16030),_=e(56142),F=e(2533),K=e(14990),S=e(47698),U=e(38546),j=e(12400),Z=e(54748),C=e(63463),H=e(94770),w=e(98984),$=e(41268),x=e(50159),E=e(50959),i=e(66777),O=e(12876),n=e(11527),M=function(){var D=(0,E.useRef)(),J=(0,E.useState)(""),z=o()(J,2),Y=z[0],ae=z[1],ue=(0,E.useState)(),k=o()(ue,2),y=k[0],q=k[1],se=(0,E.useState)([]),ee=o()(se,2),Q=ee[0],ie=ee[1],le=(0,K.Z)(Y,{wait:300}),oe=S.ZP.useMessage(),ne=o()(oe,2),N=ne[0],de=ne[1],me=(0,h.useSearchParams)(),Ee=o()(me,1),_e=Ee[0],pe=(0,E.useState)(!1),re=o()(pe,2),ce=re[0],ve=re[1];(0,E.useEffect)(function(){var b=function(){var l=s()(u()().mark(function c(){var a,W;return u()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.prev=0,R.next=3,(0,O.Rm)();case 3:a=R.sent,ie(a.map(function(X){return{label:X.env_name,value:X.id}})),a.length>0&&q(a==null||(W=a[0])===null||W===void 0?void 0:W.id),R.next=12;break;case 8:R.prev=8,R.t0=R.catch(0),console.error("Failed to fetch environment list:",R.t0),N.error("\u83B7\u53D6\u73AF\u5883\u5217\u8868\u5931\u8D25");case 12:case"end":return R.stop()}},c,null,[[0,8]])}));return function(){return l.apply(this,arguments)}}();b()},[_e]),(0,E.useEffect)(function(){var b;(b=D.current)===null||b===void 0||b.reload()},[_e]);var te=(0,t.j)(O._q,"/".concat(g.Hg,"/v2/cmdb/big_area/"),"DELETE",D,N),Pe=te.runOpt,Oe=te.loading,De=(0,t.j)(O._q,"/".concat(g.Hg,"/v2/cmdb/big_area/"),"PUT",D,N),fe=De.runOpt,ge=(0,t.j)(O._q,"/".concat(g.Hg,"/v2/cmdb/big_area/"),"POST",D,N),he=ge.runOpt,Me=[{title:"\u5927\u533A\u540D",dataIndex:"name",width:150,render:function(l,c){return(0,n.jsx)(h.Link,{to:"/serverRegionMgt/serverRegionList/".concat(c.big_area,"?env_id=").concat(y),children:l})}},{title:"\u5927\u533A\u7F16\u53F7",dataIndex:"big_area",ellipsis:!0,width:200},{title:"\u5927\u533A\u6807\u7B7E",dataIndex:"tags",width:200,render:function(l,c){var a,W;return(0,n.jsx)(U.Z,{title:((a=c.tags)!==null&&a!==void 0?a:[]).join(", "),children:(0,n.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden",textOverflow:"ellipsis"},children:((W=c.tags)!==null&&W!==void 0?W:[]).map(function(B){return(0,n.jsx)(j.Z,{style:{marginTop:"4px",marginBottom:"4px"},children:B},B)})})})}},{title:"\u73A9\u5BB6\u53EF\u89C1",dataIndex:"visible",width:90,render:function(l){return l?(0,n.jsx)(j.Z,{color:"green",children:"\u662F"}):(0,n.jsx)(j.Z,{color:"red",children:"\u5426"})}},{title:"UTC\u65F6\u95F4\u504F\u79FB",dataIndex:"utc_offset",width:100},{title:"ping\u5730\u5740",dataIndex:"address",width:200},{title:"\u6269\u5C55\u4FE1\u606F",dataIndex:"ext",ellipsis:!0,width:200},{title:"\u64CD\u4F5C",width:120,dataIndex:"option",valueType:"option",fixed:"right",render:function(l,c){return[(0,n.jsx)(i.Z,{mode:"edit",initialValues:r()(r()({},c),{},{env_id:y}),environmentOptions:Q,onFinish:function(){var a=s()(u()().mark(function W(B){var R;return u()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,fe(B);case 2:return R=V.sent,V.abrupt("return",R);case 4:case"end":return V.stop()}},W)}));return function(W){return a.apply(this,arguments)}}(),trigger:(0,n.jsx)(Z.Z.Link,{children:"\u7F16\u8F91"})},"edit"),(0,n.jsx)(C.Z,{title:"\u5220\u9664\u5927\u533A",description:(0,n.jsxs)(n.Fragment,{children:["\u5220\u9664\u5927\u533A ",c.name," \u4E4B\u540E\u65E0\u6CD5\u627E\u56DE\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"]}),onConfirm:function(){Pe({big_area:c.big_area,env_id:y})},okButtonProps:{loading:Oe},children:(0,n.jsx)(Z.Z.Link,{type:"danger",children:"\u5220\u9664"})},"delete")]}}];return(0,n.jsxs)(m._z,{ghost:!1,title:"\u5927\u533A\u5217\u8868",extra:(0,n.jsx)(I.Z,{}),children:[de,(0,n.jsx)(_.Z,{actionRef:D,params:{searchValue:le,env_id:y},rowKey:"big_area",search:!1,request:y?(0,O.B9)(y):void 0,columns:Me,scroll:{x:1200},onLoadingChange:function(l){ve(l)},pagination:{defaultPageSize:10,showSizeChanger:!0},toolbar:{filter:(0,n.jsx)(F.M,{children:(0,n.jsx)(H.Z.Item,{label:"\u73AF\u5883",children:(0,n.jsx)(w.Z,{style:{width:150},value:y,onChange:function(l){q(l)},disabled:ce,options:Q,showSearch:!0,filterOption:function(l,c){var a;return((a=c==null?void 0:c.label)!==null&&a!==void 0?a:"").toLowerCase().includes(l.toLowerCase())}})})}),search:(0,n.jsx)($.Z,{prefix:(0,n.jsx)(P.Z,{}),style:{width:400},placeholder:"\u6A21\u7CCA\u641C\u7D22\u5927\u533A\u540D\u3001\u5927\u533A\u7F16\u53F7\u3001\u5927\u533A\u6807\u7B7E\u3001\u9644\u52A0\u4FE1\u606F",allowClear:!0,value:Y,onChange:function(l){return ae(l.target.value)}}),actions:[(0,n.jsx)(i.Z,{mode:"create",initialValues:{env_id:y},environmentOptions:Q,onFinish:function(){var b=s()(u()().mark(function l(c){var a;return u()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,he(c);case 2:return a=B.sent,B.abrupt("return",a);case 4:case"end":return B.stop()}},l)}));return function(l){return b.apply(this,arguments)}}(),trigger:(0,n.jsx)(x.ZP,{type:"primary",icon:(0,n.jsx)(d.Z,{}),children:"\u65B0\u5EFA\u5927\u533A"},"addFlowTemplate")},"create")]}})]})};A.default=M},12876:function(G,A,e){e.d(A,{B9:function(){return v},RT:function(){return o},Rm:function(){return P},_q:function(){return h},xA:function(){return I}});var L=e(90228),r=e.n(L),T=e(87999),u=e.n(T),f=e(58207),s=e(60996);function v(m){return(0,s.Jl)("/".concat(f.Hg,"/v2/cmdb/big_area/"),{env_id:m})}function o(m,_){return(0,s.Jl)("/".concat(f.Hg,"/v2/cmdb/area/"),{env_id:m,big_area:_})}function I(m){return t.apply(this,arguments)}function t(){return t=u()(r()().mark(function m(_){return r()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",(0,s.dT)("/".concat(f.Hg,"/v2/cmdb/big_area/detail/"),_));case 1:case"end":return K.stop()}},m)})),t.apply(this,arguments)}function g(){return commonGetListForTable2("/api/job/v1/flow/design/draft/")}function h(m,_){return(0,s.S_)(m,_)}function P(){return d.apply(this,arguments)}function d(){return d=u()(r()().mark(function m(){return r()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",(0,s.dT)("/".concat(f.Hg,"/v2/cmdb/env/list/")));case 1:case"end":return F.stop()}},m)})),d.apply(this,arguments)}}}]);
