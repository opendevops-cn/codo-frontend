"use strict";(self.webpackChunkservermgmt=self.webpackChunkservermgmt||[]).push([[835],{41379:function(q,y,e){var I=e(26068),r=e.n(I),L=e(48305),P=e.n(L),m=e(90801),t=e(27610),l=e(50959),p=e(11527),M=function(f){var u,o,s,a=f.label,h=f.syncUrlParams,b=h===void 0?!0:h,j=f.disabled,N=j===void 0?!1:j,K=f.display,z=K===void 0?!0:K,V=(0,m.useModel)("@@initialState"),d=V.initialState,ee=V.setInitialState,ne=(d==null||(u=d.bizListData)===null||u===void 0?void 0:u.data)||[],T=(o=d==null?void 0:d.currentBizId)!==null&&o!==void 0?o:"",Q=(s=d==null?void 0:d.currentBizName)!==null&&s!==void 0?s:"",re=(0,m.useSearchParams)(),B=P()(re,2),X=B[0],Y=B[1];return(0,l.useEffect)(function(){var D=new URLSearchParams(X.toString());D.set("tenantid",T),D.set("tenant",Q),Y(D)},[T,Q]),(0,p.jsx)(t.Z,{name:"tenantid",label:a,showSearch:!0,allowClear:!1,fieldProps:{defaultValue:T,disabled:N},valueEnum:ne.reduce(function(D,n){return D[n.biz_id]=n.biz_cn_name,D},{}),style:r()({width:200},z?{}:{display:"none"}),placeholder:"\u8BF7\u9009\u62E9\u9879\u76EE",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9879\u76EE"}],onChange:function(n,te){if(b){var H=te.title,G=new URLSearchParams(X.toString());G.set("tenantid",n),G.set("tenant",H),Y(G),ee(r()(r()({},d),{},{currentBizId:n,currentBizName:H}))}}})};y.Z=M},60602:function(q,y,e){e.d(y,{j:function(){return r}});var I=e(90801);function r(L,P,m,t,l){var p=(0,I.useRequest)(L(P,m),{manual:!0,onSuccess:function(u){var o,s;u.code!==-1&&(l==null||l.success(u.msg)),t==null||(o=t.current)===null||o===void 0||(s=o.reloadAndRest)===null||s===void 0||s.call(o)},onError:function(){l==null||l.error("\u64CD\u4F5C\u5931\u8D25")}}),M=p.run,E=p.loading;return{runOpt:M,loading:E}}},8974:function(q,y,e){e.r(y),e.d(y,{default:function(){return de}});var I=e(90228),r=e.n(I),L=e(26068),P=e.n(L),m=e(87999),t=e.n(m),l=e(48305),p=e.n(l),M=e(41379),E=e(60602),f=e(12876),u=e(58207),o=e(90801),s=e(40460),a=e(75343),h=e(16030),b=e(56142),j=e(14990),N=e(47698),K=e(38546),z=e(12400),V=e(54748),d=e(63463),ee=e(41268),ne=e(50159),T=e(50959),Q=e(49547),re=e(78420),B=e(19014),X=e(27610),Y=e(34927),D=e(20902),n=e(11527),te=function(_){var Z=_.mode,w=_.initialValues,k=_.onFinish,ae=_.trigger,ue=Q.A.useForm(),se=p()(ue,1),C=se[0];return(0,n.jsxs)(re.a,{title:Z==="create"?"\u65B0\u5EFA\u73AF\u5883":"\u7F16\u8F91\u73AF\u5883",form:C,onOpenChange:function(c){c?Z==="create"?C.setFieldsValue({is_test:!0}):Z==="edit"&&w&&C.setFieldsValue(w):C.resetFields()},onFinish:function(){var A=t()(r()().mark(function c($){var U;return r()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,k($);case 2:if(U=v.sent,!U){v.next=5;break}return v.abrupt("return",!0);case 5:return v.abrupt("return",!1);case 6:case"end":return v.stop()}},c)}));return function(c){return A.apply(this,arguments)}}(),layout:"horizontal",labelCol:{span:3},trigger:ae,children:[(0,n.jsx)(B.Z,{name:"env_name",label:"\u73AF\u5883\u540D\u79F0",placeholder:"\u8BF7\u8F93\u5165\u73AF\u5883\u540D\u79F0",fieldProps:{maxLength:50},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u73AF\u5883\u540D\u79F0"}]}),(0,n.jsx)(B.Z,{name:"env_no",label:"\u73AF\u5883\u7F16\u53F7",placeholder:"\u8BF7\u8F93\u5165\u73AF\u5883\u7F16\u53F7",fieldProps:{maxLength:50,disabled:Z==="edit"},rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u73AF\u5883\u7F16\u53F7"},{pattern:/^\d+$/,message:"\u73AF\u5883\u7F16\u53F7\u5FC5\u987B\u662F\u6574\u6570"}]}),(0,n.jsx)(X.Z,{name:"env_tags",label:"\u73AF\u5883\u6807\u7B7E",mode:"tags",placeholder:"\u8BF7\u8F93\u5165/\u9009\u62E9\u73AF\u5883\u6807\u7B7E\uFF0C\u652F\u6301\u591A\u4E2A\u6807\u7B7E",fieldProps:{maxTagCount:5,tokenSeparators:[","],onChange:function(c){Array.isArray(c)&&c.length>20&&(N.ZP.warning("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E"),C.setFieldsValue({tags:c.slice(0,20)}))}},rules:[{validator:function(){var A=t()(r()().mark(function $(U,J){return r()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!(Array.isArray(J)&&J.length>20)){W.next=2;break}throw new Error("\u6700\u591A\u53EA\u80FD\u9009\u62E920\u4E2A\u6807\u7B7E");case 2:case"end":return W.stop()}},$)}));function c($,U){return A.apply(this,arguments)}return c}()}]}),(0,n.jsx)(Y.Z.Group,{name:"is_test",label:"\u6D4B\u8BD5\u73AF\u5883",options:[{label:"\u662F",value:!0},{label:"\u5426",value:!1}],required:!0}),(0,n.jsx)(B.Z,{name:"idip",label:"IDIP\u5730\u5740",placeholder:"\u8BF7\u8F93\u5165IDIP\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165IDIP\u5730\u5740"}]}),(0,n.jsx)(D.Z,{name:"ext_info",label:"\u6269\u5C55\u4FE1\u606F",placeholder:"\u8BF7\u8F93\u5165\u6269\u5C55\u4FE1\u606F",fieldProps:{maxLength:500}}),(0,n.jsx)(B.Z,{name:"app_id",label:"AppID",placeholder:"\u8BF7\u8F93\u5165AppID",rules:[{required:!0,message:"\u8BF7\u8F93\u5165AppID"}]}),(0,n.jsx)(B.Z,{name:"app_secret",label:"AppSecret",placeholder:"\u8BF7\u8F93\u5165AppSecret",rules:[{required:!0,message:"\u8BF7\u8F93\u5165AppSecret"}]})]})},H=te,G=e(60996);function le(){return(0,G.Jl)("/".concat(u.Hg,"/v2/cmdb/env/"))}var oe=function(){var _=(0,T.useRef)(),Z=(0,T.useState)(""),w=p()(Z,2),k=w[0],ae=w[1],ue=(0,j.Z)(k,{wait:300}),se=N.ZP.useMessage(),C=p()(se,2),A=C[0],c=C[1],$=(0,o.useSearchParams)(),U=p()($,1),J=U[0],v=(0,E.j)(f._q,"/".concat(u.Hg,"/v2/cmdb/env/"),"DELETE",_,A),W=v.runOpt,ve=v.loading,me=(0,E.j)(f._q,"/".concat(u.Hg,"/v2/cmdb/env/"),"PUT",_,A),pe=me.runOpt,fe=(0,E.j)(f._q,"/".concat(u.Hg,"/v2/cmdb/env/"),"POST",_,A),he=fe.runOpt;(0,T.useEffect)(function(){var F;(F=_.current)===null||F===void 0||F.reload()},[J]);var ge=[{title:"\u73AF\u5883\u540D\u79F0",dataIndex:"env_name",width:150,render:function(g){return(0,n.jsx)(K.Z,{title:g,children:(0,n.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden",textOverflow:"ellipsis"},children:g})})}},{title:"\u73AF\u5883\u7F16\u53F7",dataIndex:"env_no",width:150},{title:"\u73AF\u5883\u6807\u7B7E",dataIndex:"env_tags",width:200,render:function(g,O){var x,R;return(0,n.jsx)(K.Z,{title:((x=O.env_tags)!==null&&x!==void 0?x:[]).join(", "),children:(0,n.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:3,overflow:"hidden",textOverflow:"ellipsis"},children:((R=O.env_tags)!==null&&R!==void 0?R:[]).map(function(i){return(0,n.jsx)(z.Z,{style:{marginTop:"4px",marginBottom:"4px"},children:i},i)})})})}},{title:"\u6D4B\u8BD5\u73AF\u5883",dataIndex:"is_test",width:100,render:function(g){return g?(0,n.jsx)(z.Z,{color:"green",children:"\u662F"}):(0,n.jsx)(z.Z,{color:"red",children:"\u5426"})}},{title:"IDIP\u5730\u5740",dataIndex:"idip",width:200},{title:"\u6269\u5C55\u4FE1\u606F",dataIndex:"ext_info",ellipsis:!0},{title:"\u64CD\u4F5C",width:180,key:"option",valueType:"option",fixed:"right",render:function(g,O){return[(0,n.jsx)(H,{mode:"edit",initialValues:O,onFinish:function(){var x=t()(r()().mark(function R(i){var ie;return r()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,pe(P()(P()({},i),{},{id:O.id}));case 2:if(ie=S.sent,!ie){S.next=5;break}return S.abrupt("return",!0);case 5:return S.abrupt("return",!1);case 6:case"end":return S.stop()}},R)}));return function(R){return x.apply(this,arguments)}}(),trigger:(0,n.jsx)(V.Z.Link,{children:"\u7F16\u8F91"})},"edit"),(0,n.jsx)(d.Z,{title:"\u5220\u9664\u73AF\u5883",description:'\u786E\u5B9A\u8981\u5220\u9664\u73AF\u5883 "'.concat(O.env_name,'" \u5417\uFF1F'),onConfirm:function(){return W({id_list:[O.id]})},okButtonProps:{loading:ve},children:(0,n.jsx)(V.Z.Link,{type:"danger",children:"\u5220\u9664"})},"delete")]}}];return(0,n.jsxs)(h._z,{extra:(0,n.jsx)(M.Z,{display:!1}),children:[c,(0,n.jsx)(b.Z,{actionRef:_,params:{searchValue:ue},rowKey:"id",search:!1,toolbar:{search:(0,n.jsx)(ee.Z,{prefix:(0,n.jsx)(s.Z,{}),style:{width:400},placeholder:"\u6A21\u7CCA\u641C\u7D22\u73AF\u5883\u540D\u3001\u73AF\u5883\u7F16\u53F7\u3001\u73AF\u5883\u6807\u7B7E\u3001\u6269\u5C55\u4FE1\u606F",allowClear:!0,value:k,onChange:function(g){return ae(g.target.value)}}),actions:[(0,n.jsx)(H,{mode:"create",onFinish:function(){var F=t()(r()().mark(function g(O){var x;return r()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,he(O);case 2:if(x=i.sent,!x){i.next=5;break}return i.abrupt("return",!0);case 5:return i.abrupt("return",!1);case 6:case"end":return i.stop()}},g)}));return function(g){return F.apply(this,arguments)}}(),trigger:(0,n.jsx)(ne.ZP,{type:"primary",icon:(0,n.jsx)(a.Z,{}),children:"\u65B0\u5EFA\u73AF\u5883"})},"create")]},request:le(),columns:ge,scroll:{x:1200},pagination:{defaultPageSize:10,showSizeChanger:!0}})]})},de=oe},12876:function(q,y,e){e.d(y,{B9:function(){return l},RT:function(){return p},Rm:function(){return o},_q:function(){return u},xA:function(){return M}});var I=e(90228),r=e.n(I),L=e(87999),P=e.n(L),m=e(58207),t=e(60996);function l(a){return(0,t.Jl)("/".concat(m.Hg,"/v2/cmdb/big_area/"),{env_id:a})}function p(a,h){return(0,t.Jl)("/".concat(m.Hg,"/v2/cmdb/area/"),{env_id:a,big_area:h})}function M(a){return E.apply(this,arguments)}function E(){return E=P()(r()().mark(function a(h){return r()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,t.dT)("/".concat(m.Hg,"/v2/cmdb/big_area/detail/"),h));case 1:case"end":return j.stop()}},a)})),E.apply(this,arguments)}function f(){return commonGetListForTable2("/api/job/v1/flow/design/draft/")}function u(a,h){return(0,t.S_)(a,h)}function o(){return s.apply(this,arguments)}function s(){return s=P()(r()().mark(function a(){return r()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",(0,t.dT)("/".concat(m.Hg,"/v2/cmdb/env/list/")));case 1:case"end":return b.stop()}},a)})),s.apply(this,arguments)}}}]);
