"use strict";(self.webpackChunkf2=self.webpackChunkf2||[]).push([[3133],{82715:function(G,F,e){var C=e(99459),r=e(98037),T=e(58006),c=e(18542),_=e(44725),E=e(86432),A=e(71770),u=e(75271),l=e(34832),o=e(52676),g=["fieldProps","proFieldProps"],s=["fieldProps","proFieldProps"],f="text",S=function(n){var t=n.fieldProps,m=n.proFieldProps,D=(0,T.Z)(n,g);return(0,o.jsx)(l.Z,(0,r.Z)({valueType:f,fieldProps:t,filedConfig:{valueType:f},proFieldProps:m},D))},M=function(n){var t=(0,c.Z)(n.open||!1,{value:n.open,onChange:n.onOpenChange}),m=(0,C.Z)(t,2),D=m[0],h=m[1];return(0,o.jsx)(_.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(K){var O,a=K.getFieldValue(n.name||[]);return(0,o.jsx)(E.Z,(0,r.Z)((0,r.Z)({getPopupContainer:function(P){return P&&P.parentNode?P.parentNode:P},onOpenChange:function(P){return h(P)},content:(0,o.jsxs)("div",{style:{padding:"4px 0"},children:[(O=n.statusRender)===null||O===void 0?void 0:O.call(n,a),n.strengthText?(0,o.jsx)("div",{style:{marginTop:10},children:(0,o.jsx)("span",{children:n.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},n.popoverProps),{},{open:D,children:n.children}))}})},j=function(n){var t=n.fieldProps,m=n.proFieldProps,D=(0,T.Z)(n,s),h=(0,u.useState)(!1),Z=(0,C.Z)(h,2),K=Z[0],O=Z[1];return t!=null&&t.statusRender&&D.name?(0,o.jsx)(M,{name:D.name,statusRender:t==null?void 0:t.statusRender,popoverProps:t==null?void 0:t.popoverProps,strengthText:t==null?void 0:t.strengthText,open:K,onOpenChange:O,children:(0,o.jsx)("div",{children:(0,o.jsx)(l.Z,(0,r.Z)({valueType:"password",fieldProps:(0,r.Z)((0,r.Z)({},(0,A.Z)(t,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(B){var P;t==null||(P=t.onBlur)===null||P===void 0||P.call(t,B),O(!1)},onClick:function(B){var P;t==null||(P=t.onClick)===null||P===void 0||P.call(t,B),O(!0)}}),proFieldProps:m,filedConfig:{valueType:f}},D))})}):(0,o.jsx)(l.Z,(0,r.Z)({valueType:"password",fieldProps:t,proFieldProps:m,filedConfig:{valueType:f}},D))},v=S;v.Password=j,v.displayName="ProFormComponent",F.Z=v},56247:function(G,F,e){var C=e(98037),r=e(58006),T=e(75271),c=e(34832),_=e(52676),E=["fieldProps","proFieldProps"],A=function(l,o){var g=l.fieldProps,s=l.proFieldProps,f=(0,r.Z)(l,E);return(0,_.jsx)(c.Z,(0,C.Z)({ref:o,valueType:"textarea",fieldProps:g,proFieldProps:s},f))};F.Z=T.forwardRef(A)},1743:function(G,F,e){e.d(F,{V2:function(){return T}});var C=15,r=[10,15,20,50,100],T={defaultPageSize:C,showSizeChanger:!0,pageSizeOptions:r}},38419:function(G,F,e){var C=e(90228),r=e.n(C),T=e(87999),c=e.n(T),_=e(99503),E=e(84297),A=e(41901),u=e(75271),l=e(52676),o=function(s){var f=s.changeFlowDesign,S=s.selectedRowsState,M=s.modalTitle,j=M===void 0?"\u6279\u91CF\u66F4\u6539\u4E1A\u52A1":M,v=s.buttonText,p=v===void 0?"\u6279\u91CF\u66F4\u6539\u4E1A\u52A1":v,n=s.buttonType,t=n===void 0?"primary":n,m=s.onSuccess,D=s.trigger,h=s.selectListKey,Z=h===void 0?"select_list":h;return(0,l.jsx)(E.Y,{width:400,title:j,layout:"horizontal",trigger:D||(0,l.jsx)(A.ZP,{type:t,children:p}),autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},submitTimeout:2e3,onFinish:function(){var K=c()(r()().mark(function O(a){var B;return r()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return B={tenantid:a.tenantid},B[Z]=S.map(function(re){return String(re.id)}),$.next=4,f(B);case 4:return m==null||m(),$.abrupt("return",!0);case 6:case"end":return $.stop()}},O)}));return function(O){return K.apply(this,arguments)}}(),children:(0,l.jsx)(_.er,{syncUrlParams:!1,showDefaultValue:!1,label:"\u6D41\u7A0B\u6240\u5C5E\u7684\u4E1A\u52A1"})},"clone")};F.Z=o},67254:function(G,F,e){var C=e(26068),r=e.n(C),T=e(67825),c=e.n(T),_=e(53649),E=e.n(_),A=e(99503),u=e(77777),l=e(88230),o=e(75271),g=e(52676),s=["children","extra","ghost","title"],f,S,M=(0,l.kc)(function(v){var p=v.css;return{pageContainer:{"& .ant-page-header-heading":p(f||(f=E()([`
      margin-bottom: -50px;
    `]))),"& .ant-page-header-heading-extra":p(S||(S=E()([`
      position: absolute;
      top: 17px;
      right: 20px;
    `])))}}}),j=function(p){var n=p.children,t=p.extra,m=t===void 0?(0,g.jsx)(A.er,{}):t,D=p.ghost,h=D===void 0?!1:D,Z=p.title,K=Z===void 0?!1:Z,O=c()(p,s),a=M(),B=a.styles;return(0,g.jsx)(u._z,r()(r()({ghost:h,extra:m,className:B.pageContainer,title:K},O),{},{children:n}))};F.Z=j},78474:function(G,F,e){e.d(F,{j:function(){return T},t:function(){return c}});var C=e(54388),r=e(87300);function T(_,E,A,u,l,o){var g=l!=null?l:r.ZP,s=(0,C.useRequest)(_(E,A),{manual:!0,onSuccess:function(j){if(j.code!==0?g.error(j.msg):g.success(j.msg),o)o();else{var v;u==null||(v=u.current)===null||v===void 0||v.reload(!1)}},onError:function(){g.error("\u64CD\u4F5C\u5931\u8D25")}}),f=s.run,S=s.loading;return{runOpt:f,loading:S}}function c(_){var E=_.optMethod,A=_.optType,u=_.method,l=_.actionRef,o=_.messageApi,g=_.onSuccessCallback,s=_.showSuccessMessage,f=s===void 0?!0:s,S=o!=null?o:r.ZP,M=(0,C.useRequest)(E(A,u),{manual:!0,onSuccess:function(n){var t=typeof n.msg=="string"?n.msg:JSON.stringify(n.msg);if(n.code!==0)S.error(t);else if(g)g(n);else{var m;f&&S.success(t),l==null||(m=l.current)===null||m===void 0||m.reload(!1)}},onError:function(){S.error("\u64CD\u4F5C\u5931\u8D25")}}),j=M.run,v=M.loading;return{runOpt:j,loading:v}}},77029:function(G,F,e){e.r(F),e.d(F,{default:function(){return Me}});var C=e(26068),r=e.n(C),T=e(90228),c=e.n(T),_=e(87999),E=e.n(_),A=e(48305),u=e.n(A),l=e(1743),o=e(38419),g=e(67254),s=e(78474),f=e(19048),S=e(90254),M=e(54388),j=e(37665),v=e(87300),p=e(38902),n=e(64085),t=e(20877),m=e(84249),D=e(41901),h=e(75271),Z=e(14443),K=e(66130),O=e(44725),a=e(52676),B=function(b){var y=b.drawerData,w=b.businessList,W=b.onVisibleChange,Q=b.onSubmit,H=O.Z.useForm(),J=u()(H,1),U=J[0],X=v.ZP.useMessage(),k=u()(X,2),R=k[1];return(0,h.useEffect)(function(){y.show&&U.resetFields()},[U,y.show]),(0,a.jsxs)(Z.a,{form:U,title:y.title,open:y.show,onOpenChange:W,width:"40%",layout:"horizontal",labelCol:{flex:"100px"},drawerProps:{maskClosable:!1,destroyOnClose:!0},onFinish:function(){var z=E()(c()().mark(function N(q){return c()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,Q(q.tenantid);case 2:return L.abrupt("return",!0);case 3:case"end":return L.stop()}},N)}));return function(N){return z.apply(this,arguments)}}(),children:[R,(0,a.jsx)(K.Z,{name:"tenantid",label:"\u9009\u62E9\u4E1A\u52A1",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E1A\u52A1"}],options:w.map(function(z){return{label:z.name,value:z.id}})})]})},P=B,$=e(82715),re=e(56247),ge=function(b){var y=b.drawerData,w=b.variableData,W=b.onVisibleChange,Q=b.onSubmit,H=O.Z.useForm(),J=u()(H,1),U=J[0],X=v.ZP.useMessage(),k=u()(X,2),R=k[1];return(0,h.useEffect)(function(){y.show&&(w?U.setFieldsValue(w):U.resetFields())},[w,U,y.show]),(0,a.jsxs)(Z.a,{form:U,title:y.title,open:y.show,onOpenChange:W,width:"60%",layout:"horizontal",labelCol:{flex:"90px"},drawerProps:{maskClosable:!1,destroyOnClose:!0},onFinish:function(){var z=E()(c()().mark(function N(q){return c()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,Q(q);case 2:return L.abrupt("return",!0);case 3:case"end":return L.stop()}},N)}));return function(N){return z.apply(this,arguments)}}(),children:[R,(0,a.jsx)($.Z,{name:"var_label",label:"\u53D8\u91CF\u540D\u79F0",rules:[{required:!0,message:"\u53D8\u91CF\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],fieldProps:{maxLength:32,placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D\u79F0"}}),(0,a.jsx)($.Z,{name:"var_value",label:"\u53D8\u91CF\u503C",rules:[{required:!0,message:"\u53D8\u91CF\u503C\u4E0D\u80FD\u4E3A\u7A7A"}],fieldProps:{maxLength:250,placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u503C"}}),(0,a.jsx)(re.Z,{name:"description",label:"\u8BE6\u60C5\u5907\u6CE8",fieldProps:{maxLength:200,placeholder:"\u5907\u6CE8\u4E00\u4E0B\u54DF",autoSize:{minRows:3,maxRows:6}}})]})},De=ge,Y=e(23261);function Ce(){return(0,Y.eg)("/api/job/v1/meta/variable/")}function Oe(se,b){return(0,Y.S_)("/api/job/v1/meta/variable/",b)}function be(){return(0,Y.S_)("/api/job/v1/meta/variable/","DELETE")}function Fe(){return(0,Y.S_)("/api/job/v1/meta/variable/sync/","POST")}function Te(){return(0,Y.S_)("/api/job/v1/meta/variable/","PATCH")}var Se=function(){var b,y,w,W=(0,h.useRef)(),Q=(0,h.useState)(""),H=u()(Q,2),J=H[0],U=H[1],X=(0,j.Z)(J,{wait:300}),k=(0,M.useModel)("@@initialState"),R=k.initialState,z=(b=R==null?void 0:R.currentBizId)!==null&&b!==void 0?b:"",N=(y=R==null?void 0:R.currentBizName)!==null&&y!==void 0?y:"\u6240\u6709\u9879\u76EE",q=(0,M.useSearchParams)(),ue=u()(q,1),L=ue[0],oe=z==="500",xe=v.ZP.useMessage(),le=u()(xe,2),te=le[0],Ae=le[1],je=(0,h.useState)([]),ie=u()(je,2),de=ie[0],Be=ie[1],ye=(0,h.useState)([]),ce=u()(ye,2),ne=ce[0],Re=ce[1],Le=(0,h.useState)({show:!1,title:"",action:"post"}),_e=u()(Le,2),ee=_e[0],ae=_e[1],Ie=(0,h.useState)(),ve=u()(Ie,2),pe=ve[0],me=ve[1],Ze=(0,h.useState)({show:!1,title:"\u66F4\u6362\u4E1A\u52A1"}),he=u()(Ze,2),Ee=he[0],Ke=he[1],We=(R==null||(w=R.bizListData)===null||w===void 0?void 0:w.data)||[],Ue=We.map(function(d){return{id:d.id,name:d.name}}),Ve=(0,s.j)(be,void 0,"DELETE",W,te),we=Ve.runOpt,fe=(0,s.j)(Fe,void 0,"POST",W,te),$e=fe.runOpt,ze=fe.loading,Ne=(0,s.j)(Oe,ee.action==="post"?"create":"update",ee.action==="post"?"POST":"PUT",W,te),Ge=Ne.runOpt,He=(0,s.j)(Te,void 0,"PATCH",W,te),Pe=He.runOpt;(0,h.useEffect)(function(){var d;(d=W.current)===null||d===void 0||d.reload()},[L]);var Je=function(){me(void 0),ae({show:!0,title:"\u65B0\u589E\u53D8\u91CF",action:"post"})},Ye=function(i){me(i),ae({show:!0,title:"\u4FEE\u6539\u53D8\u91CF",action:"put"})},Qe=function(){var d=E()(c()().mark(function i(x){return c()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,we({id_list:[x.id]});case 2:case"end":return I.stop()}},i)}));return function(x){return d.apply(this,arguments)}}(),Xe=function(){var d=E()(c()().mark(function i(x){return c()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,Ge(r()(r()({},pe),x));case 2:ae(r()(r()({},ee),{},{show:!1}));case 3:case"end":return I.stop()}},i)}));return function(x){return d.apply(this,arguments)}}(),ke=function(){var d=E()(c()().mark(function i(){return c()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,$e({});case 2:case"end":return V.stop()}},i)}));return function(){return d.apply(this,arguments)}}(),qe=[{title:"\u540D\u79F0\u5907\u6CE8",dataIndex:"description",width:200},{title:"\u53D8\u91CF\u540D",dataIndex:"var_label",width:150},{title:"\u53D8\u91CF\u503C",dataIndex:"var_value",width:150},{title:"\u4E1A\u52A1",dataIndex:"biz_cn_name",width:120},{title:"\u66F4\u65B0\u4EBA",dataIndex:"update_by",width:120},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"update_time",width:160},{title:"\u64CD\u4F5C",valueType:"option",width:80,render:function(i,x){return[(0,a.jsx)(p.Z.Link,{onClick:function(){return Ye(x)},disabled:oe,children:"\u7F16\u8F91"},"edit"),(0,a.jsx)(n.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u300A".concat(x.var_label,"\u300B\u5417\uFF1F"),description:"\u5220\u9664\u4E4B\u540E\u65E0\u6CD5\u627E\u56DE\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01",onConfirm:function(){return Qe(x)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:(0,a.jsx)(p.Z.Link,{type:"danger",children:"\u5220\u9664"})},"delete")]}}];return(0,a.jsxs)(g.Z,{children:[Ae,(0,a.jsx)(t.Z,{type:"success",showIcon:!0,message:N,description:(0,a.jsxs)(a.Fragment,{children:["\u4EFB\u52A1\u6267\u884C\u524D\uFF0C\u53EF\u4E3A\u6BCF\u4E2A\u4E1A\u52A1\u9884\u914D\u7F6E\u9ED8\u8BA4\u7684\u53C2\u6570\u53D8\u91CF\u6216\u5E38\u91CF\u6570\u636E\uFF0C\u4EE5\u4FBF\u4EFB\u52A1\u5728\u6267\u884C\u65F6\u81EA\u52A8\u52A0\u8F7D\u3002\u8FD9\u4E9B\u53D8\u91CF\u7684\u52A0\u8F7D\u987A\u5E8F\u5982\u4E0B\uFF1A",(0,a.jsx)(p.Z.Text,{strong:!0,children:"\u524D\u7F6E\u53D8\u91CF < \u8868\u5355\u53C2\u6570 < \u8FC7\u7A0B\u53D8\u91CF"}),"\u3002\u82E5\u5B58\u5728\u76F8\u540C\u7684\u53D8\u91CF\u952E\uFF0C\u540E\u52A0\u8F7D\u7684\u53D8\u91CF\u4F1A\u8986\u76D6\u5148\u52A0\u8F7D\u7684\u53D8\u91CF\u3002"]}),style:{marginBottom:16}}),(0,a.jsx)(S.Z,{actionRef:W,rowKey:"id",params:{searchValue:X,order_by:"update_time",order:"descend"},search:!1,defaultSize:"small",request:Ce(),columns:qe,rowSelection:{selectedRowKeys:de,onChange:function(i,x){Be(i),Re(x)}},pagination:l.V2,toolbar:{title:(0,a.jsx)(m.Z,{prefix:(0,a.jsx)(f.Z,{}),style:{width:320},placeholder:"\u8F93\u5165\u5173\u952E\u5B57\u5168\u5C40\u641C\u7D22",allowClear:!0,value:J,onChange:function(i){return U(i.target.value)}}),actions:[(0,a.jsx)(D.ZP,{type:"primary",onClick:Je,disabled:oe,children:"\u6DFB\u52A0\u53D8\u91CF"},"add"),(0,a.jsx)(D.ZP,{loading:ze,onClick:ke,children:"\u5237\u65B0\u7F13\u5B58"},"sync")]},tableAlertOptionRender:function(i){var x=i.onCleanSelected;return(ne==null?void 0:ne.length)>0&&(0,a.jsx)(o.Z,{changeFlowDesign:function(I){return Pe({id_list:I.select_list.map(function(et){return Number(et)}),tenantid:I.tenantid})},selectedRowsState:ne,buttonText:"\u6279\u91CF\u66F4\u6539\u4E1A\u52A1",onSuccess:function(){x()}})}}),(0,a.jsx)(De,{drawerData:ee,variableData:pe,onVisibleChange:function(i){ae(r()(r()({},ee),{},{show:i}))},onSubmit:Xe}),(0,a.jsx)(P,{drawerData:Ee,businessList:Ue,onVisibleChange:function(i){Ke(r()(r()({},Ee),{},{show:i}))},onSubmit:function(i){return Pe({id_list:de,tenantid:i})}})]})},Me=Se}}]);
