"use strict";(self.webpackChunkf2=self.webpackChunkf2||[]).push([[1175],{80696:function(It,Qe,e){e.d(Qe,{Z:function(){return _e}});var tt=e(26068),a=e.n(tt),nt=e(15558),Be=e.n(nt),h=e(335),J=e.n(h),ke=e(90228),w=e.n(ke),O=e(87999),C=e.n(O),Xe=e(67825),qe=e.n(Xe),rt=e(48305),E=e.n(rt),de=e(99503),vt=e(19048),Ke=e(90254),at=e(84338),it=e(84249),u=e(75271),t=e(52676),ut=function(i){var r=i.onSelectedRowsChange,b=i.internalHosts,n=i.serverList,g=(0,u.useState)([]),f=E()(g,2),v=f[0],s=f[1],H=(0,u.useState)(""),re=E()(H,2),V=re[0],Pe=re[1],K=(0,u.useState)(n),U=E()(K,2),Re=U[0],ae=U[1],Ae=(0,u.useState)(1),Ze=E()(Ae,2),Ce=Ze[0],se=Ze[1],_=function(l){Pe(l),se(1);var o=l?n.filter(function(p){var P;return p.agent_id.toLowerCase().includes(l.toLowerCase())||(((P=p.alias)===null||P===void 0?void 0:P.toLowerCase())||"").includes(l.toLowerCase())}):n;ae(o)};(0,u.useEffect)(function(){s(b.map(function(S){return S.agent_id}))},[b]),(0,u.useEffect)(function(){_(V)},[n]),(0,u.useEffect)(function(){var S=n.filter(function(l){return b.some(function(o){return o.agent_id===l.agent_id})});r(S)},[]);var G=[{title:"Agent ID",dataIndex:"agent_id",width:150,sorter:function(l,o){return l.agent_id.localeCompare(o.agent_id)}},{title:"\u522B\u540D",dataIndex:"alias",width:150,render:function(l){return l||"-"}},{title:"\u5DE5\u4F5C\u72B6\u6001",dataIndex:"work_status",width:120,sorter:function(l,o){return l.work_status.localeCompare(o.work_status)},render:function(l,o){var p={free:{color:"success",text:"\u7A7A\u95F2"},busy:{color:"cyan",text:"\u7E41\u5FD9"},maintain:{color:"warning",text:"\u7EF4\u62A4"},lock:{color:"error",text:"\u9501\u5B9A"},unknown:{color:"error",text:"\u672A\u77E5"}},P=p[o.work_status];return(0,t.jsx)(at.Z,{color:P.color,children:P.text})}}];return(0,t.jsx)(Ke.Z,{rowKey:"agent_id",columns:G,dataSource:Re,search:!1,options:!1,rowSelection:{selectedRowKeys:v,onChange:function(l,o){s(l),r(o)}},pagination:{current:Ce,pageSize:10,total:Re.length,showSizeChanger:!1,onChange:function(l){return se(l)},showTotal:function(l){return"\u4E00\u5171\u67E5\u8BE2\u5230: ".concat(l," \u6761\u6570\u636E")}},toolbar:{search:(0,t.jsx)(it.Z,{prefix:(0,t.jsx)(vt.Z,{}),style:{width:330},placeholder:"\u8F93\u5165Agent ID\u6216\u522B\u540D\u641C\u7D22",allowClear:!0,value:V,onChange:function(l){return _(l.target.value)}})},cardProps:{bodyStyle:{paddingInline:0,paddingTop:0}}})},mt=ut,Le=e(23261);function pt(I){return(0,Le.Jl)("/api/job/v2/proxy/cmdb/host/search/",I)}function D(I){return(0,Le.dT)("/api/job/v1/proxy/cmdb/host/search/",I)}function ee(){return(0,Le.dT)("/api/job/v1/proxy/cmdb/dynamic_group/list/",{biz_id:1})}function wt(I){return(0,Le.dT)("/api/job/v1/proxy/cmdb/dynamic_group/info/",I)}function ot(I){return(0,Le.dT)("/api/job/v1/task/agent/status_by_ip/",I)}function zt(I){return(0,Le.dT)("/api/job/v1/proxy/cmdb/tree/",I)}var Me=e(54388),Pt=e(82398),jt=e(32699),Dt=function(i){var r,b=i.onSelectTreeNode,n=u.useState([]),g=E()(n,2),f=g[0],v=g[1],s=(0,u.useState)([]),H=E()(s,2),re=H[0],V=H[1],Pe=(0,Me.useModel)("@@initialState"),K=Pe.initialState,U=(r=K==null?void 0:K.currentBizId)!==null&&r!==void 0?r:"",Re=(0,Me.useRequest)(function(){return U&&zt({biz_id:Number(U)})}),ae=Re.data,Ae=Re.run,Ze=function S(l){var o=[];return l.forEach(function(p){p.expand&&(o.push(p.id||p.title),Array.isArray(p.children)&&p.children.length>0&&(o=[].concat(Be()(o),Be()(S(p.children)))))}),o},Ce=function S(l){return l.map(function(o){var p;return{title:o.title,value:o.id||o.title,children:((p=o.children)===null||p===void 0?void 0:p.length)>0?S(o.children):void 0,disabled:!1,selectable:!0,node_type:o.node_type,parent_node:o.parent_node,grand_node:o.grand_node}})},se=function(){var S=C()(w()().mark(function l(o){return w()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",new Promise(function(){var T=C()(w()().mark(function ce($e){var ie,Oe,we;return w()().wrap(function(De){for(;;)switch(De.prev=De.next){case 0:if(o.node_type!==3){De.next=7;break}return De.next=3,D({limit:2e3,biz_id:Number(U),env_name:o.grand_node,region_name:o.parent_node,module_name:o.title,asset_type:"server"});case 3:ie=De.sent,Oe=ie.data.map(function(je){return a()({title:"[".concat(je.inner_ip,"] [").concat(je.name,"]"),value:je.inner_ip,isLeaf:!0,selectable:!0,disabled:!1},je)}),we=function je(lt,et,st){return lt.map(function(Fe){return Fe.value===et?a()(a()({},Fe),{},{children:st}):Fe.children?a()(a()({},Fe),{},{children:je(Fe.children,et,st)}):Fe})},V(function(je){return we(je,o.value,Oe)});case 7:$e();case 8:case"end":return De.stop()}},ce)}));return function(ce){return T.apply(this,arguments)}}()));case 1:case"end":return P.stop()}},l)}));return function(o){return S.apply(this,arguments)}}(),_=function(l){return l.map(function(o){var p=function P(T){var ce=J()(T),$e;try{for(ce.s();!($e=ce.n()).done;){var ie=$e.value;if(ie.value===o.value)return ie;if(ie.children){var Oe=P(ie.children);if(Oe)return Oe}}}catch(we){ce.e(we)}finally{ce.f()}return null};return p((0,jt.cloneDeep)(re))})},G=function(l){var o=[],p=function P(T){if(T){if(T.isLeaf){o.push(T);return}switch(T.node_type){case 0:T.children&&T.children.forEach(P);break;case 1:{var ce=T.title;T.children&&T.children.forEach(function(ie){P(a()(a()({},ie),{},{env_name:ce}))});break}case 2:{var $e={env_name:T.env_name||T.parent_node,region_name:T.title};T.children&&T.children.forEach(function(ie){P(a()(a()({},ie),$e))});break}case 3:o.push({env_name:T.grand_node,region_name:T.parent_node,module_name:T.title});break}}};return l.forEach(p),o};return(0,u.useEffect)(function(){if(ae&&ae.length>0){var S=Ce(ae);V(S);var l=Ze(ae);v(l)}},[ae]),(0,t.jsx)("div",{style:{marginTop:16},children:(0,t.jsx)(Pt.Z,{name:"name",placeholder:"\u9009\u62E9\u8282\u70B9",allowClear:!0,label:"\u9009\u62E9\u8282\u70B9",rules:[{required:!0,message:"\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u8282\u70B9"}],fieldProps:{suffixIcon:null,filterTreeNode:!0,showSearch:!0,popupMatchSelectWidth:!1,labelInValue:!0,autoClearSearchValue:!0,multiple:!0,treeNodeFilterProp:"title",fieldNames:{label:"title",value:"value",children:"children"},listHeight:400,treeDefaultExpandedKeys:f,style:{width:"100%"},treeCheckable:!0,showCheckedStrategy:"SHOW_PARENT",onChange:function(l,o,p){if(l){var P=_(l),T=G(P);b==null||b(T)}},loadData:se,treeData:re}})})},Tt=Dt,Ft=e(64412),Bt=e(66130),St=e(65825),ze=e(58578),xt=e(50876),Ne=e(41901),yt=e(38902),Nt=function(){var i=(0,u.useState)(0),r=E()(i,2),b=r[0],n=r[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginTop:16},children:(0,t.jsxs)(St.Z,{gutter:8,children:[(0,t.jsx)(ze.Z,{flex:"auto",children:(0,t.jsx)(Bt.Z,{name:"dynamic_group",label:"\u9009\u62E9\u5206\u7EC4",fieldProps:{mode:"multiple",labelInValue:!0},request:C()(w()().mark(function g(){var f;return w()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,ee();case 2:return f=s.sent,s.abrupt("return",f.data.map(function(H){return{label:H.dynamic_group_name,value:H.exec_uuid}}));case 4:case"end":return s.stop()}},g)})),placeholder:"\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u52A8\u6001\u5206\u7EC4\u6807\u7B7E",rules:[{required:!0,message:"\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u52A8\u6001\u5206\u7EC4\u6807\u7B7E"}],params:{refreshKey:b}})}),(0,t.jsx)(ze.Z,{flex:"32px",children:(0,t.jsx)(xt.Z,{title:"\u5237\u65B0",children:(0,t.jsx)(Ne.ZP,{type:"text",icon:(0,t.jsx)(Ft.Z,{}),shape:"circle",onClick:function(){return n(function(f){return f+1})}})})})]})}),(0,t.jsx)("div",{style:{margin:"8px 0 0 80px"},children:(0,t.jsxs)(yt.Z.Text,{type:"secondary",style:{marginTop:"8px"},children:["\u5982\u672A\u627E\u5230\u9002\u914D\u7684\u5206\u7EC4\uFF0C\u8BF7\xA0",(0,t.jsx)(yt.Z.Link,{href:"/cmdb/bizmg/cmdb-dynamic-group",target:"_blank",children:"\u65B0\u5EFA\u5206\u7EC4"})]})})]})},Rt=Nt,At=e(37665),Zt=function(i){var r,b=i.onSelectedRowsChange,n=i.internalHosts,g=(0,u.useState)(""),f=E()(g,2),v=f[0],s=f[1],H=(0,u.useRef)(),re=(0,Me.useModel)("@@initialState"),V=re.initialState,Pe=(r=V==null?void 0:V.currentBizId)!==null&&r!==void 0?r:"",K=(0,u.useState)([]),U=E()(K,2),Re=U[0],ae=U[1],Ae=(0,At.Z)(v,{wait:300});(0,u.useEffect)(function(){ae(n.map(function(se){return se.inner_ip}))},[n]);var Ze=[{title:"IP",dataIndex:"inner_ip",width:80},{title:"\u4E3B\u673A\u540D",dataIndex:"name",width:80},{title:"\u72B6\u6001",dataIndex:"agent_status",width:50,render:function(_){return(0,t.jsx)(de.Nj,{status:_,statusType:"agent_status"})}}],Ce=function(){var se=C()(w()().mark(function _(G){var S,l;return w()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,pt({search_val:G.search_val,biz_id:Number(Pe),asset_type:"server"})({current:G.current,pageSize:G.pageSize});case 2:return S=p.sent,S.data&&(l=S.data.filter(function(P){return n.some(function(T){return T.inner_ip===P.inner_ip})}).map(function(P){return P.inner_ip}),ae(l)),p.abrupt("return",S);case 5:case"end":return p.stop()}},_)}));return function(G){return se.apply(this,arguments)}}();return(0,t.jsx)(Ke.Z,{actionRef:H,rowKey:"inner_ip",search:!1,params:{search_val:Ae},request:Ce,tableAlertRender:!1,columns:Ze,scroll:{x:1e3},rowSelection:{selectedRowKeys:Re,onChange:function(_,G){ae(_),b(G)}},pagination:{defaultPageSize:10,showSizeChanger:!1},options:!1,toolbar:{search:(0,t.jsx)(it.Z,{prefix:(0,t.jsx)(vt.Z,{}),style:{width:400},placeholder:"\u8BF7\u8F93\u5165IP\u6216\u4E3B\u673A\u540D\u8FDB\u884C\u6A21\u7CCA\u641C\u7D22",allowClear:!0,value:v,onChange:function(_){return s(_.target.value)}})},cardProps:{bodyStyle:{paddingInline:0,paddingTop:0}}})},R=Zt,d=e(53649),F=e.n(d),$=e(87300),te=e(80921),W=e(40506),Q=e(88230),me,fe,Se,X,ve,xe,ne=(0,Q.kc)(function(I){var i=I.css,r=I.token;return{container:i(me||(me=F()([`
    width: 100%;
    //max-width: 800px;
    margin: 20px auto 0;
  `]))),textAreaWrapper:i(fe||(fe=F()([`
    position: relative;
    margin-bottom: `,`px;

    .ant-input {
      padding-bottom: 40px;
      resize: none;
    }
  `])),r.margin),addButton:i(Se||(Se=F()([`
    position: absolute;
    bottom: 20px;
    right: 20px;
    border-radius: `,`px;
  `])),r.borderRadius),tagsContainer:i(X||(X=F()([`
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding: `,`px;
    min-height: 50px;
    background-color: `,`;
    border-radius: `,`px;
    transition: all 0.3s;

    &:empty {
      display: flex;
      align-items: center;
      justify-content: center;
      color: `,`;

      &::after {
        content: '\u6682\u65E0\u6570\u636E';
      }
    }
  `])),r.padding,r.colorBgContainer,r.borderRadius,r.colorTextDisabled),tag:i(ve||(ve=F()([`
    width: 133px;
    text-align: left;
    padding: 0 24px 0 8px;
    position: relative;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;

    .anticon-close {
      position: absolute;
      top: 50%;
      right: 8px;
      transform: translateY(-50%);
    }
  `]))),tagInput:i(xe||(xe=F()([`
    width: 133px;
    height: 22px;
    margin-inline-end: 8px;
    vertical-align: top;
  `])))}}),A=function(i){switch(i){case"1":return"blue";case"2":return"red";case"3":return"default";default:return"default"}},oe=function(i){var r,b=i.value,n=i.onChange,g=ne(),f=g.styles,v=(0,u.useState)(""),s=E()(v,2),H=s[0],re=s[1],V=(0,u.useState)(b||[]),Pe=E()(V,2),K=Pe[0],U=Pe[1],Re=(0,u.useState)(-1),ae=E()(Re,2),Ae=ae[0],Ze=ae[1],Ce=(0,u.useState)(""),se=E()(Ce,2),_=se[0],G=se[1],S=(0,u.useRef)(null),l=(0,u.useState)("valid"),o=E()(l,2),p=o[0],P=o[1],T=(0,Me.useModel)("@@initialState"),ce=T.initialState,$e=(r=ce==null?void 0:ce.currentBizId)!==null&&r!==void 0?r:"",ie=(0,Me.useRequest)(function(B){return ot({ip_list:B.join(","),biz_id:Number($e)})},{manual:!0,formatResult:function(M){return M.data},onError:function(){$.ZP.error("\u83B7\u53D6\u4E3B\u673A\u72B6\u6001\u5931\u8D25")}}),Oe=ie.loading,we=ie.run;(0,u.useEffect)(function(){var B;(B=S.current)===null||B===void 0||B.focus()},[_]);var We=(0,u.useCallback)(function(B){U(B),n==null||n(B)},[n]),De=(0,u.useCallback)(C()(w()().mark(function B(){var M,c;return w()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(H.trim()){z.next=3;break}return $.ZP.warning("\u8BF7\u8F93\u5165IP"),z.abrupt("return");case 3:if(z.prev=3,M=H.split(/[\s,;\n]+/).filter(function(pe){return pe.trim()}),M.length!==0){z.next=8;break}return $.ZP.warning("\u6CA1\u6709\u65B0\u7684\u6709\u6548\u8F93\u5165"),z.abrupt("return");case 8:if(!(M.length>50)){z.next=11;break}return $.ZP.warning("\u4E00\u6B21\u6027\u6DFB\u52A0\u7684 ip \u4E0D\u80FD\u5927\u4E8E 50 \u4E2A"),z.abrupt("return");case 11:return z.next=13,we(M);case 13:c=z.sent,We(c),$.ZP.success("\u5DF2\u5339\u914D ".concat(c.length," \u4E2AIP")),z.next=20;break;case 18:z.prev=18,z.t0=z.catch(3);case 20:case"end":return z.stop()}},B,null,[[3,18]])})),[H,we,We]),je=(0,u.useCallback)(function(){var B=C()(w()().mark(function M(c){var be,z;return w()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(be=K.filter(function(Ue){return Ue.ip!==c}),!(be.length>0)){Y.next=8;break}return Y.next=4,we(be.map(function(Ue){return Ue.ip}));case 4:z=Y.sent,We(z),Y.next=9;break;case 8:We([]);case 9:case"end":return Y.stop()}},M)}));return function(M){return B.apply(this,arguments)}}(),[K,we,We]),lt=(0,u.useCallback)(function(B){B.key==="Enter"&&B.ctrlKey&&De()},[De]),et=function(M){G(M.target.value)},st=(0,u.useMemo)(function(){var B=K.filter(function(c){return c.agent_status!=="3"}),M=K.filter(function(c){return c.agent_status==="3"});return{validHosts:B,invalidHosts:M}},[K]),Fe=st.validHosts,bt=st.invalidHosts,ht=function(){var B=C()(w()().mark(function M(){var c,be;return w()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(_.trim()){pe.next=3;break}return $.ZP.warning("ip \u4E0D\u80FD\u4E3A\u7A7A"),pe.abrupt("return");case 3:return c=K.map(function(Y){if(p==="valid"){var Ue=Y.agent_status!=="3"&&Fe.findIndex(function(gt){return gt.ip===Y.ip})===Ae;return Ue?_.trim():Y.ip}else{var Et=Y.agent_status==="3"&&bt.findIndex(function(gt){return gt.ip===Y.ip})===Ae;return Et?_.trim():Y.ip}}),pe.next=6,we(c);case 6:be=pe.sent,be.length>0&&We(be),Ze(-1),G(""),P("valid");case 11:case"end":return pe.stop()}},M)}));return function(){return B.apply(this,arguments)}}(),Ct=(0,u.useCallback)(function(B,M){return B.map(function(c,be){var z=p===M&&Ae===be;if(z)return(0,t.jsx)(it.Z,{ref:S,size:"small",className:f.tagInput,value:_,onChange:et,onBlur:ht,onPressEnter:ht},c.ip);var pe=(0,t.jsx)(at.Z,{closable:!0,onClose:function(){return je(c.ip)},color:A(c.agent_status),className:f.tag,children:(0,t.jsx)("span",{onDoubleClick:function(){P(M),Ze(be),G(c.ip)},style:{display:"block",overflow:"hidden",textOverflow:"ellipsis"},children:c.ip})},c.ip);return(0,t.jsx)(xt.Z,{title:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:["\u4E3B\u673A\u540D: ",c.name||c.ip]}),(0,t.jsxs)("div",{children:["Agent ID: ",c.agent_id]})]}),children:pe},"".concat(c.ip,"-").concat(c.agent_id))})},[p,Ae,_,et,ht,je,f.tag,f.tagInput]);return(0,t.jsxs)("div",{className:f.container,children:[(0,t.jsxs)("div",{className:f.textAreaWrapper,children:[(0,t.jsx)(it.Z.TextArea,{value:H,onChange:function(M){return re(M.target.value)},placeholder:"\u8BF7\u8F93\u5165IP\u8FDB\u884C\u5339\u914D\uFF08\u652F\u6301\u7A7A\u683C\u3001\u6362\u884C\u3001\u9017\u53F7\u548C\u5206\u53F7\u5206\u9694\uFF0C\u6700\u591A50\u4E2A\uFF0C\u70B9\u51FB\u5339\u914D\u4F1A\u8986\u76D6\u4E0B\u65B9\u5DF2\u5339\u914DIP\uFF09",autoSize:{minRows:6,maxRows:10},onKeyDown:lt,disabled:Oe}),(0,t.jsx)(xt.Z,{title:"\u652F\u6301Ctrl+Enter\u6DFB\u52A0",children:(0,t.jsx)(Ne.ZP,{type:"primary",onClick:De,loading:Oe,className:f.addButton,children:"\u5339\u914D"})})]}),(0,t.jsx)(te.Z,{gap:"18px 10px",wrap:"wrap",children:Ct(Fe,"valid")}),bt.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(W.Z,{orientation:"left",plain:!0,children:"\u65E0\u6548\u4E3B\u673A"}),(0,t.jsx)(te.Z,{gap:"18px 10px",wrap:"wrap",children:Ct(bt,"invalid")})]})]})},Ge=oe,Te=e(84286),N=e(41891),Z=e(84297),le=e(54805),L=e(44725),k=e(20877),ye=e(67870),Ee=["heartbeat"],Ie=(0,Q.kc)(function(){return{toolBar:{"& .ant-pro-table-list-toolbar-container":{paddingTop:0}},modalForm:{"& .ant-form-item":{marginBottom:0},"& .ant-alert":{paddingBlock:4}},divider:{"&.ant-divider-horizontal":{margin:"16px 0"}}}}),Ve=function(i){var r,b=i.drawerData,n=i.formData,g=i.onChange,f=i.onHostSelect,v=i.label,s=v===void 0?"\u76EE\u6807\u4E3B\u673A":v,H=i.modalTitle,re=H===void 0?"\u4E3B\u673A\u9009\u62E9":H,V=i.triggerButtonText,Pe=V===void 0?"\u4E3B\u673A\u9009\u62E9":V,K=i.isCloudNative,U=K===void 0?!1:K,Re=i.labelCol,ae=i.required,Ae=ae===void 0?!1:ae,Ze=Ie(),Ce=Ze.styles,se=(0,u.useState)(n.static_hosts||[]),_=E()(se,2),G=_[0],S=_[1],l=(0,u.useState)(n.dynamic_group||[]),o=E()(l,2),p=o[0],P=o[1],T=(0,u.useState)(!1),ce=E()(T,2),$e=ce[0],ie=ce[1],Oe=(0,u.useState)([]),we=E()(Oe,2),We=we[0],De=we[1];(0,u.useRef)();var je=(0,Me.useModel)("@@initialState"),lt=je.initialState,et=(r=lt==null?void 0:lt.currentBizId)!==null&&r!==void 0?r:"",st=(0,u.useState)([]),Fe=E()(st,2),bt=Fe[0],ht=Fe[1],Ct=(0,u.useRef)(),B=(0,u.useState)(n.rt_type||"ipSearch"),M=E()(B,2),c=M[0],be=M[1],z=(0,u.useState)([]),pe=E()(z,2),Y=pe[0],Ue=pe[1],Et=(0,Me.useRequest)(function(){return(0,Te.sZ)({biz_id:Number(et)})},{manual:!0}),gt=Et.data,kt=gt===void 0?[]:gt,_t=Et.run,Kt=kt.map(function(x){var m=x.heartbeat,y=qe()(x,Ee);return y}),Ht=function(){var x=C()(w()().mark(function m(y){var q,he;return w()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!(y.length>0)){ge.next=6;break}return q=y.map(function(He){return He.id}).join(","),ge.next=4,wt({exec_uuid:q});case 4:he=ge.sent,De(he.data);case 6:case"end":return ge.stop()}},m)}));return function(y){return x.apply(this,arguments)}}(),Gt=(0,Me.useRequest)(function(){var x=C()(w()().mark(function m(y){var q,he,ct,ge,He,Ye,Je,dt,ft,Mt;return w()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:q=[],he=J()(y),j.prev=2,he.s();case 4:if((ct=he.n()).done){j.next=16;break}if(ge=ct.value,!ge.isLeaf){j.next=10;break}q.push(ge),j.next=14;break;case 10:return j.next=12,D(a()(a()({limit:2e3,biz_id:Number(et)},ge),{},{asset_type:"server"}));case 12:He=j.sent,q.push.apply(q,Be()(He.data));case 14:j.next=4;break;case 16:j.next=21;break;case 18:j.prev=18,j.t0=j.catch(2),he.e(j.t0);case 21:return j.prev=21,he.f(),j.finish(21);case 24:for(Ye=new Map,Je=0,dt=q;Je<dt.length;Je++)ft=dt[Je],Ye.has(ft.inner_ip)||Ye.set(ft.inner_ip,ft);return Mt=Be()(Ye.values()),j.abrupt("return",{data:Mt});case 28:case"end":return j.stop()}},m,null,[[2,18,21,24]])}));return function(m){return x.apply(this,arguments)}}(),{manual:!0,onSuccess:function(m){g(a()(a()({},n),{},{static_hosts:m,rt_type:c,dynamic_group:[]}))}}),Vt=Gt.run;(0,u.useEffect)(function(){if(S(n.static_hosts||[]),U){var x;((n==null||(x=n.static_hosts)===null||x===void 0?void 0:x.length)>0||Ct.current)&&ie(!0)}else ie(!1)},[n.static_hosts]),(0,u.useEffect)(function(){P(n.dynamic_group||[])},[n.dynamic_group]),(0,u.useEffect)(function(){C()(w()().mark(function x(){return w()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!b.show){y.next=3;break}return y.next=3,Ht(p);case 3:case"end":return y.stop()}},x)}))()},[b.show]),(0,u.useEffect)(function(){b.show&&U&&_t()},[b.show,U]),(0,u.useEffect)(function(){c!=="cmdbTree"&&ht([])},[c]);var $t=function(m){var y=G.filter(function(q){return q.agent_id!==m.agent_id});S(y),g(a()(a()({},n),{},{static_hosts:y,rt_type:c}))},Lt=function(m){var y=m?G.filter(m):[];S(y),g(a()(a()({},n),{},{static_hosts:y,rt_type:c}))},Wt=L.Z.useForm(),Ut=E()(Wt,1),Ot=Ut[0],Yt=function(){var x=C()(w()().mark(function m(y){var q,he,ct,ge,He,Ye,Je,dt,ft;return w()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:if(c!=="dynamicGroup"){ue.next=7;break}return ct=(q=y==null||(he=y.dynamic_group)===null||he===void 0?void 0:he.map(function(j){return{id:j.value,name:j.label}}))!==null&&q!==void 0?q:[],ue.next=4,Ht(ct);case 4:g(a()(a()({},n),{},{dynamic_group:ct,rt_type:c,static_hosts:[]})),ue.next=26;break;case 7:if(c!=="cmdbTree"){ue.next=12;break}return ue.next=10,Vt(bt);case 10:ue.next=26;break;case 12:if(c!=="manualInput"){ue.next=22;break}if(Ye=(ge=(He=y.tags)===null||He===void 0||(He=He.filter(function(j){return j.agent_status!=="3"}))===null||He===void 0?void 0:He.map(function(j){return{inner_ip:j.ip,name:j.name,agent_status:j.agent_status,agent_id:j.agent_id}}))!==null&&ge!==void 0?ge:[],Ye.length){ue.next=17;break}return $.ZP.warning("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u6709\u6548\u4E3B\u673A"),ue.abrupt("return",!1);case 17:Je=[],n.rt_type==="manualInput"?(dt=n.static_hosts||[],ft=Ye.filter(function(j){return!dt.some(function(Qt){return Qt.agent_id===j.agent_id})}),Je=[].concat(Be()(dt),Be()(ft))):Je=Ye,g(a()(a()({},n),{},{static_hosts:Je,rt_type:c,dynamic_group:[]})),ue.next=26;break;case 22:if(Y.length!==0){ue.next=25;break}return $.ZP.warning("\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u53F0\u4E3B\u673A"),ue.abrupt("return");case 25:g(a()(a()({},n),{},{static_hosts:Y,rt_type:c,dynamic_group:[]}));case 26:return ue.abrupt("return",!0);case 27:case"end":return ue.stop()}},m)}));return function(y){return x.apply(this,arguments)}}(),Jt=function(){Ht(p)};return(0,t.jsxs)(N.A.Item,{label:s,labelCol:Re||{span:2},required:Ae,children:[(0,t.jsx)(Z.Y,{title:re,trigger:(0,t.jsx)(Ne.ZP,{type:"primary",size:"middle",onClick:f,children:Pe}),width:1100,onFinish:Yt,modalProps:{destroyOnClose:!0},layout:"horizontal",className:Ce.modalForm,onOpenChange:function(m){m&&(be(n.rt_type||"ipSearch"),n.rt_type==="ipSearch"&&Ue(n.static_hosts||[]),n.dynamic_group&&Ot.setFieldsValue({dynamic_group:n.dynamic_group.map(function(y){return{label:y.name,value:y.id}})}),U&&_t())},form:Ot,children:U?(0,t.jsx)(mt,{onSelectedRowsChange:function(m){Ue(m)},internalHosts:G,serverList:Kt}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(St.Z,{gutter:16,children:[(0,t.jsx)(ze.Z,{children:(0,t.jsx)(le.Z.Group,{name:"radio-button",radioType:"button",fieldProps:{buttonStyle:"solid",value:c,onChange:function(m){return be(m.target.value)}},options:[{label:"\u641C\u7D22\u6DFB\u52A0",value:"ipSearch"},{label:"\u670D\u52A1\u6811",value:"cmdbTree"},{label:"\u52A8\u6001\u5206\u7EC4",value:"dynamicGroup"},{label:"\u624B\u52A8\u6DFB\u52A0",value:"manualInput"}]})}),(0,t.jsx)(ze.Z,{flex:"auto",children:(0,t.jsx)(k.Z,{message:"\u5DE6\u4FA7\u4E3A\u56DB\u79CD\u72EC\u7ACB\u7684\u9009\u62E9\u65B9\u5F0F\uFF0C\u5207\u6362\u9009\u62E9\u65B9\u5F0F\u5E76\u786E\u8BA4\u6DFB\u52A0\u540E\u4F1A\u8986\u76D6\u8868\u5355\u4E2D\u7684\u5DF2\u9009\u6570\u636E",type:"info",showIcon:!0})})]}),c==="ipSearch"&&(0,t.jsx)(R,{onSelectedRowsChange:function(m){Ue(m)},internalHosts:G}),c==="cmdbTree"&&(0,t.jsx)(Tt,{onSelectTreeNode:function(m){ht(m)}}),c==="dynamicGroup"&&(0,t.jsx)(Rt,{}),c==="manualInput"&&(0,t.jsx)(N.A.Item,{name:"tags",children:(0,t.jsx)(Ge,{})})]})}),(0,t.jsx)(W.Z,{className:Ce.divider}),U&&$e?(0,t.jsx)(Ke.Z,{actionRef:Ct,columns:[{title:"Agent ID",dataIndex:"agent_id",width:150,sorter:!0},{title:"\u5DE5\u4F5C\u72B6\u6001",dataIndex:"work_status",width:120,render:function(m,y){var q={free:{color:"success",text:"\u7A7A\u95F2"},busy:{color:"cyan",text:"\u7E41\u5FD9"},maintain:{color:"warning",text:"\u7EF4\u62A4"},lock:{color:"error",text:"\u9501\u5B9A"},unknown:{color:"error",text:"\u672A\u77E5"}},he=q[y.work_status];return(0,t.jsx)(at.Z,{color:he.color,children:he.text})}},{title:"\u64CD\u4F5C",valueType:"option",width:80,render:function(m,y){return(0,t.jsx)("a",{onClick:function(){return $t(y)},children:"\u5220\u9664"},"delete")}}],dataSource:G,rowKey:"agent_id",search:!1,options:!1,pagination:{pageSize:5},cardProps:{bodyStyle:{paddingInline:0,paddingBlock:0}},toolbar:{className:Ce.toolBar,filter:(0,t.jsx)(ye.Z,{children:(0,t.jsx)(Ne.ZP,{danger:!0,type:"primary",size:"small",onClick:function(){return Lt()},children:"\u6E05\u7A7A"})})},scroll:{x:530}}):(n.rt_type==="ipSearch"||n.rt_type==="cmdbTree"||n.rt_type==="manualInput"||n.rt_type==="agent")&&(0,t.jsx)(Ke.Z,{columns:[{title:"Agent ID",dataIndex:"agent_id",width:150},{title:"IP",dataIndex:"inner_ip",width:150},{title:"\u4E3B\u673A\u540D",dataIndex:"name",width:200},{title:"\u72B6\u6001",dataIndex:"agent_status",width:100,render:function(m){return(0,t.jsx)(de.Nj,{status:m,statusType:"agent_status"})}},{title:"\u64CD\u4F5C",valueType:"option",width:80,render:function(m,y){return(0,t.jsx)("a",{onClick:function(){return $t(y)},children:"\u5220\u9664"},"delete")}}],dataSource:G,rowKey:"agent_id",search:!1,options:!1,pagination:{pageSize:5},cardProps:{bodyStyle:{paddingInline:0,paddingBlock:0}},toolbar:{className:Ce.toolBar,filter:(0,t.jsxs)(ye.Z,{children:[(0,t.jsx)(Ne.ZP,{danger:!0,type:"primary",size:"small",onClick:function(){return Lt()},children:"\u6E05\u7A7A"}),(0,t.jsx)(Ne.ZP,{danger:!0,size:"small",onClick:function(){return Lt(function(m){return m.agent_status==="1"})},children:"\u5220\u9664\u672A\u5B89\u88C5agent\u4E3B\u673A"})]})},scroll:{x:530}}),n.rt_type==="dynamicGroup"&&!U&&(0,t.jsxs)(ye.Z,{direction:"vertical",style:{width:"100%"},size:1,children:[(0,t.jsxs)(St.Z,{justify:"space-between",children:[(0,t.jsx)(ze.Z,{span:23,children:(0,t.jsxs)(St.Z,{gutter:8,children:[(0,t.jsx)(ze.Z,{span:"100px",children:(0,t.jsx)(yt.Z.Text,{children:"\u5DF2\u9009\u52A8\u6001\u5206\u7EC4"})}),(0,t.jsx)(ze.Z,{span:20,children:(0,t.jsx)(te.Z,{gap:"4px 0",wrap:"wrap",children:p==null?void 0:p.map(function(x){return(0,t.jsx)(at.Z,{color:"green",children:x.name},x.id)})})})]})}),(0,t.jsx)(ze.Z,{span:1,children:(0,t.jsx)(Ne.ZP,{size:"small",onClick:Jt,children:"\u9884\u89C8"})})]}),(0,t.jsx)(Ke.Z,{columns:[{title:"Agent ID",dataIndex:"agent_id",width:150},{title:"IP",dataIndex:"inner_ip",width:150},{title:"\u4E3B\u673A\u540D",dataIndex:"name",width:200},{title:"\u72B6\u6001",dataIndex:"agent_status",width:100,render:function(m){return(0,t.jsx)(de.Nj,{status:m,statusType:"agent_status"})}}],dataSource:We,rowKey:"agent_id",search:!1,options:!1,pagination:{pageSize:5},cardProps:{bodyStyle:{paddingInline:0}},toolbar:{className:Ce.toolBar},scroll:{x:530}})]})]})},_e=Ve},76244:function(It,Qe,e){e.d(Qe,{iF:function(){return J}});var tt=e(82092),a=e.n(tt),nt=e(84338),Be=e(75271),h=e(52676),J=function(C){return C.New="0",C.Waiting="1",C.InProgress="2",C.Completed="3",C.ExecutionError="4",C.ManualProcessing="5",C.Scheduled="7",C.Queued="11",C.ConditionError="24",C}({}),ke=function(C){return C.Online="1",C.Offline="2",C.Unknown="3",C}({}),w={order_state:a()(a()(a()(a()(a()(a()(a()(a()(a()({},J.New,{color:"default",text:"\u65B0\u5EFA"}),J.Waiting,{color:"cyan",text:"\u7B49\u5F85"}),J.InProgress,{color:"blue",text:"\u5904\u7406\u4E2D"}),J.Completed,{color:"green",text:"\u5B8C\u6210"}),J.ExecutionError,{color:"red",text:"\u6267\u884C\u9519\u8BEF"}),J.ManualProcessing,{color:"gold",text:"\u624B\u5DE5\u5904\u7406"}),J.Scheduled,{color:"purple",text:"\u5B9A\u65F6"}),J.Queued,{color:"orange",text:"\u6392\u961F"}),J.ConditionError,{color:"error",text:"\u6761\u4EF6\u9519\u8BEF"}),agent_status:a()(a()(a()({},ke.Online,{color:"green",text:"\u5728\u7EBF"}),ke.Offline,{color:"red",text:"\u79BB\u7EBF"}),ke.Unknown,{color:"default",text:"\u672A\u77E5"}),flow_run_state:{\u6392\u961F\u4E2D:{color:"orange",text:"\u6392\u961F\u4E2D"},\u7EC8\u6B62:{color:"magenta",text:"\u7EC8\u6B62"},\u6210\u529F:{color:"green",text:"\u6210\u529F"},\u5931\u8D25:{color:"error",text:"\u5931\u8D25"},\u5904\u7406\u4E2D:{color:"blue",text:"\u5904\u7406\u4E2D"}}},O=function(Xe){var qe=Xe.status,rt=Xe.statusType,E=w[rt],de=E[qe]||{color:"blue",text:String(qe)};return(0,h.jsx)(nt.Z,{color:de.color,children:de.text})};Qe.ZP=O},99503:function(It,Qe,e){e.d(Qe,{eF:function(){return rt},ML:function(){return wt},oH:function(){return Me.Z},Nj:function(){return Pt.ZP},er:function(){return Bt},lx:function(){return Zt}});var tt=e(26068),a=e.n(tt),nt=e(82187),Be=e.n(nt),h=e(75271),J=e(88230),ke=(0,J.kc)(function(R){var d=R.token;return{input:{width:"45px",height:"45px",padding:"0",fontSize:"24px",textAlign:"center",marginRight:"12px",textTransform:"uppercase",color:"#494949",fontFamily:"SF Pro Text, SF Pro Icons, Helvetica Neue, Helvetica, Arial, sans-serif",border:"1px solid #d6d6d6",borderRadius:"4px",background:"#fff",backgroundClip:"padding-box","&:focus":{appearance:"none",outline:"0",boxShadow:"0 0 0 3px rgb(131 192 253 / 50%)"}}}}),w=ke,O=e(52676),C=["alpha","numeric","alphanumeric"],Xe={alpha:{type:"text",inputMode:"text",pattern:"[a-zA-Z]{1}"},alphanumeric:{type:"text",inputMode:"text",pattern:"[a-zA-Z0-9]{1}"},numeric:{type:"tel",inputMode:"numeric",pattern:"[0-9]{1}",min:"0",max:"9"}},qe=(0,h.forwardRef)(function(R,d){var F=R.allowedCharacters,$=F===void 0?"alphanumeric":F,te=R.ariaLabel,W=R.autoFocus,Q=W===void 0?!0:W,me=R.containerClassName,fe=R.disabled,Se=R.inputClassName,X=R.isPassword,ve=X===void 0?!1:X,xe=R.length,ne=xe===void 0?6:xe,A=R.placeholder,oe=R.onChange;if(isNaN(ne)||ne<1)throw new Error("Length should be a number and greater than 0");if(!C.some(function(i){return i===$}))throw new Error("Invalid value for allowedCharacters. Use alpha, numeric, or alphanumeric");var Ge=w(),Te=Ge.styles,N=Be()(Te.input),Z=(0,h.useRef)([]),le=Xe[$];(0,h.useImperativeHandle)(d,function(){return{focus:function(){Z.current&&Z.current[0].focus()},clear:function(){if(Z.current){for(var r=0;r<Z.current.length;r++)Z.current[r].value="";Z.current[0].focus()}L()}}}),(0,h.useEffect)(function(){Q&&Z.current[0].focus()},[]);for(var L=function(){var r=Z.current.map(function(b){return b.value}).join("");oe&&oe(r)},k=function(r){var b=r.target,n=b.value,g=b.nextElementSibling;n.length>1?(r.target.value=n.charAt(0),g!==null&&g.focus()):n.match(le.pattern)?g!==null&&g.focus():r.target.value="",L()},ye=function(r){var b=r.key,n=r.target;if(b==="Backspace"){if(n.value===""){if(n.previousElementSibling!==null){var g=n.previousElementSibling;g.value="",g.focus(),r.preventDefault()}}else n.value="";L()}},Ee=function(r){r.target.select()},Ie=function(r){for(var b=r.clipboardData.getData("Text"),n=0,g=0;g<b.length;g++){var f=b.charAt(g),v=Z.current[n].value;f.match(le.pattern)&&(v||(Z.current[n].value=f,Z.current[n].nextElementSibling!==null&&(Z.current[n].nextElementSibling.focus(),n++)))}L(),r.preventDefault()},Ve=[],_e=function(r){Ve.push((0,O.jsx)("input",a()(a()({onChange:k,onKeyDown:ye,onFocus:Ee,onPaste:Ie},le),{},{type:ve?"password":le.type,ref:function(n){Z.current[r]=n},maxLength:1,className:N,autoComplete:r===0?"one-time-code":"off","aria-label":te?"".concat(te,". Character ").concat(r+1,"."):"Character ".concat(r+1,"."),disabled:fe,placeholder:A}),r))},I=0;I<ne;I++)_e(I);return(0,O.jsx)("div",{className:me,children:Ve})}),rt=qe,E=e(48305),de=e.n(E),vt=e(67825),Ke=e.n(vt),at=e(12351),it=e(37757),u=e(92480),t=e(50876),ut=e(78602),mt=["showFullScreenButton","fullScreenHeight","initialHeight","maxHeight","dynamicHeight"];u._m.config({monaco:ut});var Le={position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:10015,background:"#1e1e1e"},pt={position:"absolute",right:10,top:10,zIndex:10,padding:"4px 14px",fontSize:20,cursor:"pointer"},D=a()(a()({},pt),{},{zIndex:10020}),ee=function(d){var F=d.showFullScreenButton,$=F===void 0?!1:F,te=d.fullScreenHeight,W=d.initialHeight,Q=W===void 0?"250px":W,me=d.maxHeight,fe=me===void 0?"500px":me,Se=d.dynamicHeight,X=Se===void 0?!1:Se,ve=Ke()(d,mt),xe=(0,h.useState)(!1),ne=de()(xe,2),A=ne[0],oe=ne[1],Ge=(0,h.useState)(d.value),Te=de()(Ge,2),N=Te[0],Z=Te[1],le=(0,h.useRef)(null),L=(0,h.useState)(Q),k=de()(L,2),ye=k[0],Ee=k[1],Ie=(0,h.useRef)(null),Ve=(0,h.useRef)(0),_e=function(){var f=d.theme||"";return typeof f=="string"&&f.includes("dark")?"#fff":"#000"}();(0,h.useEffect)(function(){Z(d.value)},[d.value]);var I=function(){Ie.current&&clearTimeout(Ie.current),Ie.current=setTimeout(function(){if(le.current){var v=le.current.getModel();if(v){var s=v.getLineCount(),H=le.current.getOption(ut.editor.EditorOption.lineHeight)||19,re=s*H+20,V=typeof Q=="string"?parseInt(Q,10):Q,Pe=typeof fe=="string"?parseInt(fe,10):fe,K=Math.max(V,Math.min(re,Pe));Math.abs(K-Ve.current)>2&&(Ve.current=K,Ee("".concat(K,"px")))}}},50)},i=function(v){Z(v),d.onChange&&d.onChange(v,void 0),X&&le.current&&I()},r=function(v){le.current=v,X&&setTimeout(function(){I()},100),d.onMount&&d.onMount(v,ut)};(0,h.useEffect)(function(){return function(){Ie.current&&clearTimeout(Ie.current)}},[]),(0,h.useEffect)(function(){var f=function(s){s.key==="Escape"&&A&&(s.stopPropagation(),s.preventDefault(),oe(!1))};return A&&document.addEventListener("keydown",f,!0),function(){document.removeEventListener("keydown",f,!0)}},[A]);var b={minimap:{enabled:!1},scrollBeyondLastLine:!1,scrollbar:{alwaysConsumeMouseWheel:!1}},n=a()(a()({},b),d.options||{}),g=A?te||"calc(100vh)":X?ye:d.height||Q;return(0,O.jsxs)("div",{style:{position:"relative"},children:[!A&&$&&(0,O.jsx)("div",{style:pt,children:(0,O.jsx)(t.Z,{title:"\u5168\u5C4F\u7F16\u8F91",children:(0,O.jsx)(at.Z,{fill:_e,onClick:function(){return oe(!0)}})})}),A?(0,O.jsxs)("div",{style:Le,children:[(0,O.jsx)("div",{style:D,children:(0,O.jsx)(t.Z,{title:"\u9000\u51FA\u5168\u5C4F",children:(0,O.jsx)(it.Z,{fill:_e,onClick:function(){return oe(!1)}})})}),(0,O.jsx)(u.ZP,a()(a()({},ve),{},{value:N,onChange:i,onMount:r,height:g,options:n}))]}):(0,O.jsx)(u.ZP,a()(a()({},ve),{},{value:N,onChange:i,onMount:r,height:g,options:n}))]})},wt=ee,ot=function(){return _jsx(DefaultFooter,{style:{background:"none"},copyright:"Powered by Ant Desgin",links:[{key:"Ant Design Pro",title:"Ant Design Pro",href:"https://pro.ant.design",blankTarget:!0},{key:"github",title:_jsx(GithubOutlined,{}),href:"https://github.com/ant-design/ant-design-pro",blankTarget:!0},{key:"Ant Design",title:"Ant Design",href:"https://ant.design",blankTarget:!0}]})},zt=null,Me=e(80696),Pt=e(76244),jt=e(54388),Dt=e(66130),Tt=e(90328),Ft=function(d){var F,$,te,W,Q,me=d.label,fe=d.syncUrlParams,Se=fe===void 0?!0:fe,X=d.disabled,ve=X===void 0?!1:X,xe=d.mode,ne=d.showDefaultValue,A=ne===void 0?!0:ne,oe=d.width,Ge=oe===void 0?200:oe,Te=(0,jt.useModel)("@@initialState"),N=Te.initialState,Z=Te.setInitialState,le=(0,Tt.Z)("tenantid",{defaultValue:"502",serializer:function(s){return s},deserializer:function(s){return s}}),L=de()(le,2),k=L[0],ye=L[1],Ee=(0,Tt.Z)("tenant",{defaultValue:"",serializer:function(s){return s},deserializer:function(s){return s}}),Ie=de()(Ee,2),Ve=Ie[0],_e=Ie[1],I=(N==null||(F=N.bizListData)===null||F===void 0?void 0:F.data)||[],i=($=(te=N==null?void 0:N.currentBizId)!==null&&te!==void 0?te:k)!==null&&$!==void 0?$:"502",r=(W=(Q=N==null?void 0:N.currentBizName)!==null&&Q!==void 0?Q:Ve)!==null&&W!==void 0?W:"",b=(0,jt.useSearchParams)(),n=de()(b,2),g=n[0],f=n[1];return(0,h.useEffect)(function(){var v=new URLSearchParams(g.toString()),s=v.get("tenantid"),H=v.get("tenant");s&&H?(ye(s),_e(H),Z(a()(a()({},N),{},{currentBizId:s,currentBizName:H}))):(v.set("tenantid",i),v.set("tenant",r),f(v),ye(i),_e(r))},[i,r]),(0,O.jsx)(Dt.Z,{name:xe?"tenant_list":"tenantid",label:me,showSearch:!0,allowClear:!1,mode:xe,fieldProps:{value:A?i:void 0,disabled:ve},valueEnum:I.reduce(function(v,s){return v[s.biz_id]=s.biz_cn_name,v},{}),style:{width:Ge},placeholder:"\u8BF7\u9009\u62E9\u9879\u76EE",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u9879\u76EE"}],onChange:function(s,H){if(Se){var re=H.title,V=new URLSearchParams(g.toString());V.set("tenantid",s),V.set("tenant",re),f(V),ye(s),_e(re),Z(a()(a()({},N),{},{currentBizId:s,currentBizName:re}))}}})},Bt=Ft,St=e(15558),ze=e(53649),xt=e.n(ze),Ne,yt=(0,J.kc)(function(R){var d=R.css,F=R.token;return{customButton:d(Ne||(Ne=xt()([`
    &.ant-radio-button-wrapper {
      &.selected {
        color: white;
        background: `,`;
        border-color: `,`;
        border-right-color: #d9d9d9;

        &:hover {
          color: white;
          background: `,`;
          border-color: `,`;
          border-right-color: #d9d9d9;
        }
      }

      &::before {
        display: none;
      }
    }
  `])),F.colorPrimary,F.colorPrimary,F.colorPrimary,F.colorPrimary)}});function Nt(R){var d=R.buttonOptions,F=R.localStorageKey,$=F===void 0?"commonflow-selected-tags":F,te=R.defaultValue,W=te===void 0?["all"]:te,Q=yt(),me=Q.styles,fe=useSearchParams(),Se=_slicedToArray(fe,2),X=Se[0],ve=Se[1],xe=React.useState([]),ne=_slicedToArray(xe,2),A=ne[0],oe=ne[1],Ge=useLocalStorageState($,{defaultValue:W}),Te=_slicedToArray(Ge,2),N=Te[0],Z=Te[1];useEffect(function(){var L=X.get("tagId");if(L){var k=L.split(",");oe(k),Z(k)}else N&&N.length>0?oe(N):(oe(W),Z(W))},[X]),useEffect(function(){if(A.length>0){var L=new URLSearchParams(X.toString());L.set("tagId",A.join(",")),ve(L)}},[A]);var le=function(k){var ye=function(){return k==="all"||k==="my_favorite"?A.includes(k)?A.length===1?A:[]:[k]:A.includes(k)?A.length===1?A:A.filter(function(Ee){return Ee!==k}):[].concat(_toConsumableArray(A.filter(function(Ee){return Ee!=="all"&&Ee!=="my_favorite"})),[k])}();oe(ye),Z(ye)};return _jsx(ProForm.Item,{children:_jsx(Radio.Group,{optionType:"button",value:void 0,onChange:function(k){return le(k.target.value)},children:d.map(function(L){return _jsx(Radio.Button,{value:L.value,className:"".concat(me.customButton," ").concat(A.includes(L.value)?"selected":""),children:L.label},L.value)})})})}var Rt=e(84338),At=function(d){var F=d.tags,$=F===void 0?[]:F,te=d.tagColor,W=d.marginTop,Q=W===void 0?4:W,me=d.marginBottom,fe=me===void 0?4:me,Se=d.lineClamp,X=Se===void 0?2:Se,ve=d.tooltipTitle,xe=ve!=null?ve:$.join(", ");return(0,O.jsx)(t.Z,{title:xe,children:(0,O.jsx)("div",{style:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:X,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"pre-wrap"},children:$.map(function(ne){return(0,O.jsx)(Rt.Z,{color:te,style:{marginTop:Q,marginBottom:fe},children:ne},ne)})})})},Zt=At},84286:function(It,Qe,e){e.d(Qe,{AY:function(){return Xe},Hi:function(){return qe},L4:function(){return pt},M0:function(){return J},Xn:function(){return vt},cz:function(){return Le},g3:function(){return mt},g9:function(){return ke},gA:function(){return ut},iT:function(){return E},lZ:function(){return de},nR:function(){return t},pl:function(){return u},sZ:function(){return Ke},ti:function(){return rt},xE:function(){return C}});var tt=e(90228),a=e.n(tt),nt=e(87999),Be=e.n(nt),h=e(23261);function J(){return(0,h.Jl)("/api/job/v2/flow/design/draft/")}function ke(D){return w.apply(this,arguments)}function w(){return w=Be()(a()().mark(function D(ee){return a()().wrap(function(ot){for(;;)switch(ot.prev=ot.next){case 0:return ot.abrupt("return",(0,h.dT)("/api/job/v1/flow/design/draft/",ee));case 1:case"end":return ot.stop()}},D)})),w.apply(this,arguments)}function O(D){return commonGetObj("/api/job/v1/flow/design/draft/",{id:D})}function C(D,ee){return D==="clone"?(0,h.S_)("/api/job/v2/flow/design/clone/",ee):D==="upload"?(0,h.S_)("/api/job/v2/flow/design/import/",ee):(0,h.S_)("/api/job/v2/flow/design/draft/",ee)}function Xe(){return(0,h.dT)("/api/job/v1/executive/script/list/",{page:1,limit:310})}function qe(){return(0,h.dT)("/api/job/v1/executive/api/list/",{page:1,limit:310})}function rt(){return(0,h.dT)("/api/job/v1/flow/design/version/prod/",{})}function E(D,ee){return(0,h.S_)("/api/job/v2/flow/design/version/",ee)}function de(D,ee){return(0,h.dT)("/api/job/v2/flow/design/version/",D,ee)}function vt(){return(0,h.dT)("/api/job/v1/executive/cloudnativetask/list/",{page:1,limit:310})}function Ke(D){return(0,h.dT)("/api/job/v1/task/cnt_agent/list/",D)}function at(){return commonGetListForTable2a("/api/job/v1/flow/design/draft/")}function it(){return commonGetListForTable("/api/job/v2/flow/design/version/")}function u(D){return(0,h.dT)("/api/job/v2/flow/design/flow_version_log_list/",D)}function t(D){return(0,h.B2)("/api/job/v2/flow/design/flow_form_config/",D)}function ut(D,ee){return(0,h.S_)("/api/job/v2/flow/design/flow_form_config/",ee)}function mt(D,ee){return(0,h.S_)("/api/job/v1/flow/form/create/",ee)}function Le(D){return(0,h.B2)("/api/job/v2/flow/design/flow_version_log_detail/",D)}function pt(D){return(0,h.dT)("/api/job/v2/flow/design/flow_version_log_compare/",D)}}}]);
