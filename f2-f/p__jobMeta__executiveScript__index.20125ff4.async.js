"use strict";(self.webpackChunkf2=self.webpackChunkf2||[]).push([[6275],{1743:function(H,_,e){e.d(_,{V2:function(){return g}});var t=15,i=[10,15,20,50,100],g={defaultPageSize:t,showSizeChanger:!0,pageSizeOptions:i}},38419:function(H,_,e){var t=e(90228),i=e.n(t),g=e(87999),o=e.n(g),a=e(99503),l=e(84297),v=e(41901),r=e(75271),B=e(52676),j=function(s){var y=s.changeFlowDesign,S=s.selectedRowsState,F=s.modalTitle,n=F===void 0?"\u6279\u91CF\u66F4\u6539\u4E1A\u52A1":F,h=s.buttonText,O=h===void 0?"\u6279\u91CF\u66F4\u6539\u4E1A\u52A1":h,P=s.buttonType,M=P===void 0?"primary":P,R=s.onSuccess,Q=s.trigger,Y=s.selectListKey,X=Y===void 0?"select_list":Y;return(0,B.jsx)(l.Y,{width:400,title:n,layout:"horizontal",trigger:Q||(0,B.jsx)(v.ZP,{type:M,children:O}),autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},submitTimeout:2e3,onFinish:function(){var U=o()(i()().mark(function ee(te){var C;return i()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return C={tenantid:te.tenantid},C[X]=S.map(function(ce){return String(ce.id)}),k.next=4,y(C);case 4:return R==null||R(),k.abrupt("return",!0);case 6:case"end":return k.stop()}},ee)}));return function(ee){return U.apply(this,arguments)}}(),children:(0,B.jsx)(a.er,{syncUrlParams:!1,showDefaultValue:!1,label:"\u6D41\u7A0B\u6240\u5C5E\u7684\u4E1A\u52A1"})},"clone")};_.Z=j},67254:function(H,_,e){var t=e(26068),i=e.n(t),g=e(67825),o=e.n(g),a=e(53649),l=e.n(a),v=e(99503),r=e(77777),B=e(88230),j=e(75271),E=e(52676),s=["children","extra","ghost","title"],y,S,F=(0,B.kc)(function(h){var O=h.css;return{pageContainer:{"& .ant-page-header-heading":O(y||(y=l()([`
      margin-bottom: -50px;
    `]))),"& .ant-page-header-heading-extra":O(S||(S=l()([`
      position: absolute;
      top: 17px;
      right: 20px;
    `])))}}}),n=function(O){var P=O.children,M=O.extra,R=M===void 0?(0,E.jsx)(v.er,{}):M,Q=O.ghost,Y=Q===void 0?!1:Q,X=O.title,U=X===void 0?!1:X,ee=o()(O,s),te=F(),C=te.styles;return(0,E.jsx)(r._z,i()(i()({ghost:Y,extra:R,className:C.pageContainer,title:U},ee),{},{children:P}))};_.Z=n},78474:function(H,_,e){e.d(_,{j:function(){return g},t:function(){return o}});var t=e(54388),i=e(87300);function g(a,l,v,r,B,j){var E=B!=null?B:i.ZP,s=(0,t.useRequest)(a(l,v),{manual:!0,onSuccess:function(n){if(n.code!==0?E.error(n.msg):E.success(n.msg),j)j();else{var h;r==null||(h=r.current)===null||h===void 0||h.reload(!1)}},onError:function(){E.error("\u64CD\u4F5C\u5931\u8D25")}}),y=s.run,S=s.loading;return{runOpt:y,loading:S}}function o(a){var l=a.optMethod,v=a.optType,r=a.method,B=a.actionRef,j=a.messageApi,E=a.onSuccessCallback,s=a.showSuccessMessage,y=s===void 0?!0:s,S=j!=null?j:i.ZP,F=(0,t.useRequest)(l(v,r),{manual:!0,onSuccess:function(P){var M=typeof P.msg=="string"?P.msg:JSON.stringify(P.msg);if(P.code!==0)S.error(M);else if(E)E(P);else{var R;y&&S.success(M),B==null||(R=B.current)===null||R===void 0||R.reload(!1)}},onError:function(){S.error("\u64CD\u4F5C\u5931\u8D25")}}),n=F.run,h=F.loading;return{runOpt:n,loading:h}}},30168:function(H,_,e){e.d(_,{OV:function(){return i}});var t=e(60164),i=function(a,l){var v=(0,t.ac)({minWidth:l||1700}),r=v?a.wide:a.small;return{isWideScreen:v,width:r}},g=function(a){var l=useMediaQuery({minWidth:1700}),v=useMediaQuery({maxWidth:1699});return l?{type:"wide",width:a.wide}:v?{type:"small",width:a.small}:{type:"small",width:a.small}};_.ZP=i},4778:function(H,_,e){e.d(_,{C1:function(){return o},mL:function(){return i},pj:function(){return g}});var t=e(23261);function i(){return(0,t.dT)("/api/job/v1/executive/script/",{page:1,limit:310})}function g(){return(0,t.dT)("/api/job/v1/meta/voucher/",{page_number:1,page_size:310})}function o(a,l){return(0,t.S_)("/api/job/v1/fast/script/",l)}},95812:function(H,_,e){var t=e(26068),i=e.n(t),g=e(67825),o=e.n(g),a=e(1544),l=e(20877),v=e(52676),r=["alertMessage","children","readOnly","required"],B=function(E){var s=E.alertMessage,y=E.children,S=E.readOnly,F=S===void 0?!1:S,n=E.required,h=o()(E,r);return(0,v.jsxs)(a.Z,i()(i()({},h),{},{required:F?!1:n,style:{marginBottom:0},children:[!F&&(0,v.jsx)("div",{style:{marginBottom:8},children:s&&(0,v.jsx)(l.Z,{type:"info",showIcon:!0,message:s})}),y]}))};_.Z=B},41473:function(H,_,e){e.r(_),e.d(_,{default:function(){return We}});var t=e(26068),i=e.n(t),g=e(90228),o=e.n(g),a=e(87999),l=e.n(a),v=e(48305),r=e.n(v),B=e(1743),j=e(38419),E=e(67254),s=e(78474),y=e(30168),S=e(4778),F=e(54388),n=e(19048),h=e(65496),O=e(90254),P=e(84297),M=e(82715),R=e(37665),Q=e(67870),Y=e(84249),X=e(87300),U=e(38902),ee=e(64085),te=e(41901),C=e(75271),Fe=e(14443),k=e(44725),ce=e(99503),ye=e(36903),ve=e(54805),Pe=e(14201),Ee=e(1544),Me=e(66130),he=e(61487),ue=e(95812),u=e(52676),Te=function(b){var f=b.form,D=b.readOnly,d=D===void 0?!1:D,J=b.voucherList;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(M.Z,{name:"script_name",label:"\u811A\u672C\u540D\u79F0",required:!d,rules:d?[]:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],fieldProps:{maxLength:80}}),(0,u.jsx)(ue.Z,{label:"\u6267\u884C\u547D\u4EE4",required:!0,readOnly:d,alertMessage:(0,u.jsxs)(u.Fragment,{children:["\u5982\u679C\u6267\u884C\u672C\u5730\u811A\u672C\u76F4\u63A5\u8F93\u5165\u547D\u4EE4 \u4F8B\u5982\uFF1Apython3 /home/xxx.py",(0,u.jsx)("br",{}),"\u5982\u679C\u6267\u884C\u5F55\u5165\u7684\u811A\u672C\u5185\u5BB9\u8BF7\u7528 $","{script_path}","\u4EE3\u66FF\u811A\u672C\u540D\uFF0C\u4F8B\u5982\uFF1A$","{script_path}"," \uFF0C windows\u7CFB\u7EDF\u9700\u8981\u6307\u5B9A\u89E3\u91CA\u5668 \u4F8B\u5982\uFF1Apython $","{script_path}"]}),children:(0,u.jsx)(M.Z,{name:"exec_name",rules:[{required:!0,message:"\u6267\u884C\u547D\u4EE4\u4E0D\u80FD\u4E3A\u7A7A"}],fieldProps:{maxLength:250}})}),(0,u.jsx)(ve.Z.Group,{name:"script_type",label:"\u8BED\u8A00\u7C7B\u578B",radioType:"button",options:[{label:"Shell",value:"sh"},{label:"Python",value:"python"},{label:"GO",value:"go"},{label:"Lua",value:"lua"},{label:"Perl",value:"perl"},{label:"PHP",value:"php"},{label:"JavaScript",value:"javascript"},{label:"TypeScript",value:"typescript"}]}),(0,u.jsx)(ue.Z,{label:"\u811A\u672C\u5185\u5BB9",style:{marginBottom:24},readOnly:d,alertMessage:"\u5982\u679C\u4EC0\u4E48\u90FD\u4E0D\u586B\u9ED8\u8BA4\u4F1A\u4ECE\u4E0A\u9762\u7684\u8DEF\u5F84\u6765\u8C03\u7528\uFF0C\u5982\u679C\u586B\u5199\u4E86\u5185\u5BB9\uFF0C\u5C31\u628A\u5185\u5BB9\u5199\u8FDB\u53BB",children:(0,u.jsx)(Pe.Z,{name:["script_type"],children:function(w){var q=w.script_type;return(0,u.jsx)(Ee.Z,{name:"script_info",style:{marginTop:16},children:(0,u.jsx)(ce.ML,{maxHeight:"750px",dynamicHeight:!0,showFullScreenButton:!0,value:f.getFieldValue("script_info"),language:ye.JH[q]||"plaintext",theme:"vs-dark",onChange:function(T){return f.setFieldValue("script_info",T)},options:{readOnly:d,scrollbar:{alwaysConsumeMouseWheel:!1}}})})}})}),(0,u.jsx)(ue.Z,{label:"\u53C2\u6570",readOnly:d,alertMessage:"\u5185\u7F6E\u53D8\u91CF\u5F53\u524D\u8BA2\u5355\u53F7 FLOW_ID \u5F53\u524D\u8FD0\u884C\u8282\u70B9\u7F16\u53F7 NODE_ID \u76F4\u63A5\u5728\u547D\u4EE4\u884C\u53C2\u6570\u7528\u4F7F\u7528",children:(0,u.jsx)(M.Z,{name:"script_params",fieldProps:{maxLength:250}})}),(0,u.jsx)(ue.Z,{label:"\u5168\u5C40\u53D8\u91CF",readOnly:d,alertMessage:(0,u.jsxs)(u.Fragment,{children:["\u5B9A\u4E49\u5168\u5C40\u53D8\u91CF\uFF0C\u6700\u7EC8\u8F93\u51FA\u7684\u5185\u5BB9\u5305\u542B\u5982\u4E0B\u7684key\u7684\u65F6\u5019\uFF0C\u5C06\u4F1A\u88AB\u5168\u5C40\u4FDD\u5B58\uFF0C\u53EF\u4EE5\u4F5C\u4E3A\u5224\u65AD\u6761\u4EF6\u7B49\uFF0C\u591A\u4E2A\u53D8\u91CF\u8BF7\u4EE5\u7A7A\u683C\u8FDB\u884C\u5206\u5272\uFF0C\u5982\u679C\u5168\u5C40\u53D8\u91CF\u51B2\u7A81\u5219\u4F1A\u88AB\u8986\u76D6\u3002",(0,u.jsx)("br",{}),"\u82E5\u4F7F\u7528 need_get_all \u5173\u952E\u5B57\u5219\u4F1A\u83B7\u53D6\u6240\u6709\u7684\u8F93\u51FA",(0,u.jsx)("br",{}),"\u53EA\u6709\u5728\u5355\u4E2A\u8282\u70B9\u811A\u672C\u4EFB\u52A1\u4E0B\u751F\u6548\uFF0C\u83B7\u53D6\u65E5\u5FD7\u4E2D\u4EE5###SOF###\u5F00\u5934\uFF0C\u4EE5###EOF###\u7ED3\u5C3E\u7684\u6570\u636E\uFF08\u53EA\u83B7\u53D6\u6700\u540E\u5339\u914D\u7684\uFF09\uFF0C\u5982\u679C\u4E3Ajson\u683C\u5F0F\u5219\u53EF\u4EE5\u4FDD\u5B58\u4E3A\u811A\u672C\u8F93\u51FA\u6570\u636E\uFF0C\u5207\u8BB0json\u7684\u5F15\u53F7\u4E3A\u53CC\u5F15\u53F7\u3002"]}),children:(0,u.jsx)(M.Z,{name:"global_variable",fieldProps:{maxLength:128}})}),(0,u.jsx)(ue.Z,{label:"\u51ED\u8BC1\u4FE1\u606F",readOnly:d,alertMessage:"\u77ED\u5B57\u7B26\uFF1A\u4F7F\u7528\u53D8\u91CF\u65B9\u5F0F\u63D0\u4F9B\u51ED\u8BC1\uFF0C\u8D26\u53F7\u5BC6\u7801\u5C5E\u4E8E\u77ED\u5B57\u7B26\u8BF7\u81EA\u884C\u5904\u7406\uFF1B\u957F\u6587\u672C\uFF1A\u5199\u5165\u5DE5\u4F5C\u76EE\u5F55\uFF0C\u63D0\u4F9B\u8BFB\u53D6\u7684\u6587\u4EF6\u8DEF\u5F84\u3002",children:(0,u.jsx)(Me.Z,{name:"voucher_info",mode:"multiple",fieldProps:{maxLength:250,showSearch:!0},options:J.map(function(Z){return{label:Z.v_key,value:"".concat(Z.tenantid,"___").concat(Z.v_key,"___").concat(Z.v_type)}})})}),(0,u.jsx)(Ee.Z,{label:"\u6267\u884C\u63A7\u5236",required:!d,tooltip:"\u914D\u7F6E\u811A\u672C\u6267\u884C\u7684\u8D85\u65F6\u65F6\u95F4\u548C\u91CD\u8BD5\u673A\u5236",style:{marginBottom:0},children:(0,u.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,u.jsx)("div",{style:{flex:1},children:(0,u.jsx)(he.Z,{name:"time_out",label:"\u9ED8\u8BA4\u8D85\u65F6",required:!d,rules:d?[]:[{required:!0,message:"\u9ED8\u8BA4\u8D85\u65F6\u4E0D\u80FD\u4E3A\u7A7A"}],min:20,max:18e7,fieldProps:{addonAfter:"\u79D2"}})}),(0,u.jsx)("div",{style:{flex:1},children:(0,u.jsx)(he.Z,{name:"retry",label:"\u5931\u8D25\u91CD\u8BD5",required:!d,rules:d?[]:[{required:!0,message:"\u5931\u8D25\u91CD\u8BD5\u4E0D\u80FD\u4E3A\u7A7A"}],min:0,max:10,fieldProps:{addonAfter:"\u6B21"}})})]})}),(0,u.jsx)(ue.Z,{label:"\u7EC8\u6B62\u4EFB\u52A1",readOnly:d,alertMessage:"\u8BA2\u5355\u7ED3\u675F\u3001\u624B\u52A8\u7EC8\u6B62\u3001\u624B\u52A8\u91CD\u8BD5\u65F6\uFF0C\u6740\u6B7B\u672C\u4EFB\u52A1\u7684\u8FDB\u7A0B\u6811\u3002\u9700\u8981\u5347\u7EA7agent\u7248\u672C\uFF0C\u9AD8\u4E8EV1.3.27\u65F6\uFF0C\u672C\u529F\u80FD\u751F\u6548\u3002",children:(0,u.jsx)(ve.Z.Group,{name:"force_kill_tree_in_cancel",options:[{label:"\u4E0D\u7EC8\u6B62",value:"no"},{label:"\u7EC8\u6B62",value:"yes"}]})})]})},Le=Te,Re=function(b){var f=b.drawerData,D=b.scriptData,d=b.onVisibleChange,J=b.onSubmit,Z=b.voucherList,w=k.Z.useForm(),q=r()(w,1),K=q[0],T=X.ZP.useMessage(),ne=r()(T,2),re=ne[1];return(0,C.useEffect)(function(){f.show&&D&&K.setFieldsValue({script_name:D.script_name,exec_name:D.exec_name,script_params:D.script_params,script_type:D.script_type,script_info:D.script_info,resource_group:D.resource_group,time_out:D.time_out,retry:D.retry,global_variable:D.global_variable,force_kill_tree_in_cancel:D.force_kill_tree_in_cancel,voucher_info:D.voucher_info})},[f.show]),(0,u.jsxs)(Fe.a,{form:K,title:f.title,open:f.show,onOpenChange:d,width:"65%",layout:"horizontal",labelCol:{flex:"120px"},drawerProps:{maskClosable:!1,destroyOnClose:!0},onFinish:function(){var I=l()(o()().mark(function A($){var V;return o()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,J($);case 2:if(V=L.sent,(V==null?void 0:V.code)!==0){L.next=5;break}return L.abrupt("return",!0);case 5:return L.abrupt("return",!1);case 6:case"end":return L.stop()}},A)}));return function(A){return I.apply(this,arguments)}}(),initialValues:{script_name:"",exec_name:"${script_path}",script_path:"",script_type:"sh",script_info:`#! /bin/bash 
set -o pipefail 
echo 'hello world'`,script_params:"",global_variable:"need_get_all",time_out:600,retry:0,force_kill_tree_in_cancel:"no"},children:[re,(0,u.jsx)(Le,{form:K,voucherList:Z})]})},Ie=Re,N=e(16214),Ze=function(b){var f=b.id,D=(0,C.useState)(""),d=r()(D,2),J=d[0],Z=d[1],w=(0,R.Z)(J,{wait:300}),q=(0,F.useRequest)(function(){return(0,N.T_)({id:f})},{refreshDeps:[f],formatResult:function(A){return A.data.items||[]}}),K=q.data,T=K===void 0?[]:K,ne=T.filter(function(I){var A,$,V,z;return!w||((A=I.id)===null||A===void 0||(A=A.toString())===null||A===void 0?void 0:A.toLowerCase().includes(w.toLowerCase()))||(($=I.name)===null||$===void 0?void 0:$.toLowerCase().includes(w.toLowerCase()))||((V=I.resource_group)===null||V===void 0?void 0:V.toLowerCase().includes(w.toLowerCase()))||((z=I.flow_version_id)===null||z===void 0||(z=z.toString())===null||z===void 0?void 0:z.toLowerCase().includes(w.toLowerCase()))}),re=[{title:"ID",dataIndex:"id",width:60},{title:"\u540D\u79F0",dataIndex:"name",ellipsis:!0,width:200},{title:"\u53D1\u5E03ID",dataIndex:"flow_version_id",width:80,ellipsis:!0},{title:"\u7C7B\u578B",dataIndex:"flow_type",width:80,ellipsis:!0},{title:"\u4E1A\u52A1",dataIndex:"resource_group",width:110},{title:"\u66F4\u65B0\u4EBA",dataIndex:"reviser",width:100},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"update_time",width:150}];return(0,u.jsx)(O.Z,{rowKey:"id",search:!1,defaultSize:"small",options:!1,dataSource:ne,columns:re,toolbar:{title:(0,u.jsx)(Q.Z,{children:(0,u.jsx)(Y.Z,{prefix:(0,u.jsx)(n.Z,{}),style:{width:300},placeholder:"\u8F93\u5165\u5173\u952E\u5B57\u641C\u7D22",allowClear:!0,value:J,onChange:function(A){return Z(A.target.value)}})})},pagination:{showSizeChanger:!0,defaultPageSize:10}})},we=function(){var b,f=(0,C.useRef)(),D=(0,C.useState)(""),d=r()(D,2),J=d[0],Z=d[1],w=(0,R.Z)(J,{wait:300}),q=X.ZP.useMessage(),K=r()(q,2),T=K[0],ne=K[1],re=(0,F.useModel)("@@initialState"),I=re.initialState,A=(b=I==null?void 0:I.currentBizId)!==null&&b!==void 0?b:"",$=A==="500",V=(0,C.useState)([]),z=r()(V,2),L=z[0],Ue=z[1],Ce=(0,s.j)(N.oR,void 0,"DELETE",f,T),Ke=Ce.runOpt,$e=Ce.loading,Ve=(0,F.useSearchParams)(),ze=r()(Ve,1),pe=ze[0];(0,C.useEffect)(function(){var p;(p=f.current)===null||p===void 0||p.reload()},[pe]);var Ge=(0,C.useState)(!1),fe=r()(Ge,2),He=fe[0],ie=fe[1],Ne=(0,C.useState)(),De=r()(Ne,2),ae=De[0],me=De[1],Je=(0,F.useRequest)(function(){return(0,S.pj)()},{refreshDeps:[A],onSuccess:function(c){console.log(c)}}),ge=Je.data,Qe=ge===void 0?[]:ge,Ye=(0,y.ZP)({small:170,wide:140}),Xe=Ye.width,ke=(0,s.j)(N.m1,"create","POST",f,T),qe=ke.runOpt,eu=(0,s.j)(N.m1,"update","PUT",f,T),uu=eu.runOpt,tu=(0,s.j)(N.m1,"change","PATCH",f,T),nu=tu.runOpt,ru=(0,s.j)(N.xQ,void 0,"POST",f,T),au=ru.runOpt,su=(0,s.j)(N.gt,void 0,"POST",f,T),Du=su.runOpt,iu=(0,C.useState)("update_time"),Be=r()(iu,2),ou=Be[0],lu=Be[1],cu=(0,C.useState)("descend"),Se=r()(cu,2),du=Se[0],pu=Se[1],mu=(0,C.useState)([]),Ae=r()(mu,2),gu=Ae[0],xe=Ae[1],_u=(0,C.useState)(!1),Oe=r()(_u,2),Fu=Oe[0],_e=Oe[1],vu=(0,C.useState)(null),be=r()(vu,2),oe=be[0],Eu=be[1],hu=(0,F.useRequest)(N.R8,{manual:!0,onSuccess:function(c){console.log("res",c),(c==null?void 0:c.length)>0?(me(c[0]),ie(!0)):T.error("\u672A\u627E\u5230\u76F8\u5173\u6570\u636E")}}),je=hu.run;(0,C.useEffect)(function(){var p=pe.get("exec_uuid");p&&je({filter_map:{exec_uuid:p}})},[pe,je]);var Cu=[{title:"\u540D\u79F0",dataIndex:"script_name",width:220,ellipsis:!0,sorter:!0},{title:"\u547D\u4EE4",dataIndex:"exec_name",width:180,ellipsis:!0},{title:"\u4E1A\u52A1",dataIndex:"resource_group",width:90},{title:" \u66F4\u65B0\u4EBA",dataIndex:"creator",width:100,sorter:!0},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"update_time",width:120,sorter:!0,defaultSortOrder:"descend"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",width:Xe,fixed:"right",render:function(c,m){return[(0,u.jsx)(U.Z.Link,{onClick:function(){Eu(m),_e(!0)},children:"\u5F15\u7528\u6D41\u7A0B"},"sync"),(0,u.jsx)(P.Y,{width:600,title:"\u514B\u9686\u811A\u672C\u2014".concat(m.script_name),layout:"horizontal",trigger:(0,u.jsx)(U.Z.Link,{disabled:$,children:"\u514B\u9686"}),autoFocusFirstInput:!0,modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},submitTimeout:2e3,onFinish:function(){var x=l()(o()().mark(function G(le){return o()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,au({script_name:le.script_name,id:m.id});case 2:return se.abrupt("return",!0);case 3:case"end":return se.stop()}},G)}));return function(G){return x.apply(this,arguments)}}(),children:(0,u.jsx)(M.Z,{name:"script_name",label:"\u811A\u672C\u540D\u79F0",tooltip:"\u811A\u672C\u540D\u79F0\u662F\u552F\u4E00\u503C\uFF0C\u4E0D\u80FD\u91CD\u590D",fieldProps:{maxLength:50},rules:[{required:!0,message:"\u65B0\u811A\u672C\u7684\u540D\u5B57\u4E0D\u80FD\u4E3A\u7A7A!"}]})},"clone"),(0,u.jsx)(U.Z.Link,{onClick:function(){me(m),ie(!0)},disabled:$,children:"\u7F16\u8F91"},"edit"),(0,u.jsx)(U.Z.Link,{onClick:function(){return F.history.push("/jobMeta/executiveScript/".concat(m.id))},disabled:$,children:"\u7248\u672C"},"version"),(0,u.jsx)(ee.Z,{title:"\u5220\u9664\u811A\u672C",description:(0,u.jsxs)(u.Fragment,{children:["\u5220\u9664\u811A\u672C\u300A",m.script_name,"\u300B\u4E4B\u540E\u65E0\u6CD5\u627E\u56DE\uFF0C\u8BF7\u8C28\u614E\u64CD\u4F5C\uFF01"]}),onConfirm:function(){return Ke({id:m.id})},okButtonProps:{loading:$e},children:(0,u.jsx)(U.Z.Link,{type:"danger",children:"\u5220\u9664"})},"delete")]}}],fu=function(){me(void 0),ie(!0)};return(0,u.jsxs)(E.Z,{ghost:!1,children:[ne,(0,u.jsx)(O.Z,{actionRef:f,columns:Cu,defaultSize:"small",params:{searchValue:w,order_by:ou||"update_time",order:du},request:(0,N.DO)(),rowKey:"id",search:!1,scroll:{x:1200},dateFormatter:"string",rowSelection:{onChange:function(c,m){Ue(m)}},tableAlertRender:function(c){var m=c.selectedRowKeys,x=c.onCleanSelected;return(0,u.jsx)(Q.Z,{size:24,children:(0,u.jsxs)("span",{children:["\u5DF2\u9009 ",m.length," \u9879",(0,u.jsx)("a",{style:{marginInlineStart:8},onClick:x,children:"\u53D6\u6D88\u9009\u62E9"})]})})},tableAlertOptionRender:function(c){var m=c.onCleanSelected;return(L==null?void 0:L.length)>0&&(0,u.jsx)(j.Z,{changeFlowDesign:function(G){return nu(G)},selectedRowsState:L,buttonText:"\u6279\u91CF\u66F4\u6539\u4E1A\u52A1",onSuccess:function(){m()}})},toolbar:{title:(0,u.jsx)(Q.Z,{children:(0,u.jsx)(Y.Z,{prefix:(0,u.jsx)(n.Z,{}),style:{width:350},placeholder:"\u8F93\u5165\u5173\u952E\u5B57\u641C\u7D22\uFF1A\u811A\u672C\u540D\u79F0\u3001\u547D\u4EE4\u7B49",allowClear:!0,value:J,onChange:function(c){return Z(c.target.value)}})})},toolBarRender:function(){return[(0,u.jsx)(te.ZP,{type:"primary",icon:(0,u.jsx)(h.Z,{}),onClick:fu,disabled:$,children:"\u6DFB\u52A0\u811A\u672C"},"add")]},pagination:B.V2,onChange:function(c,m,x){var G=x.field,le=x.order;lu(G),pu(le)}}),(0,u.jsx)(Ie,{drawerData:{show:He,title:ae?"\u7F16\u8F91\u811A\u672C":"\u65B0\u589E\u811A\u672C",action:ae?"put":"post"},scriptData:ae,onVisibleChange:function(c){ie(c)},voucherList:Qe,onSubmit:function(){var p=l()(o()().mark(function c(m){var x,G;return o()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(x=i()(i()({},ae),m),!ae){W.next=7;break}return W.next=4,uu(x);case 4:G=W.sent,W.next=10;break;case 7:return W.next=9,qe(m);case 9:G=W.sent;case 10:return W.abrupt("return",G);case 11:case"end":return W.stop()}},c)}));return function(c){return p.apply(this,arguments)}}()}),(0,u.jsx)(P.Y,{width:1100,title:oe?"\u811A\u672C\u300A".concat(oe.script_name,"\u300B\u5173\u8054\u7684\u6D41\u7A0B"):"",open:Fu,modalProps:{destroyOnClose:!0,onCancel:function(){xe([]),_e(!1)}},submitter:{resetButtonProps:{style:{display:"none"}},searchConfig:{submitText:"\u786E\u5B9A"}},onFinish:l()(o()().mark(function p(){return o()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return _e(!1),xe([]),m.abrupt("return",!0);case 3:case"end":return m.stop()}},p)})),children:oe&&(0,u.jsx)(Ze,{id:oe.id})})]})},We=we},16214:function(H,_,e){e.d(_,{DO:function(){return i},Ec:function(){return v},R8:function(){return g},T_:function(){return F},gt:function(){return y},m1:function(){return j},nj:function(){return a},oR:function(){return r},wh:function(){return l},xQ:function(){return E}});var t=e(23261);function i(n){return(0,t.eg)("/api/job/v1/executive/script/",n)}function g(n){return(0,t.dT)("/api/job/v1/executive/script/",n)}function o(n){return commonGetList("/api/job/v1/executive/script/",n)}function a(n){return(0,t.Jl)("/api/job/v2/executive/script/version/",n)}function l(){return(0,t.S_)("/api/job/v2/executive/script/version/","POST")}function v(){return(0,t.S_)("/api/job/v2/executive/script/version/","PUT")}function r(){return(0,t.S_)("/api/job/v1/executive/script/","DELETE")}function B(n){return commonOperationApi("/api/job/v1/executive/script/","PATCH")}function j(n,h){return n==="change"?(0,t.S_)("/api/job/v1/executive/script/",h):(0,t.S_)("/api/job/v2/executive/script/",h)}function E(){return(0,t.S_)("/api/job/v2/executive/script/clone/","POST")}function s(n){return commonGetList("/api/job/v1/executive/script/relationship/",n)}function y(){return(0,t.S_)("/api/job/v1/executive/script/syncflow/","POST")}function S(n,h){return commonOperationApi("/api/job/v1/flow/run/node/",h)}function F(n){return(0,t.W8)("/api/job/v1/resource/script_associate/",n)}},36903:function(H,_,e){e.d(_,{H0:function(){return o},JH:function(){return g},zB:function(){return i}});var t="cli_a270b45f63b9100b",i={free:"\u7A7A\u95F2",busy:"\u7E41\u5FD9",lock:"\u9501\u5B9A",offline:"\u79BB\u7EBF",maintain:"\u7EF4\u62A4"},g={python:"python",sh:"shell",go:"go",lua:"lua",perl:"perl",php:"php",javascript:"javascript",typescript:"typescript"},o=`
require:
  fields:
    - "field_1"
  vouchers:
    - "voucher1"
# [\u53EF\u9009] pod \u7684\u8D44\u6E90\u9650\u5236
# \u7528\u6237\u53EF\u4EE5\u9009\u62E9\u5728\u4EFB\u52A1\u7EA7\u6307\u5B9A\u8D44\u6E90\u9700\u6C42\uFF0C\u800C\u4E0D\u662F\u5728\u6BCF\u4E2A Step \u4E0A\u6307\u5B9A\u8D44\u6E90\u9700\u6C42\u3002\u5982\u679C\u7528\u6237\u6307\u5B9A\u4E86\u4EFB\u52A1\u7EA7\u8D44\u6E90\u8981\u6C42\uFF0C
# \u5B83\u5C06\u786E\u4FDD kubelet \u53EA\u4E3A\u6267\u884C Task \u7684 Steps \u4FDD\u7559\u8BE5\u6570\u91CF\u7684\u8D44\u6E90\u3002\u5982\u679C\u7528\u6237\u6307\u5B9A\u4E86\u4EFB\u52A1\u7EA7\u8D44\u6E90\u9650\u5236\uFF0C\u5219\u4EFB\u4F55 Step \u90FD\u4E0D\u80FD\u4F7F\u7528\u8D85\u8FC7\u8BE5\u6570\u91CF\u7684\u8D44\u6E90\u3002
computeResources:
  requests:
    memory: "64Mi" # \u7533\u8BF7 512 MB \u7684\u5185\u5B58
    cpu: "30m" # \u7533\u8BF7 1 Core \u7684 CPU
  limits:
    memory: "64Mi" # \u7533\u8BF7 512 MB \u7684\u5185\u5B58
    cpu: "30m" # \u7533\u8BF7 1 Core \u7684 CPU
# [\u5FC5\u9009] \u4EFB\u52A1\u5B9A\u4E49
taskSpec:
  # [\u5FC5\u9009] \u4EFB\u52A1\u5C55\u793A\u540D\u79F0
  displayName: "cc-test"
  # [\u53EF\u9009] \u63CF\u8FF0
  description: "\u8FD9\u662F\u4E00\u4EFD\u63CF\u8FF0"
  # [\u5FC5\u9009] \u4EFB\u52A1\u6B65\u9AA4\u5B9A\u4E49
  # \u4EFB\u52A1\u6709\u4E24\u79CD\u6A21\u5F0F(\u53EA\u80FD\u9009\u5176\u4E00)
  # - script \u6A21\u5F0F:
  # - command \u6A21\u5F0F:
  steps:
    # [\u5FC5\u9009] \u6B65\u9AA4\u540D\u79F0
    - name: "hello world"
      # [\u53EF\u9009] \u5F53 step \u51FA\u9519\u65F6\u7684\u5904\u7406\u65B9\u5F0F
      # [ continue | stopAndFail  | waitUntilTimeout ]
      onError: waitUntilTimeout
      # [\u53EF\u9009] \u8D85\u65F6\u65F6\u95F4(\u9ED8\u8BA460\u5206\u949F)
      # \u6301\u7EED\u65F6\u95F4\u5B57\u7B26\u4E32\u662F\u53EF\u80FD\u6709\u7B26\u53F7\u7684\u5341\u8FDB\u5236\u6570\u5B57\u5E8F\u5217\uFF0C\u6BCF\u4E2A\u5341\u8FDB\u5236\u6570\u5B57\u90FD\u5E26\u6709\u53EF\u9009\u7684\u5206\u6570\u548C\u5355\u4F4D\u540E\u7F00\uFF0C
      # \u4F8B\u5982\u201C300ms\u201D\u3001\u201C-1.5h\u201D\u6216\u201C2h45m\u201D\u3002\u6709\u6548\u7684\u65F6\u95F4\u5355\u4F4D\u4E3A\u201Cns\u201D\u3001\u201Cus\u201D\uFF08\u6216\u201C\u03BCs\u201D\uFF09\u3001\u201Cms\u201D\u3001\u201Cs\u201D\u3001\u201Cm\u201D\u3001\u201Ch\u201D\u3002
      timeout: "200s"
      # [\u5FC5\u9009] \u4EFB\u52A1\u8FD0\u884C\u6240\u5904\u7684\u955C\u50CF
      image: "harbor.123u.com/public/rocky9.1-python3:latest"
      # [\u5FC5\u9009] \u8FD0\u884C\u7684\u811A\u672C(\u4E0E command \u4E8C\u9009\u4E00)
      script: |
        #!/bin/sh
        set -euo pipefail
        echo hello world

`}}]);
