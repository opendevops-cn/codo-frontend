(window["webpackJsonp_cmdb"]=window["webpackJsonp_cmdb"]||[]).push([["chunk-5ab71d9c","chunk-2d0ae8c9"],{"0b12":function(t,e,a){"use strict";a.r(e),a.d(e,"postTreeAsset",(function(){return i})),a.d(e,"getTreeAsset",(function(){return s})),a.d(e,"changeTreeAssetStatus",(function(){return r})),a.d(e,"deleteTreeAsset",(function(){return l})),a.d(e,"getRelation",(function(){return c})),a.d(e,"getServiceTreelist",(function(){return o})),a.d(e,"operationTree",(function(){return d})),a.d(e,"getBizEnv",(function(){return h}));var n=a("be3b");const i=t=>Object(n["default"])({url:"/api/v2/cmdb/tree/asset/",method:"post",data:t}),s=t=>Object(n["default"])({url:"/api/v2/cmdb/tree/asset/",method:"get",params:t}),r=t=>Object(n["default"])({url:"/api/v2/cmdb/tree/asset/",method:"patch",data:t}),l=t=>Object(n["default"])({url:"/api/v2/cmdb/tree/asset/",method:"delete",data:t}),c=t=>Object(n["default"])({url:"/api/v2/cmdb/tree/asset/relation/",method:"get",params:t}),o=t=>Object(n["default"])({url:"/api/v2/cmdb/tree/",method:"get",params:t}),d=(t,e)=>Object(n["default"])({url:"/api/v2/cmdb/tree/",method:e,data:t}),h=t=>Object(n["default"])({url:"/api/v2/cmdb/tree/env/",method:"get",params:t})},"1ade":function(t,e,a){},"229e":function(t,e,a){"use strict";a("1ade")},b793:function(t,e,a){},c03a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("Drawer",{attrs:{title:t.modalData.title,styles:t.styles,width:"70%",draggable:"","mask-closable":!1},on:{"on-close":t.handleCancel},model:{value:t.modalData.show,callback:function(e){t.$set(t.modalData,"show",e)},expression:"modalData.show"}},[e("div",{staticClass:"search-con search-con-top"},[e("div",{staticClass:"search-col"},[e("b",[t._v("选择主机:")])]),e("Cascader",{staticClass:"search-input",attrs:{data:t.treeData,"change-on-select":"",placeholder:"通过拓扑选择主机"},on:{"on-change":t.handleChange},model:{value:t.topoList,callback:function(e){t.topoList=e},expression:"topoList"}})],1),e("Table",{attrs:{size:"small",columns:t.columns,data:t.tableData}}),e("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[e("div",{staticStyle:{float:"left"}},[e("Page",{attrs:{total:t.i.pageTotal,current:t.initPara.page_number,"page-size":t.initPara.page_size,"show-total":"","show-sizer":"","page-size-opts":[15,50,100]},on:{"on-change":t.handlerChangePage,"on-page-size-change":t.handlePageSize}})],1)]),e("div",{staticClass:"drawer-footer"},[e("Button",{staticStyle:{"margin-right":"8px"},on:{click:t.handleCancel}},[t._v("取消")]),e("Button",{staticStyle:{"margin-right":"8px"},attrs:{type:"warning"},on:{click:function(e){return t.handleSubmit()}}},[t._v("关联")])],1)],1)},i=[],s=a("0b12"),r={components:{},name:"regionAsset",props:{modalData:{type:Object,default:{}}},data(){return{topoList:[],params:{},treeData:[],initPara:{page_number:1,page_size:15,searchVal:null},i:{pageTotal:0,tableLoading:!1},tableData:[],columns:[{title:"环境",key:"env_name",width:100,align:"center"},{title:"集群",key:"region_name",minWidth:120,maxWidth:150,align:"center"},{title:"模块",key:"module_name",minWidth:120,maxWidth:170,align:"center"},{title:"资源名",key:"name",minWidth:150,align:"center"},{title:"内网IP",key:"inner_ip",minWidth:120,maxWidth:170,align:"center"},{title:"状态",key:"state",minWidth:110,maxWidth:140,align:"center"}],styles:{height:"calc(100% - 55px)",overflow:"auto",paddingBottom:"53px",position:"static"}}},methods:{handleCancel(){this.$emit("close")},async handleGetData(){const t=await Object(s["getServiceTreelist"])();0==t.code?(this.treeData=t.data,this.changeId2(this.treeData,"title","label","value")):this.$Notice.error({title:""+t.msg})},async handleGetAssetData(){this.params=Object.assign(this.params,this.initPara);const t=await Object(s["getTreeAsset"])(this.params);0==t.code?(this.tableData=t.data,this.i.pageTotal=t.count):this.$Notice.error({title:""+t.msg})},changeId2(t,e,a,n){null!=t&&t.forEach(t=>{Object.assign(t,{[a]:t[e],[n]:t[e]}),this.changeId2(t.children,e,a,n)})},handleChange(t){this.params={asset_type:"server"},t.length>=1&&(this.params["biz_cn"]=t[0]),t.length>=2&&(this.params["env_name"]=t[1]),t.length>=3&&(this.params["region_name"]=t[2]),4==t.length&&(this.params["module_name"]=t[3]),this.handleGetAssetData()},handleSubmit(){this.$emit("relevance",{id:this.modalData.id,topoParams:this.params})},handlerChangePage(t){this.initPara.page_number=t,this.handleGetAssetData()},handlePageSize(t){this.initPara.page_number=1,this.initPara.page_size=t,this.handleGetAssetData()}},watch:{},computed:{},mounted(){this.handleGetData()}},l=r,c=(a("d9d8"),a("229e"),a("2877")),o=Object(c["a"])(l,n,i,!1,null,"7ced1199",null);e["default"]=o.exports},d9d8:function(t,e,a){"use strict";a("b793")}}]);
//# sourceMappingURL=chunk-5ab71d9c.9b65cb29.js.map