(window["webpackJsonp_cmdb"]=window["webpackJsonp_cmdb"]||[]).push([["chunk-a0c71f3c","chunk-2d0aba0d"],{"15a4":function(t,e,n){"use strict";n.r(e),n.d(e,"getDomain",(function(){return l})),n.d(e,"optDomain",(function(){return o})),n.d(e,"syncDomain",(function(){return i})),n.d(e,"getDomainRecords",(function(){return r})),n.d(e,"optDomainRecords",(function(){return s})),n.d(e,"recordsChangeRemark",(function(){return d})),n.d(e,"getDomainLog",(function(){return m}));var a=n("be3b");const l=t=>Object(a["default"])({url:"/api/v2/cmdb/dns/domain/",method:"get",params:t}),o=(t,e)=>Object(a["default"])({url:"/api/v2/cmdb/dns/domain/",method:e,data:t}),i=()=>Object(a["default"])({url:"/api/v2/cmdb/dns/sync/",method:"post"}),r=t=>Object(a["default"])({url:"/api/v2/cmdb/dns/record/",method:"get",params:t}),s=(t,e)=>Object(a["default"])({url:"/api/v2/cmdb/dns/record/",method:e,data:t}),d=t=>Object(a["default"])({url:"/api/v2/cmdb/dns/remark/",method:"post",data:t}),m=t=>Object(a["default"])({url:"/api/v2/cmdb/dns/logs/",method:"get",params:t})},"9df9":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("Modal",{attrs:{width:"680px;",title:t.modalData.title,"footer-hide":!0},model:{value:t.modalData.show,callback:function(e){t.$set(t.modalData,"show",e)},expression:"modalData.show"}},[e("Form",{ref:"formInline",attrs:{model:t.formInline,rules:t.formRule,"label-width":100,"label-colon":!0}},[e("FormItem",{attrs:{label:"记录类型",prop:"domain_type"}},[e("Row",[e("Col",{attrs:{span:"22"}},[e("Select",{attrs:{placeholder:"记录类型"},model:{value:t.formInline.domain_type,callback:function(e){t.$set(t.formInline,"domain_type",e)},expression:"formInline.domain_type"}},t._l(t.typeList,(function(t,n){return e("Option",{key:t.value,attrs:{value:t.value,label:t.lable}})})),1)],1)],1)],1),e("FormItem",{attrs:{label:"主机记录",prop:"domain_rr"}},[e("Row",[e("Col",{attrs:{span:"16"}},[e("Input",{attrs:{type:"text",maxlength:80,placeholder:"目前不支持二级泛域名证书，请勿使用三级域名"},model:{value:t.formInline.domain_rr,callback:function(e){t.$set(t.formInline,"domain_rr",e)},expression:"formInline.domain_rr"}})],1),e("Col",{attrs:{span:"6"}},[t._v(" ."+t._s(t.selectedDomain))]),e("Col",{attrs:{span:"1",offset:"1"}},[e("Poptip",{attrs:{trigger:"hover",width:"330",placement:"left"}},[e("div",{staticStyle:{"white-space":"normal"},attrs:{slot:"content"},slot:"content"},[e("b",[t._v("主机记录就是域名前缀，常见用法有：")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("www：")]),t._v("解析后的域名为www.a.com。 ")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("@： ")]),t._v("直接解析主域名 a.com。 ")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("*： ")]),t._v("泛解析，匹配其他所有域名 *.a.com。 ")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("二级域名：")]),t._v("如：abc.a.com，填写abc。 ")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("手机网站：")]),t._v("如：m.a.com，填写m。 ")])]),e("Icon",{attrs:{type:"ios-help-circle"}})],1)],1)],1)],1),e("FormItem",{attrs:{label:"解析线路",prop:"line"}},[e("Row",["qcloud"==t.cloud_name||"dnspod"==t.cloud_name?e("Col",{attrs:{span:"22"}},[e("Select",{model:{value:t.formInline.line,callback:function(e){t.$set(t.formInline,"line",e)},expression:"formInline.line"}},t._l(t.qlineList,(function(t,n){return e("Option",{key:t,attrs:{value:t,label:n}})})),1)],1):e("Col",{attrs:{span:"22"}},[e("Select",{model:{value:t.formInline.line,callback:function(e){t.$set(t.formInline,"line",e)},expression:"formInline.line"}},t._l(t.lineList,(function(n,a){return e("Option",{key:n,attrs:{value:n}},[t._v(t._s(a))])})),1)],1),e("Col",{attrs:{span:"1",offset:"1"}},[e("Poptip",{attrs:{trigger:"hover",width:"450",placement:"left"}},[e("div",{staticStyle:{"white-space":"normal"},attrs:{slot:"content"},slot:"content"},[e("b",[t._v("如果只有一个IP地址或CNAME域名，请务必选择【默认】")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("默认：")]),t._v("必填！未匹配到智能解析线路时，返回【默认】线路设置。 ")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("境外：")]),t._v("向除中国大陆以外的其他国家和地区，返回设置的记录值。 ")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("搜索引擎：")]),t._v("向搜索引擎爬虫的DNS，返回设置的记录值 ")]),e("p",{staticStyle:{"font-size":"2px"}},[e("b",[t._v("其他线路：")]),t._v("一般用来做智能解析 ")])]),e("Icon",{attrs:{type:"ios-help-circle"}})],1)],1)],1)],1),e("FormItem",{attrs:{label:"记录值",prop:"domain_value"}},[e("Row",[e("Col",{attrs:{span:"22"}},[e("Input",{attrs:{type:"text",maxlength:255,placeholder:"记录值"},model:{value:t.formInline.domain_value,callback:function(e){t.$set(t.formInline,"domain_value",e)},expression:"formInline.domain_value"}})],1)],1)],1),e("FormItem",{attrs:{label:"权重",prop:"weight"}},[e("Row",[e("Col",{attrs:{span:"22"}},[e("Input",{attrs:{type:"text",maxlength:125,placeholder:"权重设置范围为 0 - 100 ，数值越大表示权重越高，腾讯企业版功能"},model:{value:t.formInline.weight,callback:function(e){t.$set(t.formInline,"weight",e)},expression:"formInline.weight"}})],1),e("Col",{attrs:{span:"1",offset:"1"}},[e("Poptip",{attrs:{trigger:"hover",width:"450",placement:"left"}},[e("div",{staticStyle:{"white-space":"normal"},attrs:{slot:"content"},slot:"content"},[e("b",[t._v("同一条线路下的多条记录，可按照指定权重比例返回，支持 A 与 CNAME 记录")]),e("p",{staticStyle:{"font-size":"2px"}},[t._v(" 1、权重设置范围为 0 - 100 ，数值越大表示权重越高 ")]),e("p",{staticStyle:{"font-size":"2px"}},[t._v(" 2、解析到某条记录的比例为：该条记录权重 ÷ 该线路所有记录权重之和 ")]),e("p",{staticStyle:{"font-size":"2px"}},[t._v(" 3、当某个线路下的某条记录的权重设为 0 时，表示关闭该线路下所有记录的权重 ")]),e("p",{staticStyle:{"font-size":"2px"}},[t._v(" 4、当某条线路已经包含一条或多条已设权重的记录，修改或新增一条未设权重的记录时，则该条记录的权重为该线路下其他已有记录的权重平均值 ")])]),e("Icon",{attrs:{type:"ios-help-circle"}})],1)],1)],1)],1),"MX"===t.formInline.domain_type?e("FormItem",{attrs:{label:"MX优先级",prop:"domain_mx"}},[e("Row",[e("Col",{attrs:{span:"22"}},[e("Input",{attrs:{type:"text",maxlength:2,placeholder:"MX"},model:{value:t.formInline.domain_mx,callback:function(e){t.$set(t.formInline,"domain_mx",e)},expression:"formInline.domain_mx"}})],1)],1)],1):t._e(),e("FormItem",{attrs:{label:"TTL",prop:"domain_ttl"}},[e("Row",[e("Col",{attrs:{span:"22"}},[e("Select",{attrs:{placeholder:"记录类型"},model:{value:t.formInline.domain_ttl,callback:function(e){t.$set(t.formInline,"domain_ttl",e)},expression:"formInline.domain_ttl"}},t._l(t.TTLList,(function(t,n){return e("Option",{key:t.value,attrs:{value:t.value,label:t.lable}})})),1)],1),e("Col",{attrs:{span:"1",offset:"1"}},[e("Poptip",{attrs:{trigger:"hover",width:"450",placement:"left"}},[e("div",{staticStyle:{"white-space":"normal"},attrs:{slot:"content"},slot:"content"},[e("b",[t._v("TTL 指解析记录在 DNS 服务器缓存的生存时间，数值越小则生效越快")]),e("p",{staticStyle:{"font-size":"2px"}},[t._v(" 一般默认值，如不了解请保留 600 秒即可 ")]),e("p",{staticStyle:{"font-size":"2px"}},[t._v(" 当记录值较少变动时，建议选择 3600 秒，有利于提升解析速度 ")]),e("p",{staticStyle:{"font-size":"2px"}},[t._v(" 当记录值频繁变动，可选择 60 秒，但解析速度可能略受影响 ")])]),e("Icon",{attrs:{type:"ios-help-circle"}})],1)],1)],1)],1),e("FormItem",["put"===t.modalData.action?[e("Button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:function(e){return t.handlerSubmitRecordEdit("formInline")}}},[t._v("提交")])]:[e("Button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:function(e){return t.handlerSubmitRecord("formInline")}}},[t._v("提交")])],e("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handlerReset("formInline")}}},[t._v("重置")])],2)],1)],1)],1)},l=[],o=n("15a4"),i={name:"recordEdit",props:{modalData:{type:Object,default:{}},cloud_name:{type:String,default:"aliyun"}},data(){return{selectedDomain:"",logModal:!1,btnLoading:!1,formInline:{domain_rr:"",line:"default",domain_type:"A",domain_ttl:600,domain_mx:1,domain_value:"",weight:10,the_business:null,remark:""},formRule:{domain_type:[{required:!0,message:"记录类型不能为空",trigger:"change"}],domain_rr:[{required:!0,message:"主机记录不能为空",trigger:"blur"}],line:[{required:!0,message:"线路不能为空",trigger:"change"}],domain_mx:[{required:!0,message:"不能为空",trigger:"blur"}],domain_value:[{required:!0,message:"记录值不能为空",trigger:"blur"}]},typeList:[{lable:"A- 将域名指向一个IPv4地址（如：8.8.8.8）",value:"A"},{lable:"CNAME- 将域名指向另外一个域名",value:"CNAME"},{lable:"AAAA- 将域名指向一个IPv6地址",value:"AAAA"},{lable:"NS- 将子域名指向其他DNS服务器解析",value:"NS"},{lable:"MX- 将域名指向邮件服务器地址",value:"MX"},{lable:"TXT- 通常做SPF记录（反垃圾邮件）",value:"TXT"},{lable:"SRV- 记录特定的服务的服务器",value:"SRV"},{lable:"CAA- CA证书机构颁发授权校验",value:"CAA"},{lable:"显性URL- 将域名重定向到另外一个地址",value:"REDIRECT_URL"},{lable:"隐性URL- 与显性URL相似，但会隐藏真实目标地址",value:"FORWARD_URL"}],TTLList:[{lable:"10分钟（600）",value:600},{lable:"30分钟（1800）",value:1800},{lable:"1秒（1），企业版支持",value:1},{lable:"10秒（10），企业版支持",value:10},{lable:"1分钟（60），企业版支持",value:60},{lable:"2分钟（120），企业版支持",value:120},{lable:"1小时（3600）",value:3600},{lable:"12小时（43200）",value:43200},{lable:"1天（86400）",value:86400}],lineList:{"默认":"default","境外":"oversea"},qlineList:{"默认":"默认","境外":"境外","中国香港":"中国香港","中国澳门":"中国澳门","中国台湾":"中国台湾"},btnDisabled:!0}},methods:{handleCancel(){this.$emit("drawer-close")},SubmitRecord(){setTimeout(()=>{Object(o["optDomainRecords"])(this.formInline,"post").then(t=>{0==t.code?(this.$Message.success(t.msg),this.handleCancel()):this.$Notice.error({title:"添加出错",desc:t.msg,duration:5}),this.btnLoading=!1}).catch(t=>{this.btnLoading=!1,this.$Message.error("请求数据出错")})},2e3)},handlerSubmitRecord(t){this.btnLoading=!0,this.$refs[t].validate(t=>{t?(this.formInline["domain_name"]=this.selectedDomain,-1!==this.formInline.domain_rr.indexOf(".")?this.$Modal.confirm({title:"提醒",content:"<p>请注意你使用了三级以上的域名，证书可能不支持</p>",onOk:()=>{this.SubmitRecord()},onCancel:()=>{this.btnLoading=!1,this.$Message.info("回头是岸~")}}):this.SubmitRecord()):(this.btnLoading=!1,this.$Message.error("表单校验不通过!"))})},recordEdit(){setTimeout(()=>{this.formInline["domain_name"]=this.selectedDomain,Object(o["optDomainRecords"])(this.formInline,"put").then(t=>{0==t.code?(this.$Message.success(t.msg),this.handleCancel()):this.$Notice.error({title:"修改出错",desc:t.msg,duration:5}),this.btnLoading=!1})},2e3)},handlerSubmitRecordEdit(t){this.btnLoading=!0,this.$refs[t].validate(t=>{t?(this.formInline["domain_name"]=this.selectedDomain,-1!==this.formInline.domain_rr.indexOf(".")?this.$Modal.confirm({title:"提醒",content:"<p>请注意你使用了三级以上的域名，证书可能不支持</p>",onOk:()=>{this.recordEdit()},onCancel:()=>{this.btnLoading=!1,this.$Message.info("回头是岸~")}}):this.recordEdit()):(this.btnLoading=!1,this.$Message.error("表单校验不通过!"))})},handlerReset(){this.btnLoading=!1,this.formInline=this.$options.data().formInline}},watch:{cloud_name(t){"qcloud"!=t&&"dnspod"!=t||"default"==this.formInline.line&&this.formInline.line}},computed:{},mounted(){}},r=i,s=n("2877"),d=Object(s["a"])(r,a,l,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-a0c71f3c.37c31d0c.js.map