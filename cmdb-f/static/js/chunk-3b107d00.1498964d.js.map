{"version":3,"sources":["webpack://cmdb-[name]/./src/api/service-tree.js","webpack://cmdb-[name]/./src/api/cloud/redis.js","webpack://cmdb-[name]/./src/api/cloud/mysql.js","webpack://cmdb-[name]/./src/api/cloud/server.js","webpack://cmdb-[name]/./src/api/cloud/lb.js","webpack://cmdb-[name]/./src/views/cmdb/service-tree/asset-add.vue","webpack://cmdb-[name]/src/views/cmdb/service-tree/asset-add.vue","webpack://cmdb-[name]/./src/views/cmdb/service-tree/asset-add.vue?6131","webpack://cmdb-[name]/./src/views/cmdb/service-tree/asset-add.vue?7d04"],"names":["postTreeAsset","data","request","url","method","getTreeAsset","params","changeTreeAssetStatus","deleteTreeAsset","getRelation","getServiceTreelist","operationTree","getBizEnv","getRedisList","optrationRedis","getMySQLList","optrationMysQL","getServerList","optServer","optBatchServer","getUserField","optrationUserField","deleteLB","getLBList","render","_vm","this","_c","_self","attrs","dialog","title","model","value","modalMap","show","callback","$$v","$set","expression","ref","formValidate","_v","_s","theBusinessName","env_name","region_name","module_name","asset_ids","_l","assetList","item","key","id","name","inner_ip","is_enable","slot","on","onJsonChange","onJsonSave","onError","ext_info","staticStyle","isLoading","$event","handleSubmit","staticRenderFns","components","vueJsonEditor","props","default","type","Object","form","jsonErrFlag","computed","methods","asset_type","res","page_number","page_size","$Message","success","msg","$emit","handleRefresh","console","log","localStorage","getItem","getAssetData","val","component"],"mappings":"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","file":"static/js/chunk-3b107d00.1498964d.js","sourcesContent":["import request from '@/plugins/axios'\n\n//  服务树\nexport const postTreeAsset = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'post',\n  data,\n})\n// 获取树资产\nexport const getTreeAsset = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'get',\n  params,\n})\n\n// 更改资产状态\nexport const changeTreeAssetStatus = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'patch',\n  data,\n})\n\nexport const deleteTreeAsset = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'delete',\n  data,\n})\n\n// 主机关系\nexport const getRelation = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/asset/relation/',\n  method: 'get',\n  params,\n})\n\n// 业务Tree\nexport const getServiceTreelist = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/',\n  method: 'get',\n  params,\n})\n\nexport const operationTree = (/** @type {any} */ data, /** @type {any} */ method) => request({\n  url: '/api/v2/cmdb/tree/',\n  method,\n  data,\n})\n\n\nexport const getBizEnv = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/env/',\n  method: 'get',\n  params,\n})","/* eslint-disable camelcase */\nimport request from '@/plugins/axios'\n\n// redis\nexport const getRedisList = (params) => request({\n  url: '/api/v2/cmdb/redis/',\n  method: 'get',\n  params,\n})\n\nexport const optrationRedis = (data, method) => request({\n  url: '/api/v2/cmdb/redis/',\n  method,\n  data,\n})","/* eslint-disable camelcase */\nimport request from '@/plugins/axios'\n\n// 数据库\nexport const getMySQLList = (params) => request({\n  url: '/api/v2/cmdb/mysql/',\n  method: 'get',\n  params,\n})\n\nexport const optrationMysQL = (data, method) => request({\n  url: '/api/v2/cmdb/mysql/',\n  method,\n  data,\n})","/* eslint-disable camelcase */\nimport request from '@/plugins/axios'\n\n// 主机\nexport const getServerList = (params) => request({\n  url: '/api/v2/cmdb/server/',\n  method: 'get',\n  params,\n})\n\nexport const optServer = (data, method) => request({\n  url: '/api/v2/cmdb/server/',\n  method,\n  data,\n})\n\nexport const optBatchServer = (data, method) => request({\n  url: '/api/v2/cmdb/server/batch/',\n  method,\n  data,\n})\n\n// 用戶收藏字段\nexport const getUserField = (params) => request({\n  url: '/api/v2/cmdb/user_field/',\n  method: 'get',\n  params,\n})\n\nexport const optrationUserField = (data) => request({\n  url: '/api/v2/cmdb/user_field/',\n  method: 'put',\n  data,\n})\n","/* eslint-disable camelcase */\nimport request from '@/plugins/axios'\n\n// lb\nexport const deleteLB = (data) => request({\n  url: '/api/v2/cmdb/lb/',\n  method: 'delete',\n  data,\n})\n\nexport const getLBList = (params) => request({\n  url: '/api/v2/cmdb/lb/',\n  method: 'get',\n  params,\n})","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('Modal',{attrs:{\"title\":_vm.dialog.title,\"footer-hide\":true,\"width\":\"850\",\"mask-closable\":false},model:{value:(_vm.modalMap.show),callback:function ($$v) {_vm.$set(_vm.modalMap, \"show\", $$v)},expression:\"modalMap.show\"}},[_c('Form',{ref:\"formValidate\",attrs:{\"model\":_vm.formValidate,\"label-width\":95}},[_c('FormItem',{attrs:{\"label\":\"当前节点\"}},[_c('span',[_vm._v(\"/\"+_vm._s(_vm.theBusinessName)+\"/\"+_vm._s(_vm.formValidate.env_name)+\"//\"+_vm._s(_vm.formValidate.region_name)+\"/\"+_vm._s(_vm.formValidate.module_name))])]),_c('FormItem',{attrs:{\"label\":\"添加方式\"}},[_c('span',[_vm._v(\"基础资源\")])]),_c('FormItem',{attrs:{\"label\":\"选择主机\"}},[_c('Select',{attrs:{\"filterable\":\"\",\"multiple\":\"\"},model:{value:(_vm.formValidate.asset_ids),callback:function ($$v) {_vm.$set(_vm.formValidate, \"asset_ids\", $$v)},expression:\"formValidate.asset_ids\"}},_vm._l((_vm.assetList),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id}},[_vm._v(_vm._s(item.name)+\" - \"+_vm._s(item.inner_ip))])}),1)],1),_c('FormItem',{attrs:{\"label\":\"是否启用\"}},[_c('i-switch',{attrs:{\"size\":\"large\"},model:{value:(_vm.formValidate.is_enable),callback:function ($$v) {_vm.$set(_vm.formValidate, \"is_enable\", $$v)},expression:\"formValidate.is_enable\"}},[_c('span',{attrs:{\"slot\":\"open\"},slot:\"open\"},[_vm._v(\"开启\")]),_c('span',{attrs:{\"slot\":\"close\"},slot:\"close\"},[_vm._v(\"关闭\")])])],1),_c('FormItem',{attrs:{\"label\":\"扩展字段\"}},[_c('vue-json-editor',{attrs:{\"show-btns\":false,\"mode\":'code',\"lang\":\"zh\"},on:{\"json-change\":_vm.onJsonChange,\"json-save\":_vm.onJsonSave,\"has-error\":_vm.onError},model:{value:(_vm.formValidate.ext_info),callback:function ($$v) {_vm.$set(_vm.formValidate, \"ext_info\", $$v)},expression:\"formValidate.ext_info\"}})],1),_c('FormItem',{staticStyle:{\"text-align\":\"right\"}},[_c('Button',{attrs:{\"type\":\"primary\",\"loading\":_vm.isLoading},on:{\"click\":function($event){return _vm.handleSubmit('formValidate')}}},[_vm._v(\"Submit\")])],1)],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <Modal v-model=\"modalMap.show\" :title=\"dialog.title\" :footer-hide=\"true\" width=\"850\" :mask-closable=\"false\">\n      <Form ref=\"formValidate\" :model=\"formValidate\" :label-width=\"95\">\n        <FormItem label=\"当前节点\">\n          <span>/{{ theBusinessName }}/{{ formValidate.env_name }}//{{ formValidate.region_name }}/{{ formValidate.module_name }}</span>\n        </FormItem>\n        <FormItem label=\"添加方式\">\n          <span>基础资源</span>\n        </FormItem>\n        <FormItem label=\"选择主机\">\n          <Select v-model=\"formValidate.asset_ids\" filterable multiple>\n            <Option v-for=\"item in assetList\" :key=\"item.id\" :value=\"item.id\">{{ item.name }} - {{ item.inner_ip }}</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"是否启用\">\n          <i-switch v-model=\"formValidate.is_enable\" size=\"large\">\n            <span slot=\"open\">开启</span>\n            <span slot=\"close\">关闭</span>\n          </i-switch>\n        </FormItem>\n        <FormItem label=\"扩展字段\">\n          <vue-json-editor v-model=\"formValidate.ext_info\" :show-btns=\"false\" :mode=\"'code'\" lang=\"zh\" @json-change=\"onJsonChange\" @json-save=\"onJsonSave\" @has-error=\"onError\" />\n        </FormItem>\n        <FormItem style=\"text-align: right\">\n          <Button type=\"primary\" :loading=\"isLoading\" @click=\"handleSubmit('formValidate')\">Submit</Button>\n        </FormItem>\n      </Form>\n    </Modal>\n  </div>\n</template>\n\n<script>\nimport { getServerList} from '@/api/cloud/server'\nimport { getRedisList } from '@/api/cloud/redis'\nimport { getMySQLList } from '@/api/cloud/mysql'\nimport { getLBList} from '@/api/cloud/lb'\nimport { postTreeAsset } from '@/api/service-tree'\n\nimport vueJsonEditor from 'vue-json-editor'\n\nexport default {\n\n  name: 'AssetAdd',\n  components: {\n    vueJsonEditor,\n  },\n  props: {\n    dialog: {\n      default() {\n        return {}\n      },\n      type: Object,\n    },\n    form: {\n      default() {\n        return {}\n      },\n      type: Object,\n    },\n  },\n  data() {\n    return {\n      jsonErrFlag: false,\n      theBusinessName: '',\n      assetList: [],\n      isLoading: false,\n    }\n  },\n  computed: {\n    formValidate() {\n      return this.form\n    },\n    modalMap() {\n      return this.dialog\n    },\n  },\n  methods: {\n    // 获取基础主机\n    async getAssetData () {\n      if (this.formValidate.asset_type === 'server') {\n        const res = await getServerList({ page_number: 1, page_size: 999999 })\n        this.assetList = res.data\n      } else if (this.formValidate.asset_type === 'mysql') {\n        const res = await getMySQLList({ page_number: 1, page_size: 999999 })\n        this.assetList = res.data\n      } else if (this.formValidate.asset_type === 'redis') {\n        const res = await getRedisList({ page_number: 1, page_size: 999999 })\n        this.assetList = res.data\n      } else if (this.formValidate.asset_type === 'lb') {\n        const res = await getLBList({ page_number: 1, page_size: 999999 })\n        this.assetList = res.data\n      }\n    },\n    // 提交\n    async handleSubmit() {\n      try {\n        this.isLoading = true\n        const res = await postTreeAsset(this.formValidate)\n        this.$Message.success(res.msg)\n      } finally {\n        this.isLoading = false\n        this.$emit('e-close')\n        this.$emit('e-update')\n      }\n    },\n    // 刷新数据\n    handleRefresh() {\n      console.log('调了hanleRefresh')\n      // 切换业务会把BusinessID和Name写到浏览器LocalStorage\n      this.theBusinessName = localStorage.getItem('selectBusinessName')\n      this.getAssetData()\n    },\n    // 获取最新数据\n    onJsonChange(val) {\n      console.log('更改了-->', val)\n      this.jsonErrFlag = false\n    },\n    onJsonSave(val) {\n      console.log('保存了--->', val)\n    },\n    onError(val) {\n      console.log('报错了--->', val)\n      this.jsonErrFlag = true\n    },\n  },\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./asset-add.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./asset-add.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./asset-add.vue?vue&type=template&id=0d864256&\"\nimport script from \"./asset-add.vue?vue&type=script&lang=js&\"\nexport * from \"./asset-add.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}