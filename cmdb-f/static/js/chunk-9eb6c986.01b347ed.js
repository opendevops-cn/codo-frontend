(window["webpackJsonp_cmdb"]=window["webpackJsonp_cmdb"]||[]).push([["chunk-9eb6c986","chunk-2d216075"],{"58fb":function(a,t,e){},"6cb4":function(a,t,e){"use strict";e.r(t);var o=function(){var a=this,t=a._self._c;return t("Modal",{attrs:{width:"700px;",title:a.modalEditData.title,"footer-hide":!0},model:{value:a.modalEditData.show,callback:function(t){a.$set(a.modalEditData,"show",t)},expression:"modalEditData.show"}},[t("Form",{ref:"formValidate",attrs:{model:a.formValidate,rules:a.ruleValidate,"label-width":100,"label-colon":!0}},[t("FormItem",{attrs:{label:"域名名称",prop:"domain_name"}},["put"==a.modalEditData.action?[t("p",[a._v(" "+a._s(a.formValidate.domain_name))])]:[t("Input",{attrs:{maxlength:"80",type:"text",placeholder:"请输入域名名称..."},model:{value:a.formValidate.domain_name,callback:function(t){a.$set(a.formValidate,"domain_name",t)},expression:"formValidate.domain_name"}})]],2),t("FormItem",{attrs:{label:"备注信息",prop:"remark"}},[t("Input",{attrs:{maxlength:"250",type:"textarea",autosize:{minRows:3,maxRows:5},placeholder:"备注信息..."},model:{value:a.formValidate.remark,callback:function(t){a.$set(a.formValidate,"remark",t)},expression:"formValidate.remark"}})],1),t("FormItem",{attrs:{label:"过期时间",prop:"record_end_time"}},[t("DatePicker",{staticStyle:{width:"280px"},attrs:{type:"date",options:a.optionsDate,placeholder:"备注域名到期时间"},model:{value:a.formValidate.record_end_time,callback:function(t){a.$set(a.formValidate,"record_end_time",t)},expression:"formValidate.record_end_time"}})],1),t("FormItem",[t("Button",{attrs:{type:"primary",loading:a.btnLoading},on:{click:function(t){return a.handleSubmit("formValidate")}}},[a._v("提交")]),t("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return a.handlerReset("formValidate")}}},[a._v("重置")])],1)],1)],1)},i=[],n=e("15a4"),s={name:"domainEdit",props:{modalEditData:{type:Object,default:{}},domainData:{type:Object,default:{}}},data(){return{optionsDate:{shortcuts:[{text:"今天",value(){return new Date}}]},btnLoading:!1,formValidate:{id:"",domain_name:"",remark:"",record_end_time:""},ruleValidate:{domain_name:[{required:!0,message:"The domain name cannot be empty",trigger:"blur"}],is_used:[{required:!0,message:"Cannot be empty",trigger:"change"}],remark:[{required:!0,message:"备注信息不能为空",trigger:"blur"}]}}},methods:{handleCancel(){this.$emit("modal-close")},handleSubmit(a){this.$refs[a].validate(a=>{a?(this.btnLoading=!0,setTimeout(()=>{let a;a="put"===this.modalEditData.action?{id:this.formValidate.id,remark:this.formValidate.remark,record_end_time:this.formValidate.record_end_time}:{domain_name:this.formValidate.domain_name,remark:this.formValidate.remark,record_end_time:this.formValidate.record_end_time,state:"手动"},Object(n["optDomain"])(a,this.modalEditData.action).then(a=>{0==a.code?(this.modalEditData.show=!1,this.btnLoading=!1,this.handleCancel()):this.$Message.error({content:JSON.stringify(a.data.msg),duration:3})}).catch(a=>{this.$Message.error({content:JSON.stringify(a.response.data),duration:10})}),this.btnLoading=!1},1e3)):this.$Message.error("表单校验不通过!")})},handlerReset(a){this.$refs[a].resetFields()}},watch:{domainData(a){this.formValidate=a}},mounted(){}},r=s,d=e("2877"),l=Object(d["a"])(r,o,i,!1,null,null,null);t["default"]=l.exports},8076:function(a,t,e){"use strict";e.r(t);var o=function(){var a=this,t=a._self._c;return t("Card",[a.selectedDomain?[t("domain-records",{ref:"domainRecords",attrs:{selectedDomain:a.selectedDomain,cloud_name:a.cloud_name,needPriority:a.needPriority},on:{"domain-show":a.handlerShowDomains}})]:t("div",[t("Alert",{attrs:{type:"success"}},[t("h3",[a._v("【提醒通知】：")])]),t("div",{staticClass:"search-con search-con-top"},[t("Input",{staticClass:"search-input",attrs:{search:"",maxlength:80,placeholder:"输入关键字搜索"},on:{"on-search":a.handleSearch},model:{value:a.initPara.searchVal,callback:function(t){a.$set(a.initPara,"searchVal",t)},expression:"initPara.searchVal"}}),t("ButtonGroup",{staticClass:"search-btn"},[0==a.selectList.length?[t("Button",{attrs:{disabled:""}},[a._v("暂停")]),t("Button",{attrs:{disabled:""}},[a._v("启用")]),t("Button",{attrs:{disabled:""}},[a._v("删除")])]:[t("Button",{on:{click:a.handlerDomainPause}},[a._v("暂停")]),t("Button",{on:{click:a.handlerDomainEnable}},[a._v("启用")]),t("Button",{on:{click:a.handlerDomainDel}},[a._v("删除")])],t("Button",{staticClass:"search-btn",attrs:{type:"success"},on:{click:a.handlerDomainAdd}},[a._v("添加域名")]),t("Button",{on:{click:a.handlerDomainSync}},[a._v("同步")]),t("Button",{on:{click:a.handlerDomainDoc}},[a._v("说明文档")])],2),t("Table",{ref:"selection",attrs:{columns:a.columnsDomain,data:a.tableData},on:{"on-sort-change":a.handleSort,"on-selection-change":a.handleSelectChange}})],1),[t("domain-detail",{attrs:{modalData:a.modalData,domainData:a.domainData}})],[t("domain-edit",{attrs:{modalEditData:a.modalEditData,domainData:a.domainData},on:{"modal-close":a.handlerModalClose}})]],2)],2)},i=[],n=(e("14d9"),e("15a4")),s=e("c15f"),r=e("6cb4"),d=e("b6bb"),l={components:{domainDetail:s["default"],domainEdit:r["default"],domainRecords:d["default"]},data(){return{modalEditData:{show:!1,title:"域名设置",action:"put"},modalData:{show:!1,title:"域名详情"},domainData:{},cloud_name:"",selectedDomain:"",selectList:[],needPriority:"false",initPara:{page_number:1,page_size:300,searchVal:null,order_by:"",order:"ascend"},showAll:!1,tableData:[],columnsDomain:[{type:"selection",key:"",width:65,align:"center"},{title:"域名",key:"domain_name",sortable:!0,render:(a,t)=>{const e=t.row.star_mark,o=e?{cursor:"pointer",color:"#f50"}:{cursor:"pointer"};return a("div",[a("Icon",{style:o,props:{type:e?"ios-star":"ios-star-outline"},nativeOn:{click:()=>{this.handlerStarMark(t.row,t.index)}}}),a("a",{on:{click:()=>{this.handlerCheckDomain(t.row)}}},"  "+t.row.domain_name)])}},{title:"记录数",key:"record_count",align:"center",sortable:!0,width:120},{title:"DNS状态",key:"state",width:100,align:"center",render:(a,t)=>{let e=t.row.domain_state;return a("div","正常"==e?[a("Tag",{props:{color:"green"}},e)]:"手动"==e?[a("Tag",{props:{color:"blue"}},e)]:[a("Tag",{props:{color:"error"}},e)])}},{title:"厂商",key:"cloud_name",width:100},{title:"版本",key:"version",sortable:!0,tooltip:!0,width:130},{title:"",key:"",width:110,render:(a,t)=>a("div",[a("a",{style:{marginRight:"5px"},on:{click:()=>{this.handlerDomainDetail(t.row)}}},"详情"),a("a",{on:{click:()=>{this.handlerDomainEdit(t.row)}}},"设置")])}]}},methods:{async handleGetData(){const a=await Object(n["getDomain"])(this.initPara);0==a.code?this.tableData=a.data:this.$Message.error(a.msg)},handlerDomainPause(){this.$Message.error("这么危险的功能还是不开放了")},handlerDomainEnable(){this.$Message.error("这么危险的功能还是不开放了")},handlerDomainDoc(){this.$Message.info("要啥子自行车")},handlerShowDomains(){this.selectedDomain=null},handlerDomainDel(){this.$Modal.confirm({title:"提醒",content:"<p>是否要删除选择的域名，本删除仅为平台删除记录。</p>",onOk:()=>{Object(n["optDomain"])({id_list:this.selectList},"delete").then(a=>{0==a.code?(this.handleGetData(),this.selectList=[]):this.$Message.error(a.msg)})},onCancel:()=>{this.$Message.info("回头是岸")}})},handleSelectChange(a){let t=[];a.forEach(a=>{t.push(a.id.toString())}),this.selectList=t},handlerCheckDomain(a){this.selectedDomain=a.domain_name,this.cloud_name=a.cloud_name,this.needPriority="Alibaba Cloud DNS"==a.version?"true":"false"},handlerStarMark(a,t){let e=!this.tableData[t].star_mark;Object(n["optDomain"])({star_mark:e,id:a.id},"patch").then(a=>{0==a.code?this.handleGetData():this.$Message.error(a.msg)})},handlerDomainDetail(a){this.domainData=a,this.modalData.show=!0},handlerDomainEdit(a){this.domainData=a,this.modalEditData.show=!0,this.modalEditData.action="put"},handlerDomainAdd(){this.domainData.is_used=!0,this.modalEditData={show:!0,title:"当厂商没有API的时候用来记录，本身不提供解析功能",action:"post"}},handlerDomainSync(){this.$Modal.confirm({title:"提醒",content:"<p>手动触发获取厂商相关信息更新到域名管理系统，</p>                  <p>点击确认进行拉取，请耐心稍等一下，不要重复点击，详细信息可查看同步日志</p>",onOk:()=>{this.$Spin.show(),setTimeout(()=>{Object(n["syncDomain"])().then(a=>{0==a.code?(this.handleGetData(),this.$Message.success(a.msg)):this.$Message.error(a.msg),this.$Spin.hide()}).catch(a=>{this.$Spin.hide(),this.$Message.error({content:"同步结束",duration:10})})},3e3)},onCancel:()=>{this.$Message.info("回头是岸")}})},handlerChangeShow(){this.showAll=!this.showAll},handlerModalClose(){this.handleGetData()},handleSort(a,t,e){this.initPara.order="asc"===a.order?"ascend":"descend",this.initPara.order_by=a.key,this.handleGetData()},handleSearch(){this.handleGetData()}},watch:{},mounted(){this.handleGetData()}},m=l,c=(e("bd0b"),e("2877")),h=Object(c["a"])(m,o,i,!1,null,"648a9d76",null);t["default"]=h.exports},bd0b:function(a,t,e){"use strict";e("58fb")},c15f:function(a,t,e){"use strict";e.r(t);var o=function(){var a=this,t=a._self._c;return t("Modal",{attrs:{width:"700px;",title:a.modalData.title,"footer-hide":!0},model:{value:a.modalData.show,callback:function(t){a.$set(a.modalData,"show",t)},expression:"modalData.show"}},[t("Card",{attrs:{"dis-hover":""}},[t("div",{staticClass:"inner"},[t("Alert",{attrs:{"show-icon":""}},[a._v("基本信息")]),t("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[t("Row",[t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("域名ID：")])])]),a.domainData.domain_id?t("Col",{attrs:{span:"20"}},[t("p",[a._v(" "+a._s(a.domainData.domain_id))])]):a._e()],1),t("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("域名：")])])]),t("Col",{attrs:{span:"8"}},[t("p",[a._v(" "+a._s(a.domainData.domain_name)+" ")])]),t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("解析数量：")])])]),t("Col",{attrs:{span:"8"}},[t("p",[a._v(" "+a._s(a.domainData.record_count)+" ")])])],1),t("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("状态：")])])]),t("Col",{attrs:{span:"8"}},[t("p",[a._v(" "+a._s(a.domainData.domain_state)+" ")])]),t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("星标：")])])]),t("Col",{attrs:{span:"8"}},[t("p",[a._v(" "+a._s(a.domainData.star_mark)+" ")])])],1),t("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("厂商：")])])]),a.domainData.cloud_name?t("Col",{attrs:{span:"8"}},[t("p",[a._v(" "+a._s(a.domainData.cloud_name)+" ")])]):a._e(),t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("账户别名：")])])]),a.domainData.account?t("Col",{attrs:{span:"8"}},[t("p",[a._v(" "+a._s(a.domainData.account)+" ")])]):a._e()],1),t("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("过期时间（注）")])])]),a.domainData.record_end_time?t("Col",{attrs:{span:"20"}},[t("p",[a._v(" "+a._s(a.domainData.record_end_time)+" ")])]):a._e()],1),t("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("备注：")])])]),t("Col",{attrs:{span:"20"}},[t("p",[a._v(" "+a._s(a.domainData.remark)+" ")])])],1),t("Row",[t("Col",{attrs:{span:"4"}},[t("p",[t("b",[a._v("最后更新时间：")])])]),t("Col",{attrs:{span:"20"}},[t("p",[a._v(" "+a._s(a.domainData.update_time)+" ")])])],1)],1)],1)])],1)},i=[],n={name:"domainDetail",props:{modalData:{type:Object,default:{}},domainData:{type:Object,default:{}}}},s=n,r=e("2877"),d=Object(r["a"])(s,o,i,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-9eb6c986.01b347ed.js.map