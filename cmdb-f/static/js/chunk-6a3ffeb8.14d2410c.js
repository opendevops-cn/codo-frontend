(window["webpackJsonp_cmdb"]=window["webpackJsonp_cmdb"]||[]).push([["chunk-6a3ffeb8","chunk-ed78b5d4","chunk-2d2250dc","chunk-2d0c8c03"],{4861:function(t,e,a){"use strict";a("e011")},"55e2":function(t,e,a){"use strict";a.r(e),a.d(e,"getSecurityGroup",(function(){return r})),a.d(e,"optSecurityGroup",(function(){return i})),a.d(e,"getSecurityGroupRefs",(function(){return n}));var s=a("be3b");const r=t=>Object(s["default"])({url:"/api/v2/cmdb/security_group/",method:"get",params:t}),i=(t,e)=>Object(s["default"])({url:"/api/v2/cmdb/security_group/",method:e,data:t}),n=t=>Object(s["default"])({url:"/api/v2/cmdb/security_group/refs/",method:"get",params:t})},"7bd2":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("Drawer",{attrs:{title:t.drawerData.title,"mask-closable":!1,transfer:!1,inner:!0,width:"75%"},model:{value:t.drawerData.show,callback:function(e){t.$set(t.drawerData,"show",e)},expression:"drawerData.show"}},[e("Tabs",{attrs:{value:"attribute"},on:{"on-click":t.handleClick}},[e("TabPane",{attrs:{label:"安全组规则",name:"attribute"}},[e("Table",{attrs:{size:"small",columns:t.tableColumns,data:t.security_info}})],1),e("TabPane",{attrs:{label:"安全组内主机",name:"server"}},[e("Table",{attrs:{size:"small",columns:t.tableColumnsServer,data:t.tableDataServer}})],1),t.ref_info.length>0?e("TabPane",{attrs:{label:"安全组间关联",name:"references"}},[t._v(" "+t._s(t.ref_info)+" 关联了本安全组 ")]):t._e()],1),t.serverData?e("div",[e("serverDetail",{attrs:{modalData:t.modalData,serverData:t.serverData}})],1):t._e()],1)],1)},r=[],i=a("55e2"),n=a("e380"),o={name:"SecurityGroupDetail",components:{serverDetail:n["default"]},props:{drawerData:{type:Object,default:{}},security_info:{type:Array|Object,default:[]},ref_info:{type:Array|Object,default:[]},securityGroupId:{type:String,default:null}},data(){return{tableColumns:[{title:"安全组ID",key:"security_group_id",ellipsis:!0,tooltip:!0,minWidth:100},{title:"授权策略",key:"policy",minWidth:100,render:(t,e)=>{let a=e.row.policy;return t("span",{},"Accept"==a||"ACCEPT"==a?"允许":a)}},{title:"优先级",key:"priority",minWidth:80},{title:"协议类型",key:"ip_protocol",minWidth:100},{title:"端口范围",key:"port_range",minWidth:100},{title:"授权对象",key:"source_cidr_ip",minWidth:180,render:(t,e)=>{console.info(e.row);let a=e.row.direction;return t("span",{},"ingress"==a?`源：${e.row.source_cidr_ip} ${e.row.source_group_name}`:"egress"==a?`目标：${e.row.dest_cidr_ip} ${e.row.dest_group_name}`:`源：${e.row.source_cidr_ip}  目标：${e.row.dest_cidr_ip} `)}},{title:"授权方向",key:"direction",minWidth:100,render:(t,e)=>{let a=e.row.direction;return t("span",{},"ingress"==a?"入方向":"egress"==a?"出方向":"all"==a?"全部":e.row.direction)}},{title:"描述",key:"description",tooltip:!0,minWidth:100}],tableDataServer:[],tableColumnsServer:[{title:"实例ID",key:"instance_id",minWidth:150,render:(t,e)=>t("a",{on:{click:()=>{this.handlerDetail(e.row)}}},e.row.instance_id)},{title:"主机名",key:"name",minWidth:100},{title:"内网IP",key:"inner_ip",minWidth:130},{title:"地域",key:"region",minWidth:100}],serverData:{},modalData:{show:!1,title:"主机详情"},referencesGroup:null}},methods:{handleGetSecurityGroupServer(){Object(i["getSecurityGroupRefs"])({sg_id:this.securityGroupId,asset_type:"server"}).then(t=>{0==t.code?this.tableDataServer=t.data:(this.tableDataServer=[],this.$Message.info("当前安全组下没有找到实例"))})},handleClick(t){},handlerDetail(t){this.serverData=t,this.modalData.show=!0}},watch:{securityGroupId(t){this.handleGetSecurityGroupServer()}},mounted(){}},l=o,p=a("2877"),c=Object(p["a"])(l,s,r,!1,null,null,null);e["default"]=c.exports},"9c6b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"search-con search-con-top"},[e("Input",{staticClass:"search-input",attrs:{search:"",maxlength:50,placeholder:"输入关键字搜索"},on:{"on-search":t.handleSearch},model:{value:t.initPara.searchVal,callback:function(e){t.$set(t.initPara,"searchVal",e)},expression:"initPara.searchVal"}}),t.instance_id?e("h4",{staticClass:"search-col"},[t._v("实例："+t._s(t.instance_id))]):t._e(),t.instance_id?t._e():e("Button",{staticClass:"search-add-btn",attrs:{type:"error",disabled:0===t.selectList.length},on:{click:t.handleDel}},[t._v("批量删除")]),t.instance_id?t._e():e("Button",{staticClass:"search-add-btn",attrs:{disabled:0===t.selectList.length},on:{click:t.exportData}},[e("Icon",{attrs:{type:"ios-download-outline"}}),t._v("导出数据 ")],1)],1),e("Table",{ref:"selection",attrs:{size:"small",columns:t.tableColumns,data:t.tableData,loading:t.i.tableLoading},on:{"on-sort-change":t.handleSort,"on-selection-change":t.handleSelect}}),e("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[e("div",{staticStyle:{float:"left"}},[e("Page",{attrs:{total:t.i.pageTotal,current:t.initPara.page_number,"page-size":t.initPara.page_size,"show-total":"","show-sizer":"","page-size-opts":[15,50,100,1e3]},on:{"on-change":t.handlerChangePage,"on-page-size-change":t.handlePageSize}})],1)]),e("SecurityGroupDetail",{ref:"sgDetail",attrs:{drawerData:t.drawerData,security_info:t.securityInfoList,ref_info:t.refList,securityGroupId:t.selectSecurityGroupId}})],1)},r=[],i=(a("14d9"),a("55e2")),n=a("7bd2"),o={name:"SecurityGroup",components:{SecurityGroupDetail:n["default"]},props:{instance_id:{type:String,default:null},sg_ids:{type:Object|Array,default:null}},data(){return{tableColumns:[{type:"selection",key:"selection",width:60,align:"center"},{title:"安全组名",key:"security_group_name",tooltip:!0,sortable:!0,minWidth:150},{title:"安全组ID",key:"instance_id",ellipsis:!0,tooltip:!0,minWidth:200,render:(t,e)=>t("a",{on:{click:()=>{this.handlerDetail(e.row)}}},e.row.instance_id)},{title:"类型",key:"security_group_type",minWidth:100},{title:"厂商",key:"cloud_name",minWidth:90},{title:"地域",key:"region",minWidth:90},{title:"备注",key:"description",ellipsis:!0,tooltip:!0,minWidth:200},{title:"更新时间",key:"update_time",sortable:!0,width:170}],tableData:[],i:{pageTotal:0,tableLoading:!0},initPara:{page_number:1,page_size:15,searchVal:null,sg_ids:[],order_by:"",order:"ascend"},selectList:[],drawerData:{show:!1,title:"安全组信息"},securityInfoList:[],refList:[],selectSecurityGroupId:null}},methods:{async handleGetData(){const t=await Object(i["getSecurityGroup"])(this.initPara);0==t.code?(this.tableData=t.data,this.i.pageTotal=t.count):this.$Message.error(t.msg),this.i.tableLoading=!1},handleDel(){this.$Modal.confirm({title:"二次确认",content:"确定删除已选中的数据？",onOk:()=>{Object(i["optSecurityGroup"])({id_list:this.selectList},"delete").then(t=>{0===t.code?(this.$Message.success(t.msg),this.handleGetData()):this.$Notice.error({title:""+t.msg})})},onCancel:()=>{this.$Message.info("回头是岸~")}})},handlerDetail(t){this.securityInfoList=t.security_info.items,this.refList=t.ref_info.items,this.selectSecurityGroupId=t.instance_id,this.drawerData.show=!0},exportData(){this.$refs.selection.exportCsv({filename:"codo_cmdb_original_sg_data"})},handleSelect(t){let e=[];t.forEach(t=>{e.push(t.id)}),this.selectList=e},handleSearch(){this.initPara.page_number=1,this.handleGetData()},handleSort(t,e,a){this.initPara.order="asc"===t.order?"ascend":"descend",this.initPara.order_by=t.key,this.handleGetData()},handlerChangePage(t){this.initPara.page_number=t,this.handleGetData()},handlePageSize(t){this.initPara.page_number=1,this.initPara.page_size=t,this.handleGetData()}},watch:{searchValue(t){this.pageNum=1,this.handleGetData()},instance_id(t){this.pageNum=1,this.securityInfoList=[],this.handleGetData()},sg_ids(t){this.initPara["sg_ids"]=JSON.stringify(this.sg_ids),this.pageNum=1,this.securityInfoList=[],this.handleGetData()}},computed:{},mounted(){this.handleGetData()}},l=o,p=(a("4861"),a("2877")),c=Object(p["a"])(l,s,r,!1,null,"0a04be8a",null);e["default"]=c.exports},e011:function(t,e,a){},e380:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("Modal",{attrs:{width:"780px;",title:t.modalData.title,"footer-hide":!0,styles:{top:"30px"}},model:{value:t.modalData.show,callback:function(e){t.$set(t.modalData,"show",e)},expression:"modalData.show"}},[e("Card",{attrs:{"dis-hover":""}},[e("div",{staticClass:"inner"},[e("Alert",{attrs:{"show-icon":""}},[t._v("基本信息")]),e("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Row",[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("实例ID：")])])]),e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.serverData.instance_id))])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("主机名：")])])]),e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.serverData.name))])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("厂商：")])])]),t.serverData.cloud_name?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.cloud_name)+" ")])]):t._e(),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("可用区：")])])]),e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.zone)+" ")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("网络类型：")])])]),t.serverData.network_type?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.network_type)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("付费类型：")])])]),t.serverData.charge_type?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.charge_type)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("实例状态：")])])]),"运行中"==t.serverData.state?e("Col",{attrs:{span:"8"}},[e("p",[e("tag",{attrs:{color:"success"}},[t._v(t._s(t.serverData.state))])],1)]):e("Col",{attrs:{span:"8"}},[e("p",[e("tag",{attrs:{color:"red"}},[t._v(t._s(t.serverData.state))])],1)]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("实例类型：")])])]),e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.instance_type)+" ")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("公网IP：")])])]),t.serverData.outer_ip?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.outer_ip))])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("没有公网IP")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("私网IP：")])])]),e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.inner_ip)+" ")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("CPU核心：")])])]),t.serverData.cpu?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.cpu)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("内存：")])])]),t.serverData.memory?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.memory)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("系统磁盘：")])])]),t.serverData.system_disk?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.system_disk)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("数据磁盘：")])])]),t.serverData.data_disk?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.data_disk))])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("安全组：")])])]),t.serverData.security_group_ids?e("Col",{attrs:{span:"20"}},t._l(t.serverData.security_group_ids,(function(a){return e("span",{staticStyle:{"margin-right":"6px"}},[t._v(" "+t._s(a)+" ")])})),0):e("Col",{attrs:{span:"20"}},[e("p",[t._v("没有安全组")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("系统名称：")])])]),t.serverData.os_name?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.os_name))])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("CloudWatch：")])])]),t.serverData.cloudwatch_state?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.cloudwatch_state)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("是否过期：")])])]),!0===t.serverData.is_expired?e("Col",{attrs:{span:"8"}},[e("p",[e("tag",{attrs:{color:"red"}},[t._v(t._s(t.serverData.is_expired))])],1)]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("正常")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("备注信息：")])])]),t.serverData.detail?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.detail)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("无")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("创建时间：")])])]),t.serverData.instance_create_time?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.instance_create_time)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("过期时间：")])])]),t.serverData.instance_expired_time?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.serverData.instance_expired_time))])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("最后更新时间：")])])]),e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.serverData.update_time)+" ")])])],1)],1)],1)])],1)},r=[],i={name:"serverDetail",props:{modalData:{type:Object,default:()=>{}},serverData:{type:Object,default:()=>{}}}},n=i,o=a("2877"),l=Object(o["a"])(n,s,r,!1,null,null,null);e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-6a3ffeb8.14d2410c.js.map