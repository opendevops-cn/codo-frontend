(window["webpackJsonp_cmdb"]=window["webpackJsonp_cmdb"]||[]).push([["chunk-1eff9cce","chunk-2d0c7d52","chunk-2d0e6712","chunk-2d213dff","chunk-2d0d5fe1"],{2355:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("Card",{attrs:{"dis-hover":"",bordered:!1}},[e("div",[e("Alert",{attrs:{"show-icon":""}},[t._v(" 已选择 "),e("span",[t._v(t._s(t.selectList.length))]),t._v(" 项 "),e("a",{staticStyle:{"margin-left":"10px"},on:{click:t.clearSelectAll}},[t._v("清空已选")])]),e("Select",{staticStyle:{width:"100px"},on:{"on-change":t.handleSerachChangge},model:{value:t.serachType,callback:function(e){t.serachType=e},expression:"serachType"}},t._l(t.serachTypeList,(function(a){return e("Option",{key:a.value,attrs:{value:a.value}},[t._v(t._s(a.label))])})),1),"address"===t.serachType?[e("Input",{staticStyle:{width:"300px",margin:"2px"},attrs:{clearable:"",placeholder:"输入地址模糊查询"},on:{"on-change":t.handleClear},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.initPara.search_address,callback:function(e){t.$set(t.initPara,"search_address",e)},expression:"initPara.search_address"}})]:[e("Input",{staticStyle:{width:"300px",margin:"2px"},attrs:{clearable:"",placeholder:"输入关键字模糊搜索"},on:{"on-change":t.handleClear},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}},model:{value:t.initPara.searchVal,callback:function(e){t.$set(t.initPara,"searchVal",e)},expression:"initPara.searchVal"}})],e("Button",{staticStyle:{margin:"3px"},on:{click:function(e){return t.handleSearch()}}},[t._v("搜索")]),e("Button",{staticStyle:{margin:"3px"},on:{click:t.handleAdd}},[t._v("添加")]),e("span",{staticStyle:{"margin-left":"20px"}},[t._v("一键筛选：")]),e("ButtonGroup",["is_normal"===t.initPara.search_filter?e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handlefilter("is_normal")}}},[t._v("未过期")]):e("Button",{on:{click:function(e){return t.handlefilter("is_normal")}}},[t._v("未过期")]),"is_expired"===t.initPara.search_filter?e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handlefilter("is_expired")}}},[t._v("已过期")]):e("Button",{on:{click:function(e){return t.handlefilter("is_expired")}}},[t._v("已过期")]),"is_showdown"===t.initPara.search_filter?e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handlefilter("is_showdown")}}},[t._v("已关机")]):e("Button",{on:{click:function(e){return t.handlefilter("is_showdown")}}},[t._v("已关机")])],1),0!==t.selectList.length?[e("Button",{staticStyle:{margin:"6px"},attrs:{type:"error"},on:{click:t.handleDel}},[t._v("一键删除")]),e("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:function(e){return t.exportData(2)}}},[e("Icon",{attrs:{type:"ios-download-outline"}}),t._v("导出数据 ")],1)]:[e("Button",{staticStyle:{margin:"6px"},attrs:{type:"error",disabled:""}},[t._v("一键删除")]),e("Button",{staticClass:"search-btn",attrs:{type:"primary",disabled:""}},[e("Icon",{attrs:{type:"ios-download-outline"}}),t._v("导出数据 ")],1)],e("Table",{ref:"selection",attrs:{stripe:"",size:"small",columns:t.columns,data:t.tableData,loading:t.i.tableLoading},on:{"on-sort-change":t.handleSort,"on-selection-change":t.handleSelect}})],2),e("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[e("div",{staticStyle:{float:"left"}},[e("Page",{attrs:{total:t.i.pageTotal,current:t.initPara.page_number,"page-size":t.initPara.page_size,"page-size-opts":[12,35,50,100],"show-sizer":"","show-total":""},on:{"on-change":t.handlerChangePage,"on-page-size-change":t.handlePageSize}})],1)]),t.redisData?e("div",[e("redisDetail",{attrs:{"modal-data":t.modalData,"redis-data":t.redisData}})],1):t._e(),t.addressDialog.show?e("div",[e("redisAddress",{attrs:{dialog:t.addressDialog,"address-items":t.addressItems}})],1):t._e(),e("redis-add",{attrs:{"modal-data":t.modalAdd},on:{"drawer-close":t.handleClose,"save-data":t.handleSaveData}})],1)},r=[],n=(a("14d9"),a("713d")),i=a("af15"),l=a("9984"),o=a("51ff"),d={components:{redisDetail:i["default"],redisAddress:l["default"],redisAdd:o["default"]},data(){return{addressDialog:{show:!1,title:""},addressItems:{},modalData:{show:!1,title:"Redis详情"},redisData:{},modalAdd:{show:!1,action:"post",title:"添加缓存数据库"},selectList:[],serachType:"default",serachTypeList:[{value:"default",label:"默认搜索"},{value:"address",label:"地址搜索"}],i:{pageTotal:0,tableLoading:!0},initPara:{page_number:1,page_size:12,search_filter:"is_normal",order_by:"",order:"ascend"},tableData:[],columns:[{type:"selection",title:"selection",key:"selection",width:60,align:"center"},{title:"云厂商",key:"cloud_name",minWidth:130,maxWidth:160,sortable:!0,render:(t,e)=>"qcloud"===e.row.cloud_name?t("div",[t("Tag",{props:{color:"geekblue"}},"腾讯云")]):"aliyun"===e.row.cloud_name?t("div",[t("Tag",{props:{color:"blue"}},"阿里云")]):"cds"===e.row.cloud_name?t("div",[t("Tag",{props:{color:"cyan"}},"首都云")]):"volc"===e.row.cloud_name?t("div",[t("Tag",{props:{color:"orange"}},"火山云")]):"gcp"===e.row.cloud_name?t("div",[t("Tag",{props:{color:"green"}},"谷歌云")]):"aws"===e.row.cloud_name?t("div",[t("Tag",{props:{color:"volcano"}},"AWS")]):t("div",[t("Tag",{props:{color:"green"}},"未知")])},{title:"实例状态",key:"state",align:"center",width:130,sortable:!0,render:(t,e)=>{const{row:a}=e,s="运行中"===a.state?"success":"关机"===a.state?"error":"创建中"===a.state?"primary":"error",r="运行中"===a.state?"运行中":"关机"===a.state?"已关机":"创建中"===a.state?"创建中":a.state;return t("Tag",{props:{type:"dot",color:s}},r)}},{title:"实例ID",key:"instance_id",align:"center",minWidth:120,sortable:!0,render:(t,e)=>t("a",{on:{click:()=>{this.handleDetail(e.row)}}},e.row.instance_id)},{title:"实例名称",key:"name",align:"left",minWidth:120,sortable:!0,tooltip:!0},{title:"可用区",key:"zone",width:150,tooltip:!0},{title:"实例类型",key:"instance_class",align:"center",width:160,sortable:!0,tooltip:!0},{title:"架构",key:"instance_arch",align:"center",width:130,sortable:!0},{title:"版本",key:"instance_version",align:"center",width:100,sortable:!0},{title:"操作",key:"handle",width:120,align:"center",render:(t,e)=>t("div",[t("a",{style:{marginRight:"10px"},on:{click:()=>{this.handViewAddress(e.row)}}},"链接地址")])},{title:"最后更新时间",key:"update_time",align:"center",fixed:"right",width:180,sortable:!0}]}},mounted(){this.handleGetData()},methods:{async handleGetData(){const t=await Object(n["getRedisList"])(this.initPara);0===t.code?(this.tableData=t.data,this.i.pageTotal=t.count):this.$Message.error(""+t.msg),this.clearSelectAll(),this.i.tableLoading=!1},handleClose(){this.modalAdd.show=!1,this.modalData.show=!1,this.handleGetData()},handleAdd(){this.modalAdd.show=!0},handleSaveData(t,e,a){Object(n["optrationRedis"])(t,e).then(t=>{0==t.code?(this.$Message.success("成功"),a?this.handleGetData():this.handleClose()):this.$Message.error(t.msg)})},handleSearch(){this.initPara.page_number=1,this.handleGetData()},handlefilter(t){this.initPara.search_filter=t,this.handleGetData()},handleDetail(t){this.redisData=t,this.modalData.show=!0},handViewAddress(t){this.addressItems=t.instance_address.items,this.addressDialog={show:!0,title:t.name}},handleSort(t,e,a){this.initPara.order="asc"===t.order?"ascend":"descend",this.initPara.order_by=t.key,this.handleGetData()},handlerChangePage(t){this.initPara.page_number=t,this.handleGetData()},handlePageSize(t){this.initPara.page_number=1,this.initPara.page_size=t,this.handleGetData()},handleSelect(t){let e=[];t.forEach(t=>{e.push(t.id)}),this.selectList=e},clearSelectAll(){this.$refs.selection.selectAll(!1)},handleClear(t){""===t.target.value&&(this.tableData=this.value)},handleSerachChangge(){this.initPara.search_address="",this.initPara.searchVal=""},handleDel(){this.$Modal.confirm({title:"二次确认",content:"确定删除已选中的数据? ",onOk:()=>{Object(n["optrationRedis"])({id_list:this.selectList},"delete").then(t=>{0===t.code?(this.$Notice.success({title:""+t.msg}),this.handleGetData()):this.$Notice.error({title:""+t.msg}),this.clearSelectAll()})},onCancel:()=>{this.$Message.info("回头是岸~"),this.clearSelectAll()}})},exportData(t){1===t?this.$refs.selection.exportCsv({filename:"codo_cmdb_original_data"}):2===t&&this.$refs.selection.exportCsv({filename:"codo_cmdb_sorting_and_filtering_data",original:!1}),this.clearSelectAll()}}},c=d,p=a("2877"),h=Object(p["a"])(c,s,r,!1,null,null,null);e["default"]=h.exports},"51ff":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("Drawer",{attrs:{"before-close":t.handleClose,title:t.modalData.title,width:"50%",draggable:"","mask-closable":!1,"footer-hide":!0},on:{"on-close":t.handleCancel},model:{value:t.modalData.show,callback:function(e){t.$set(t.modalData,"show",e)},expression:"modalData.show"}},[e("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[e("FormItem",{attrs:{label:"实例名称",prop:"name"}},[e("Input",{attrs:{maxlength:120,placeholder:"请输入实例名称"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name",e)},expression:"formValidate.name"}})],1),e("FormItem",{attrs:{label:"厂商信息",prop:"cloud_name"}},[e("Input",{attrs:{maxlength:120,placeholder:"请输入厂商名称"},model:{value:t.formValidate.cloud_name,callback:function(e){t.$set(t.formValidate,"cloud_name",e)},expression:"formValidate.cloud_name"}})],1),e("FormItem",{attrs:{label:"版本",prop:"instance_version"}},[e("Input",{attrs:{maxlength:120,placeholder:"请输入"},model:{value:t.formValidate.instance_version,callback:function(e){t.$set(t.formValidate,"instance_version",e)},expression:"formValidate.instance_version"}})],1),e("FormItem",{attrs:{label:"架构类型",prop:"instance_arch"}},[e("Input",{attrs:{maxlength:120,placeholder:"请输入"},model:{value:t.formValidate.instance_arch,callback:function(e){t.$set(t.formValidate,"instance_arch",e)},expression:"formValidate.instance_arch"}})],1),e("FormItem",{attrs:{label:"实例ID",prop:"instance_id"}},[e("Input",{attrs:{maxlength:120,placeholder:"请输入实例ID，如果不填则随机生成"},model:{value:t.formValidate.instance_id,callback:function(e){t.$set(t.formValidate,"instance_id",e)},expression:"formValidate.instance_id"}})],1),e("FormItem",{attrs:{label:"数据库地址"}},[e("vue-json-editor",{attrs:{"show-btns":!1,mode:"code",lang:"zh"},model:{value:t.formValidate.instance_address,callback:function(e){t.$set(t.formValidate,"instance_address",e)},expression:"formValidate.instance_address"}})],1),e("FormItem",{attrs:{label:"扩展字段"}},[e("vue-json-editor",{attrs:{"show-btns":!1,mode:"code",lang:"zh"},on:{"json-change":t.onJsonChange,"json-save":t.onJsonSave,"has-error":t.onError},model:{value:t.formValidate.ext_info,callback:function(e){t.$set(t.formValidate,"ext_info",e)},expression:"formValidate.ext_info"}})],1),e("FormItem",[e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate",!1)}}},[t._v("保存")]),e("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleSubmit("formValidate",!0)}}},[t._v("保存并继续")]),e("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset("formValidate")}}},[t._v("重置")])],1)],1)],1)],1)},r=[],n=a("45a3"),i={name:"redisAdd",components:{vueJsonEditor:n["a"]},props:{modalData:{type:Object,default:{}}},data(){return{btnLoading:!1,ruleValidate:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],cloud_name:[{required:!0,message:"不能为空",trigger:"blur"}]},formValidate:{cloud_name:"qcloud",instance_arch:"集群版",instance_version:"6.0",instance_address:{items:[{ip:"10.24.20.218",port:"6379",type:"private",domain:"r-uf6vkcccc.redis.rds.aliyuncs.com"},{ip:"",port:"",type:"public",domain:""}]},ext_info:{zone:"ap-shanghai",region:"ap-shanghai",vpc_id:"vpc-oic5ltog",az_mode:"",vswitch_id:"subnet-19n5m42d",charge_type:"包年包月",create_time:"2020-06-09 11:04:45",network_type:"专有网络",instance_type:"Redis",instance_class:"6144MB",state:"运行中"}}}},methods:{handleCancel(){this.$emit("drawer-close")},handleClose(){this.$emit("drawer-close")},handleSubmit(t,e){this.$refs[t].validate(t=>{t?(this.btnLoading=!0,setTimeout(()=>{this.$emit("save-data",this.formValidate,this.modalData.action,e),this.btnLoading=!1},1e3)):this.$Message.error("表单校验不通过!")})},onJsonChange(t){console.log("更改了--\x3e",t),this.jsonErrFlag=!1},onJsonSave(t){console.log("保存了---\x3e",t)},onError(t){console.log("报错了---\x3e",t),this.jsonErrFlag=!0}},watch:{},computed:{},mounted(){}},l=i,o=a("2877"),d=Object(o["a"])(l,s,r,!1,null,null,null);e["default"]=d.exports},"713d":function(t,e,a){"use strict";a.r(e),a.d(e,"getRedisList",(function(){return r})),a.d(e,"optrationRedis",(function(){return n}));var s=a("be3b");const r=t=>Object(s["default"])({url:"/api/v2/cmdb/redis/",method:"get",params:t}),n=(t,e)=>Object(s["default"])({url:"/api/v2/cmdb/redis/",method:e,data:t})},9984:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",[e("Modal",{attrs:{title:t.dialog.title,width:"70%","mask-closable":!1,"footer-hide":!0},model:{value:t.dialog.show,callback:function(e){t.$set(t.dialog,"show",e)},expression:"dialog.show"}},[e("alert",[t._v("一共查询到:"+t._s(t.totalCount)+"条链接地址")]),e("div",{staticStyle:{"margin-top":"5px"}},[e("Table",{attrs:{columns:t.columns,data:t.addressItems}})],1)],1)],1)},r=[],n={name:"redisAddress",props:{dialog:Object,addressItems:{type:Array,default:function(){return[]}}},data(){return{columns:[{title:"NetWork",key:"type",align:"center",width:120,render:(t,e)=>{let a=e.row.type;return"private"===a?t("div",[t("Tag",{props:{color:"default"}},"内网")]):"public"===a?t("div",[t("Tag",{props:{color:"red"}},"公网")]):void 0}},{title:"Port",key:"port",width:100,align:"center"},{title:"IP Address",key:"ip",width:150,align:"center"},{title:"Domain Address",key:"domain",align:"left"}]}},computed:{totalCount(){return this.addressItems.length}}},i=n,l=a("2877"),o=Object(l["a"])(i,s,r,!1,null,null,null);e["default"]=o.exports},af15:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("Modal",{attrs:{width:"780px;",title:t.modalData.title,"footer-hide":!0,styles:{top:"30px"}},model:{value:t.modalData.show,callback:function(e){t.$set(t.modalData,"show",e)},expression:"modalData.show"}},[e("Card",{attrs:{"dis-hover":""}},[e("div",{staticClass:"inner"},[e("Alert",{attrs:{"show-icon":""}},[t._v("基本信息")]),e("div",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Row",[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("实例ID：")])])]),e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.redisData.instance_id))])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("实例名称：")])])]),e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.redisData.name))])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("厂商：")])])]),t.redisData.cloud_name?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.cloud_name)+" ")])]):t._e(),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("AccountID：")])])]),e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.account_id)+" ")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("地区：")])])]),t.redisData.region?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.region))])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("机房：")])])]),e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.zone)+" ")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("网络类型：")])])]),t.redisData.network_type?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.network_type)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("付费类型：")])])]),t.redisData.charge_type?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.charge_type)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("实例状态：")])])]),"运行中"==t.redisData.state?e("Col",{attrs:{span:"8"}},[e("p",[e("tag",{attrs:{color:"success"}},[t._v(t._s(t.redisData.state))])],1)]):e("Col",{attrs:{span:"8"}},[e("p",[e("tag",{attrs:{color:"red"}},[t._v(t._s(t.redisData.state))])],1)]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("是否过期：")])])]),!0===t.redisData.is_expired?e("Col",{attrs:{span:"8"}},[e("p",[e("tag",{attrs:{color:"red"}},[t._v(t._s(t.redisData.is_expired))])],1)]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("正常")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("引擎：")])])]),t.redisData.instance_type?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.instance_type))])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("版本：")])])]),t.redisData.instance_version?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.instance_version)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("架构：")])])]),t.redisData.instance_arch?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.instance_arch))])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])]),e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("QPS：")])])]),t.redisData.ext_info?e("Col",{attrs:{span:"8"}},[e("p",[t._v(" "+t._s(t.redisData.ext_info.qps)+" ")])]):e("Col",{attrs:{span:"8"}},[e("p",[t._v("未知信息")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("实例类型：")])])]),e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.redisData.instance_class)+" ")])])],1),e("Row",{staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("创建时间：")])])]),t.redisData.create_time?e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.redisData.create_time)+" ")])]):e("Col",{attrs:{span:"20"}},[e("p",[t._v("未知信息")])])],1),e("Row",[e("Col",{attrs:{span:"4"}},[e("p",[e("b",[t._v("最后更新时间：")])])]),e("Col",{attrs:{span:"20"}},[e("p",[t._v(" "+t._s(t.redisData.update_time)+" ")])])],1)],1)],1)])],1)},r=[],n={name:"mysqlDetail",props:{modalData:{type:Object,default:()=>{}},redisData:{type:Object,default:()=>{}}}},i=n,l=a("2877"),o=Object(l["a"])(i,s,r,!1,null,null,null);e["default"]=o.exports}}]);
//# sourceMappingURL=chunk-1eff9cce.edac627d.js.map