{"version":3,"sources":["webpack://cmdb-[name]/./src/views/cmdb/biz/components/perm-group-edit.vue?0a4c","webpack://cmdb-[name]/./src/api/service-tree.js","webpack://cmdb-[name]/./src/api/cmdb/perm-group.js","webpack://cmdb-[name]/./src/views/cmdb/biz/components/preview-host.vue","webpack://cmdb-[name]/src/views/cmdb/biz/components/preview-host.vue","webpack://cmdb-[name]/./src/views/cmdb/biz/components/preview-host.vue?0eb5","webpack://cmdb-[name]/./src/views/cmdb/biz/components/preview-host.vue?c4f5","webpack://cmdb-[name]/./src/views/cmdb/biz/perm-group.vue?6b4d","webpack://cmdb-[name]/./src/views/cmdb/biz/components/perm-group-edit.vue","webpack://cmdb-[name]/src/views/cmdb/biz/components/perm-group-edit.vue","webpack://cmdb-[name]/./src/views/cmdb/biz/components/perm-group-edit.vue?cc0a","webpack://cmdb-[name]/./src/views/cmdb/biz/components/perm-group-edit.vue?4844","webpack://cmdb-[name]/./src/views/cmdb/biz/perm-group.vue","webpack://cmdb-[name]/src/views/cmdb/biz/perm-group.vue","webpack://cmdb-[name]/./src/views/cmdb/biz/perm-group.vue?c1dc","webpack://cmdb-[name]/./src/views/cmdb/biz/perm-group.vue?edca","webpack://cmdb-[name]/./src/views/cmdb/biz/perm-group.vue?5292"],"names":["postTreeAsset","data","request","url","method","getTreeAsset","params","changeTreeAssetStatus","deleteTreeAsset","getRelation","getServiceTreelist","operationTree","getBizEnv","getTreeModule","preViewPermGroupHost","exec_uuid","getPermGrouplist","optPermGroup","SyncPermGroup","render","_vm","this","_c","_self","attrs","model","value","dialog","show","callback","$$v","$set","expression","_v","_s","totalCount","staticStyle","on","handleFilter","nativeOn","$event","type","indexOf","_k","keyCode","key","apply","arguments","searchVal","ref","columns","tableData","pageNum","pageSize","handlerChangePage","staticRenderFns","name","props","Object","default","serverList","serverFilteredList","pageTotal","filterState","undefined","filterAgentStatus","title","align","sortable","minWidth","width","h","row","color","state","text","filterMultiple","filters","label","filterRemote","status","agent_status","computed","length","watch","newVal","initData","setCurrentPageData","methods","begin","end","slice","checkExecList","item","instance_id","inner_ip","includes","filter","$refs","table","handleFilterReset","component","modalData","formValidate","ruleValidate","perm_group_name","slot","handleChangeBiz","biz_id","_l","bizList","biz_cn_name","env_name","envList","region_name","module_name","jms_org_id","jmsOrgs","id","handleStartDateChange","perm_start_time","handleEndDateChange","perm_end_time","user_group","roleList","role_name","perm_type","minRows","maxRows","perm_group_detail","staticClass","handleCancel","handleSubmit","Array","index","btnLoading","regionList","jmssAccounts","required","message","trigger","validator","validateEndTime","handler","newValue","oldValue","handleGetEnv","deep","rule","Date","Error","date","formatDate","d","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","res","code","env_list","$Message","error","msg","resetFields","$emit","handleRoleInfoList","getRoleInfoList","then","handleJmsOrgList","getJMSOrgList","handleChange","valid","validate","setTimeout","action","$Notice","mounted","handleSearch","initPara","handCreate","handleSort","i","page_number","page_size","handlePageSize","spinShow","_e","handleClose","handleSaveData","components","preViewHost","permGroupEdit","maxWidth","tooltip","join","bizMap","style","marginRight","click","handlePreview","handleEdit","SyncPerm","handleDel","order_by","order","tableLoading","initForm","count","getBusinesslist","forEach","ele","handleGetData","dgEdit","paramsRow","rowToConfig","saveData","console","info","success","desc","body","$Modal","confirm","content","onOk","id_list","onCancel","previewHost","e","toString","column","created","handleGetBizList"],"mappings":"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","file":"static/js/chunk-16e6ffc3.be06b429.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./perm-group-edit.vue?vue&type=style&index=0&id=78b7ebae&prod&lang=css&\"","import request from '@/plugins/axios'\n\n//  服务树\nexport const postTreeAsset = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'post',\n  data,\n})\n// 获取树资产\nexport const getTreeAsset = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'get',\n  params,\n})\n\n// 更改资产状态\nexport const changeTreeAssetStatus = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'patch',\n  data,\n})\n\nexport const deleteTreeAsset = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'delete',\n  data,\n})\n\n// 主机关系\nexport const getRelation = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/asset/relation/',\n  method: 'get',\n  params,\n})\n\n// 业务Tree\nexport const getServiceTreelist = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/',\n  method: 'get',\n  params,\n})\n\nexport const operationTree = (/** @type {any} */ data, /** @type {any} */ method) => request({\n  url: '/api/v2/cmdb/tree/',\n  method,\n  data,\n})\n\n\nexport const getBizEnv = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/env/',\n  method: 'get',\n  params,\n})\n\nexport const getTreeModule = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/module/',\n  method: 'get',\n  params,\n})","/* eslint-disable camelcase */\nimport request from '@/plugins/axios'\n// 权限分组\n\n// 预览分组主机\nexport const preViewPermGroupHost = (exec_uuid) => request({\n  url: '/api/v2/cmdb/biz/perm_group/preview/',\n  method: 'get',\n  params: {\n    exec_uuid,\n  },\n})\n\nexport const getPermGrouplist = (params) => request({\n  url: '/api/v2/cmdb/biz/perm_group/',\n  method: 'get',\n  params,\n})\n\nexport const optPermGroup = (data, method) => request({\n  url: '/api/v2/cmdb/biz/perm_group/',\n  data,\n  method,\n})\n\n// 同步权限分组\nexport const SyncPermGroup = (data, method) => request({\n  url: '/api/v2/cmdb/biz/perm_group/sync/',\n  data,\n  method,\n})","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('Modal',{attrs:{\"title\":\"预览主机\",\"width\":\"950\",\"mask-closable\":false,\"footer-hide\":true},model:{value:(_vm.dialog.show),callback:function ($$v) {_vm.$set(_vm.dialog, \"show\", $$v)},expression:\"dialog.show\"}},[_c('alert',[_vm._v(\"一共查询到:\"+_vm._s(_vm.totalCount)+\"条数据\")]),_c('Input',{staticStyle:{\"width\":\"330px\",\"margin\":\"0px\"},attrs:{\"clearable\":\"\",\"placeholder\":\"输入实例ID、主机名、内网IP搜索\",\"search\":\"\"},on:{\"on-change\":_vm.handleFilter},nativeOn:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.handleFilter.apply(null, arguments)}},model:{value:(_vm.searchVal),callback:function ($$v) {_vm.searchVal=$$v},expression:\"searchVal\"}}),_c('div',{staticStyle:{\"margin-top\":\"5px\"}},[_c('Table',{ref:\"table\",attrs:{\"stripe\":\"\",\"border\":\"\",\"size\":\"small\",\"columns\":_vm.columns,\"data\":_vm.tableData}})],1),_c('div',{staticStyle:{\"margin\":\"10px\",\"overflow\":\"hidden\"}},[_c('Page',{attrs:{\"total\":_vm.totalCount,\"current\":_vm.pageNum,\"page-size\":_vm.pageSize,\"show-total\":\"\"},on:{\"on-change\":_vm.handlerChangePage}})],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!-- eslint-disable vue/no-mutating-props -->\n<template>\n  <div>\n    <Modal v-model=\"dialog.show\" title=\"预览主机\" width=\"950\" :mask-closable=\"false\" :footer-hide=\"true\">\n      <alert>一共查询到:{{ totalCount }}条数据</alert>\n      <Input v-model=\"searchVal\" style=\"width: 330px; margin: 0px\" clearable placeholder=\"输入实例ID、主机名、内网IP搜索\" @keydown.enter.native=\"handleFilter\" @on-change=\"handleFilter\" search/>\n\n\n\n      <div style=\"margin-top: 5px\">\n        <Table stripe border size=\"small\" :columns=\"columns\" :data=\"tableData\" ref=\"table\"/>\n      </div>\n\n      <div style=\"margin: 10px; overflow: hidden\">\n        <Page :total=\"totalCount\" :current=\"pageNum\" :page-size=\"pageSize\" show-total @on-change=\"handlerChangePage\" />\n      </div>\n    </Modal>\n  </div>\n</template>\n<script>\nexport default {\n  name: \"PreViewHost\",\n  props: {\n    dialog: {\n      type: Object,\n      default: {},\n    },\n  },\n  data() {\n    return {\n      serverList: [], // 初始总数\n      serverFilteredList: [],\n      tableData: [],\n      searchVal: \"\",\n      pageTotal: 0,\n      pageSize: 10,\n      pageNum: 1,\n      filterState: undefined,\n      filterAgentStatus: undefined,\n      columns: [\n        {\n          title: \"实例ID\",\n          key: \"instance_id\",\n          align: \"center\",\n          sortable: true,\n        },\n        {\n          title: \"主机名称\",\n          key: \"name\",\n          align: \"center\",\n          minWidth: 100,\n          sortable: true,\n        },\n        {\n          title: \"内网IP\",\n          key: \"inner_ip\",\n          align: \"center\",\n          width: 140,\n\n          sortable: true,\n        },\n        {\n          title: \"外网IP\",\n          key: \"outer_ip\",\n          align: \"center\",\n          width: 140,\n          sortable: true,\n        },\n        {\n          title: \"运行状态\",\n          key: \"state\",\n          align: \"center\",\n          width: 135,\n          sortable: true,\n          render: (h, params) => {\n            const { row } = params\n            // eslint-disable-next-line no-nested-ternary\n            const color = row.state === \"运行中\" ? \"success\" : row.state === \"关机\" ? \"error\" : row.state === \"创建中\" ? \"primary\" : \"error\"\n            // eslint-disable-next-line no-nested-ternary\n            const text = row.state === \"运行中\" ? \"运行中\" : row.state === \"关机\" ? \"已关机\" : row.state === \"创建中\" ? \"创建中\" : \"Fail\"\n            return h(\n              \"Tag\",\n              {\n                props: {\n                  type: \"dot\",\n                  color,\n                },\n              },\n              text,\n            )\n          },\n          filterMultiple: false,\n          filters: [\n            { label: \"运行中\", value: \"运行中\" },\n            { label: \"已关机\", value: \"关机\" },\n            { label: \"创建中\", value: \"创建中\" },\n            { label: \"Fail\", value: \"Fail\" },\n          ],\n\n          filterRemote: (value, row) => {\n            this.filterState = value[0]\n            this.handleFilter()\n          },\n        },\n        {\n          title: \"Agent状态\",\n          key: \"agent_status\",\n          align: \"center\",\n          width: 135,\n          sortable: true,\n          render: (h, params) => {\n            const status = params.row.agent_status\n            if (status == \"1\") {\n              return h(\"div\", [h(\"Tag\", { props: { color: \"green\", type: \"border\" } }, \"在线\")])\n            } if (status == \"2\") {\n              return h(\"div\", [h(\"Tag\", { props: { color: \"red\" } }, \"离线\")])\n            }\n            return h(\"div\", [h(\"Tag\", { props: { color: \"error\" } }, \"未知\")])\n          },\n          filterMultiple: false,\n          filters: [\n            { label: \"在线\", value: \"1\" },\n            { label: \"离线\", value: \"2\" },\n            { label: \"未知\", value: \"error\" },\n          ],\n          filterRemote: (value, row) => {\n            this.filterAgentStatus = value[0]\n            this.handleFilter()\n          },\n        },\n      ],\n    }\n  },\n  computed: {\n    totalCount() {\n      return this.serverFilteredList.length\n    },\n  },\n  watch: {\n\n    \"dialog.show\": function (newVal) {\n      if (newVal) {\n        this.initData()\n        this.setCurrentPageData()\n      }\n    },\n  },\n  methods: {\n    handlerChangePage(value) {\n      this.pageNum = value\n      this.setCurrentPageData()\n    },\n    // 分页处理\n    setCurrentPageData() {\n      const begin = (this.pageNum - 1) * this.pageSize\n      const end = this.pageNum * this.pageSize\n      this.tableData = this.serverFilteredList.slice(begin, end)\n    },\n    checkExecList(item) {\n\n      return (item.instance_id.indexOf(this.searchVal) >= 0 || item.name.indexOf(this.searchVal) >= 0 || item.inner_ip.indexOf(this.searchVal) >= 0) && (!this.filterState || item.state === this.filterState || this.filterState === \"Fail\" && ![\"运行中\", \"关机\", \"创建中\"].includes(item.state)) && (!this.filterAgentStatus || item.agent_status === this.filterAgentStatus || this.filterAgentStatus === \"error\" && ![\"1\", \"2\"].includes(item.agent_status))\n    },\n    // 前端搜索和筛选\n    handleFilter() {\n      this.pageNum = 1\n      if (this.searchVal || this.filterState||this.filterAgentStatus) {\n        this.serverFilteredList = this.serverList.filter(this.checkExecList)\n      } else {\n        this.serverFilteredList = this.serverList\n      }\n\n      this.setCurrentPageData()\n    },\n    initData() {\n      this.serverFilteredList = this.serverList\n      this.pageNum = 1\n      this.pageSize = 10\n      this.searchVal = \"\"\n      this.filterState = undefined\n      this.filterAgentStatus = undefined\n\n      // 重置筛选状态，运行状态和Agent状态两个列有筛选,都要重置。handleFilterReset这个方法文档中没有，是查了源码找到的\n      this.$refs.table.handleFilterReset(4);\n      this.$refs.table.handleFilterReset(5);\n\n    },\n  },\n}\n</script>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./preview-host.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./preview-host.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./preview-host.vue?vue&type=template&id=4cd7f56a&\"\nimport script from \"./preview-host.vue?vue&type=script&lang=js&\"\nexport * from \"./preview-host.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./perm-group.vue?vue&type=style&index=0&id=31659650&prod&lang=css&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('Drawer',{attrs:{\"title\":_vm.modalData.title,\"width\":\"800\",\"draggable\":\"\",\"mask-closable\":false},model:{value:(_vm.modalData.show),callback:function ($$v) {_vm.$set(_vm.modalData, \"show\", $$v)},expression:\"modalData.show\"}},[_c('Form',{ref:\"formValidate\",staticStyle:{\"width\":\"750px\"},attrs:{\"model\":_vm.formValidate,\"rules\":_vm.ruleValidate,\"label-width\":90}},[_c('FormItem',{staticStyle:{\"padding-top\":\"10px\"},attrs:{\"label\":\"分组名称\",\"prop\":\"perm_group_name\"}},[_c('Input',{attrs:{\"maxlength\":50,\"placeholder\":\"请输入分组名称\"},model:{value:(_vm.formValidate.perm_group_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"perm_group_name\", $$v)},expression:\"formValidate.perm_group_name\"}})],1),[_c('Row',{attrs:{\"gutter\":5}},[_c('FormItem',[_c('Alert',{attrs:{\"type\":\"success\",\"show-icon\":\"\",\"closable\":\"\"}},[_vm._v(\" 根据业务拓扑信息创建动态分组 \"),_c('template',{slot:\"desc\"},[_c('p',[_vm._v(\" 下列条件的关系为且 业务为必填项，集群和模块为可以输入多个，以半角逗号或者空格来分隔。 \")]),_c('p',[_vm._v(\"当前类型查询条件不支持通配符，全部为精确查询。\")])])],2)],1),_c('Col',{attrs:{\"span\":\"12\"}},[_c('FormItem',{attrs:{\"label\":\"选择业务\",\"prop\":\"biz_id\"}},[_c('Select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择业务...\"},on:{\"on-select\":_vm.handleChangeBiz},model:{value:(_vm.formValidate.biz_id),callback:function ($$v) {_vm.$set(_vm.formValidate, \"biz_id\", $$v)},expression:\"formValidate.biz_id\"}},_vm._l((_vm.bizList),function(item){return _c('Option',{key:item.biz_id,attrs:{\"value\":item.biz_id,\"label\":item.biz_cn_name}})}),1)],1)],1),_c('Col',{attrs:{\"span\":\"12\"}},[_c('FormItem',{attrs:{\"label\":\"\",\"prop\":\"env_name\"}},[_c('Select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择环境..\"},model:{value:(_vm.formValidate.env_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"env_name\", $$v)},expression:\"formValidate.env_name\"}},_vm._l((_vm.envList),function(item){return _c('Option',{key:item,attrs:{\"value\":item,\"label\":item}})}),1)],1)],1),_c('Col',{attrs:{\"span\":\"24\"}},[_c('FormItem',{attrs:{\"label\":\"集群名称\",\"prop\":\"region_name\"}},[_c('Input',{attrs:{\"maxlength\":500,\"placeholder\":\"输入集群、区服名称，多个以半角逗号或者空格区分\"},model:{value:(_vm.formValidate.region_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"region_name\", $$v)},expression:\"formValidate.region_name\"}})],1)],1),_c('Col',{attrs:{\"span\":\"24\"}},[_c('FormItem',{attrs:{\"label\":\"模块名称\",\"prop\":\"module_name\"}},[_c('Input',{attrs:{\"maxlength\":500,\"placeholder\":\"输入模块、服务名称，多个以半角逗号或者空格区分\"},model:{value:(_vm.formValidate.module_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"module_name\", $$v)},expression:\"formValidate.module_name\"}})],1)],1)],1)],_c('FormItem',{attrs:{\"label\":\"堡垒机组织\",\"prop\":\"jms_org_id\"}},[_c('Select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择组织\"},model:{value:(_vm.formValidate.jms_org_id),callback:function ($$v) {_vm.$set(_vm.formValidate, \"jms_org_id\", $$v)},expression:\"formValidate.jms_org_id\"}},_vm._l((_vm.jmsOrgs),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.id,\"label\":item.name}})}),1)],1),_c('Col',{attrs:{\"span\":\"24\"}},[_c('FormItem',{attrs:{\"label\":\"权限开始时间\",\"prop\":\"perm_start_time\"}},[_c('Row',[_c('DatePicker',{staticStyle:{\"width\":\"700px\"},attrs:{\"type\":\"datetime\",\"placeholder\":\"开始时间\",\"format\":\"yyyy-MM-dd HH:mm:ss\"},on:{\"on-change\":_vm.handleStartDateChange},model:{value:(_vm.formValidate.perm_start_time),callback:function ($$v) {_vm.$set(_vm.formValidate, \"perm_start_time\", $$v)},expression:\"formValidate.perm_start_time\"}})],1)],1)],1),[_c('Col',{attrs:{\"span\":\"24\"}},[_c('FormItem',{attrs:{\"label\":\"权限结束时间\",\"prop\":\"perm_end_time\"}},[_c('Row',[_c('DatePicker',{staticStyle:{\"width\":\"700px\"},attrs:{\"type\":\"datetime\",\"placeholder\":\"结束时间\",\"format\":\"yyyy-MM-dd HH:mm:ss\"},on:{\"on-change\":_vm.handleEndDateChange},model:{value:(_vm.formValidate.perm_end_time),callback:function ($$v) {_vm.$set(_vm.formValidate, \"perm_end_time\", $$v)},expression:\"formValidate.perm_end_time\"}})],1)],1)],1),_c('FormItem',{attrs:{\"label\":\"用户组\",\"prop\":\"user_group\"}},[_c('Select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择用户组\",\"multiple\":\"\"},model:{value:(_vm.formValidate.user_group),callback:function ($$v) {_vm.$set(_vm.formValidate, \"user_group\", $$v)},expression:\"formValidate.user_group\"}},_vm._l((_vm.roleList),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.role_name,\"label\":item.role_name}})}),1)],1)],_c('FormItem',{attrs:{\"label\":\"账号类型\",\"prop\":\"perm_type\"}},[_c('RadioGroup',{model:{value:(_vm.formValidate.perm_type),callback:function ($$v) {_vm.$set(_vm.formValidate, \"perm_type\", $$v)},expression:\"formValidate.perm_type\"}},[_c('Radio',{attrs:{\"label\":\"dev\"}},[_vm._v(\"普通用户\")]),_c('Radio',{attrs:{\"label\":\"ops\"}},[_vm._v(\"特权用户\")])],1)],1),_c('FormItem',{attrs:{\"label\":\"备注信息\",\"prop\":\"perm_group_detail\"}},[_c('Input',{attrs:{\"type\":\"textarea\",\"autosize\":{ minRows: 3, maxRows: 5 },\"placeholder\":\"Enter something...\"},model:{value:(_vm.formValidate.perm_group_detail),callback:function ($$v) {_vm.$set(_vm.formValidate, \"perm_group_detail\", $$v)},expression:\"formValidate.perm_group_detail\"}})],1),_c('div',{staticClass:\"drawer-footer\"},[_c('Button',{staticStyle:{\"margin-right\":\"8px\"},on:{\"click\":function($event){return _vm.handleCancel('formValidate')}}},[_vm._v(\"取消\")]),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.handleSubmit('formValidate')}}},[_vm._v(\"提交\")])],1)],2)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <Drawer\n      :title=\"modalData.title\"\n      v-model=\"modalData.show\"\n      width=\"800\"\n      draggable\n      :mask-closable=\"false\"\n    >\n      <Form\n        ref=\"formValidate\"\n        :model=\"formValidate\"\n        :rules=\"ruleValidate\"\n        :label-width=\"90\"\n        style=\"width: 750px\"\n      >\n        <FormItem\n          label=\"分组名称\"\n          prop=\"perm_group_name\"\n          style=\"padding-top: 10px\"\n        >\n          <Input\n            v-model=\"formValidate.perm_group_name\"\n            :maxlength=\"50\"\n            placeholder=\"请输入分组名称\"\n          ></Input>\n        </FormItem>\n        <template>\n          <Row :gutter=\"5\">\n            <FormItem>\n              <Alert type=\"success\" show-icon closable>\n                根据业务拓扑信息创建动态分组\n                <template slot=\"desc\">\n                  <p>\n                    下列条件的关系为且\n                    业务为必填项，集群和模块为可以输入多个，以半角逗号或者空格来分隔。\n                  </p>\n                  <p>当前类型查询条件不支持通配符，全部为精确查询。</p>\n                </template>\n              </Alert>\n            </FormItem>\n            <Col span=\"12\">\n              <FormItem label=\"选择业务\" prop=\"biz_id\">\n                <Select\n                  v-model=\"formValidate.biz_id\"\n                  filterable\n                  placeholder=\"请选择业务...\"\n                  @on-select=\"handleChangeBiz\"\n                >\n                  <Option\n                    v-for=\"item in bizList\"\n                    :key=\"item.biz_id\"\n                    :value=\"item.biz_id\"\n                    :label=\"item.biz_cn_name\"\n                  />\n                </Select>\n              </FormItem>\n            </Col>\n            <Col span=\"12\">\n              <FormItem label=\"\" prop=\"env_name\">\n                <Select\n                  v-model=\"formValidate.env_name\"\n                  filterable\n                  placeholder=\"请选择环境..\"\n                >\n                  <Option\n                    v-for=\"item in envList\"\n                    :value=\"item\"\n                    :key=\"item\"\n                    :label=\"item\"\n                  ></Option>\n                </Select>\n              </FormItem>\n            </Col>\n            <Col span=\"24\">\n              <FormItem label=\"集群名称\" prop=\"region_name\">\n                <Input\n                  v-model=\"formValidate.region_name\"\n                  :maxlength=\"500\"\n                  placeholder=\"输入集群、区服名称，多个以半角逗号或者空格区分\"\n                ></Input>\n              </FormItem>\n            </Col>\n            <!-- <Col span=\"24\">\n              <FormItem label=\"集群名称\" prop=\"region_name\">\n                <Select\n                  v-model=\"formValidate.region_name\"\n                  filterable\n                  multiple\n                  placeholder=\"请选择集群...\"\n                >\n                  <Option\n                    v-for=\"item in regionList\"\n                    :key=\"item.id\"\n                    :value=\"item.value\"\n                    :label=\"item.value\"\n                  />\n                </Select>\n              </FormItem>\n            </Col> -->\n            <Col span=\"24\">\n              <FormItem label=\"模块名称\" prop=\"module_name\">\n                <Input\n                  v-model=\"formValidate.module_name\"\n                  :maxlength=\"500\"\n                  placeholder=\"输入模块、服务名称，多个以半角逗号或者空格区分\"\n                ></Input>\n              </FormItem>\n            </Col>\n          </Row>\n        </template>\n\n        <FormItem label=\"堡垒机组织\" prop=\"jms_org_id\">\n          <Select\n            v-model=\"formValidate.jms_org_id\"\n            filterable\n            placeholder=\"请选择组织\"\n          >\n            <Option\n              v-for=\"item in jmsOrgs\"\n              :key=\"item.id\"\n              :value=\"item.id\"\n              :label=\"item.name\"\n            />\n          </Select>\n        </FormItem>\n\n        <Col span=\"24\">\n          <FormItem label=\"权限开始时间\" prop=\"perm_start_time\">\n          <Row>\n              <DatePicker type=\"datetime\" placeholder=\"开始时间\" v-model=\"formValidate.perm_start_time\"\n                          format=\"yyyy-MM-dd HH:mm:ss\" style=\"width: 700px\" @on-change=\"handleStartDateChange\"></DatePicker>\n          </Row>\n          </FormItem>\n        </Col>\n      <template>\n        <Col span=\"24\">\n          <FormItem label=\"权限结束时间\" prop=\"perm_end_time\">\n            <Row>\n                <DatePicker type=\"datetime\" placeholder=\"结束时间\" v-model=\"formValidate.perm_end_time\"\n                            format=\"yyyy-MM-dd HH:mm:ss\" style=\"width: 700px\" @on-change=\"handleEndDateChange\"></DatePicker>\n            </Row>\n          </FormItem>\n        </Col>\n\n        <FormItem label=\"用户组\" prop=\"user_group\">\n          <Select\n            v-model=\"formValidate.user_group\"\n            filterable\n            placeholder=\"请选择用户组\"\n            multiple\n          >\n            <Option\n              v-for=\"item in roleList\"\n              :key=\"item.id\"\n              :value=\"item.role_name\"\n              :label=\"item.role_name\"\n            />\n          </Select>\n        </FormItem>\n  </template>\n\n        <FormItem label=\"账号类型\" prop=\"perm_type\">\n          <RadioGroup v-model=\"formValidate.perm_type\">\n            <Radio label=\"dev\">普通用户</Radio>\n            <Radio label=\"ops\">特权用户</Radio>\n          </RadioGroup>\n        </FormItem>\n        <FormItem label=\"备注信息\" prop=\"perm_group_detail\">\n          <Input\n            v-model=\"formValidate.perm_group_detail\"\n            type=\"textarea\"\n            :autosize=\"{ minRows: 3, maxRows: 5 }\"\n            placeholder=\"Enter something...\"\n          ></Input>\n        </FormItem>\n        <div class=\"drawer-footer\">\n          <Button\n            style=\"margin-right: 8px\"\n            @click=\"handleCancel('formValidate')\"\n            >取消</Button\n          >\n          <Button type=\"primary\" @click=\"handleSubmit('formValidate')\"\n            >提交</Button\n          >\n        </div>\n      </Form>\n    </Drawer>\n  </div>\n</template>\n\n<script>\nimport { getBizEnv } from '@/api/service-tree';\nimport { getRoleInfoList, getJMSOrgList } from '@/api/cmdb';\n\nexport default {\n  name: 'permGroupEdit',\n  props: {\n    modalData: {\n      type: Object,\n      default: {},\n    },\n    bizList: {\n      type: Object | Array,\n      default: [],\n    },\n  },\n  data() {\n    return {\n      index: 1,\n      btnLoading: false,\n      envList: [],\n      roleList: [],\n      regionList: [],\n      jmsOrgs: [],\n      jmssAccounts: [],\n      formValidate: {\n        user_group: [],\n        biz_id: null,\n        // env_name: null,\n        // perm_group_name: '',\n        // perm_group_type: '',\n      },\n      ruleValidate: {\n        perm_group_name: [\n          { required: true, message: '分组名称不能为空', trigger: 'blur' },\n        ],\n        perm_type: [\n          { required: true, message: '请选择角色类型', trigger: 'blur' },\n        ],\n        jms_org_id: [\n          {required: true, message: '请选择堡垒机组织', trigger: 'blur'}\n        ],\n        perm_start_time: [\n          {required: true, message: '请选择堡垒机授权开始时间', trigger: 'blur'}\n        ],\n        perm_end_time: [\n          {required: true, message: '请选择堡垒机授权结束时间', trigger: 'blur'},\n          { validator: this.validateEndTime, trigger: 'blur' }\n        ],\n        user_group: [\n          {\n            required: true,\n            message: '请选择用户组',\n            trigger: 'blur',\n            type: 'array',\n          },\n        ],\n      },\n    };\n  },\n  watch: {\n    'formValidate.biz_id': {\n      handler(newValue, oldValue) {\n        if (newValue && newValue !== oldValue) {\n          this.handleGetEnv();\n        }\n      },\n      // immediate: true,\n      deep: true,\n    },\n    //   'formValidate.env_name': {\n    //     handler(newValue, oldValue) {\n    //       if (newValue && newValue !== oldValue) {\n    //         this.handleGetSet();\n    //       }\n    //     },\n    //     immediate: true,\n    //     deep: true,\n    //   },\n  },\n  methods: {\n    validateEndTime(rule, value, callback) {\n      if (this.formValidate.perm_end_time && this.formValidate.perm_start_time\n        && new Date(this.formValidate.perm_end_time) <= new Date(this.formValidate.perm_start_time)) {\n        callback(new Error('结束时间必须大于开始时间'));\n      }else {\n        callback()\n      }\n    },\n\n    handleStartDateChange(date) {\n      this.formValidate.perm_start_time = this.formatDate(date);\n    },\n    handleEndDateChange(date) {\n      this.formValidate.perm_end_time = this.formatDate(date);\n    },\n\n    formatDate(date) {\n      if (!date) return '';\n      if (!(date instanceof Date)) {\n        return date;\n      }\n      const d = new Date(date);\n      const year = d.getFullYear();\n      const month = String(d.getMonth() + 1).padStart(2, '0');\n      const day = String(d.getDate()).padStart(2, '0');\n      const hours = String(d.getHours()).padStart(2, '0');\n      const minutes = String(d.getMinutes()).padStart(2, '0');\n      const seconds = String(d.getSeconds()).padStart(2, '0');\n      return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;\n    },\n\n    async handleGetEnv() {\n      const res = await getBizEnv({ biz_id: this.formValidate.biz_id });\n      if (res.code === 0) {\n        this.envList = res.data.env_list;\n      } else {\n        this.$Message.error(res.msg);\n      }\n    },\n    handleCancel(name) {\n      this.$refs[name].resetFields();\n      this.$emit('drawer-close');\n    },\n    handleRoleInfoList() {\n      getRoleInfoList().then((res) => {\n        if (res.code === 0) {\n          this.roleList = res.data;\n        } else {\n          this.$Message.error(`${res.msg}`);\n        }\n      });\n    },\n    handleJmsOrgList() {\n      getJMSOrgList().then((res) => {\n        if (res.code === 0) {\n          this.jmsOrgs = res.data;\n        } else {\n          this.$Message.error(`${res.msg}`);\n        }\n      });\n    },\n    handleChange() {\n      this.formValidate.biz_id = null;\n      this.formValidate.env_name = null;\n    },\n    handleChangeBiz() {\n      this.formValidate.env_name = null;\n      this.regionList = [];\n      this.envList = [];\n      this.formValidate.region_name = null;\n    },\n    async handleSubmit(name) {\n      this.formValidate.perm_start_time = this.formatDate(this.formValidate.perm_start_time)\n      this.formValidate.perm_end_time = this.formatDate(this.formValidate.perm_end_time)\n      // 表单验证\n      const valid = await this.$refs[name].validate();\n      if (!valid) {\n        this.$Notice.error({ title: '表单验证失败' });\n        return;\n      }\n\n      // 验证条件\n      setTimeout(() => {\n        this.$emit('save-data', this.formValidate, this.modalData.action);\n      }, 200);\n    },\n  },\n  //\n  mounted() {\n    this.handleRoleInfoList();\n    this.handleJmsOrgList()\n  },\n  //\n};\n</script>\n<style>\n.drawer-footer {\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  border-top: 1px solid #e8e8e8;\n  padding: 10px 16px;\n  text-align: right;\n  background: #fff;\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./perm-group-edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./perm-group-edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./perm-group-edit.vue?vue&type=template&id=78b7ebae&\"\nimport script from \"./perm-group-edit.vue?vue&type=script&lang=js&\"\nexport * from \"./perm-group-edit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./perm-group-edit.vue?vue&type=style&index=0&id=78b7ebae&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('Card',{attrs:{\"dis-hover\":\"\",\"bordered\":false}},[_c('div',[_c('div',[_c('div',{staticClass:\"search-con search-con-top\"},[_c('Input',{staticClass:\"search-input\",attrs:{\"search\":\"\",\"maxlength\":100,\"placeholder\":\"输入关键字全局搜索\"},on:{\"on-search\":_vm.handleSearch},model:{value:(_vm.initPara.searchVal),callback:function ($$v) {_vm.$set(_vm.initPara, \"searchVal\", $$v)},expression:\"initPara.searchVal\"}}),_c('Button',{staticStyle:{\"margin\":\"3px\"},on:{\"click\":function($event){return _vm.handCreate()}}},[_vm._v(\"添加分组\")])],1),_c('Table',{attrs:{\"size\":\"small\",\"columns\":_vm.columns,\"data\":_vm.tableData},on:{\"on-sort-change\":_vm.handleSort}})],1),_c('div',{staticStyle:{\"margin\":\"10px\",\"overflow\":\"hidden\"}},[_c('div',{staticStyle:{\"float\":\"left\"}},[_c('Page',{attrs:{\"total\":_vm.i.pageTotal,\"current\":_vm.initPara.page_number,\"page-size\":_vm.initPara.page_size,\"show-total\":\"\",\"show-sizer\":\"\",\"page-size-opts\":[15, 50, 100]},on:{\"on-change\":_vm.handlerChangePage,\"on-page-size-change\":_vm.handlePageSize}})],1)])]),(_vm.spinShow)?_c('Spin',{attrs:{\"size\":\"large\",\"fix\":\"\"}},[_c('Icon',{staticClass:\"demo-spin-icon-load\",attrs:{\"type\":\"ios-loading\",\"size\":\"18\"}}),_c('div',[_vm._v(\"加载中，请稍等一会...\")])],1):_vm._e(),_c('preViewHost',{ref:\"previewHost\",attrs:{\"dialog\":_vm.dialog}}),_c('permGroupEdit',{ref:\"dgEdit\",attrs:{\"modal-data\":_vm.modalData,\"biz-list\":_vm.bizList},on:{\"drawer-close\":_vm.handleClose,\"save-data\":_vm.handleSaveData}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Card dis-hover :bordered=\"false\">\n    <div>\n      <div>\n        <div class=\"search-con search-con-top\">\n          <Input\n            class=\"search-input\"\n            v-model=\"initPara.searchVal\"\n            search\n            :maxlength=\"100\"\n            @on-search=\"handleSearch\"\n            placeholder=\"输入关键字全局搜索\"\n          />\n          <Button @click=\"handCreate()\" style=\"margin: 3px\">添加分组</Button>\n        </div>\n        <Table\n          size=\"small\"\n          :columns=\"columns\"\n          :data=\"tableData\"\n          @on-sort-change=\"handleSort\"\n        ></Table>\n      </div>\n      <!-- 分页 -->\n      <div style=\"margin: 10px; overflow: hidden\">\n        <div style=\"float: left\">\n          <Page\n            :total=\"i.pageTotal\"\n            :current=\"initPara.page_number\"\n            :page-size=\"initPara.page_size\"\n            show-total\n            show-sizer\n            :page-size-opts=\"[15, 50, 100]\"\n            @on-change=\"handlerChangePage\"\n            @on-page-size-change=\"handlePageSize\"\n          />\n        </div>\n      </div>\n    </div>\n    <!-- 预览 -->\n    <Spin size=\"large\" fix v-if=\"spinShow\">\n      <Icon type=\"ios-loading\" size=\"18\" class=\"demo-spin-icon-load\"></Icon>\n      <div>加载中，请稍等一会...</div>\n    </Spin>\n\n    <preViewHost ref=\"previewHost\" :dialog=\"dialog\"></preViewHost>\n\n    <permGroupEdit\n      ref=\"dgEdit\"\n      :modal-data=\"modalData\"\n      :biz-list=\"bizList\"\n      @drawer-close=\"handleClose\"\n      @save-data=\"handleSaveData\"\n    ></permGroupEdit>\n  </Card>\n</template>\n\n<script>\nimport 'vue-json-pretty/lib/styles.css';\n\nimport {\n  getPermGrouplist,\n  optPermGroup,\n  preViewPermGroupHost,\n  SyncPermGroup,\n} from '@/api/cmdb/perm-group';\nimport { getBusinesslist } from '@/api/cmdb';\nimport preViewHost from './components/preview-host';\nimport permGroupEdit from './components/perm-group-edit.vue';\n\nexport default {\n  components: {\n    preViewHost,\n    permGroupEdit,\n  },\n  data() {\n    return {\n      modalData: {\n        show: false,\n        title: '添加动态分组',\n        id: null,\n        action: 'post',\n      },\n      dialog: {\n        show: false,\n        title: '预览主机',\n      },\n      tableData: [],\n      columns: [\n        {\n          title: 'UID',\n          key: 'exec_uuid',\n          minWidth: 200,\n          maxWidth: 300,\n        },\n        {\n          title: '分组名称',\n          key: 'perm_group_name',\n          align: 'center',\n          tooltip: true,\n          sortable: true,\n          minWidth: 200,\n        },\n        {\n          title: '权限类型',\n          key: 'perm_type',\n          align: 'center',\n          sortable: true,\n          minWidth: 40,\n        },\n        {\n          title: '用户组',\n          key: 'user_group',\n          align: 'center',\n          sortable: true,\n          minWidth: 100,\n          render: (h, params) => {\n            return h('span', params.row.user_group.join(','));\n          },\n        },\n        {\n          title: '业务',\n          key: 'biz_id',\n          align: 'center',\n          sortable: true,\n          minWidth: 100,\n          render: (h, params) => {\n            let biz_id = params.row.biz_id;\n            return h('p', this.bizMap[biz_id]);\n          },\n        },\n        {\n          title: '修改人',\n          key: 'modify_user',\n          align: 'center',\n          width: 180,\n        },\n        {\n          title: '更新时间',\n          key: 'update_time',\n          sortable: true,\n          width: 180,\n        },\n        {\n          title: '操作',\n          key: 'handle',\n          width: 180,\n          render: (h, params) => {\n            return h('div', [\n              h(\n                'a',\n                {\n                  style: {\n                    marginRight: '10px',\n                  },\n                  on: {\n                    click: () => {\n                      this.handlePreview(params.row);\n                    },\n                  },\n                },\n                '预览'\n              ),\n              h(\n                'a',\n                {\n                  style: {\n                    marginRight: '10px',\n                  },\n                  on: {\n                    click: () => {\n                      this.handleEdit(params.row);\n                    },\n                  },\n                },\n                '编辑'\n              ),\n              h(\n                'a',\n                {\n                  style: {\n                    marginRight: '10px',\n                  },\n                  on: {\n                    click: () => {\n                      this.SyncPerm(params.row);\n                    },\n                  },\n                },\n                '同步'\n              ),\n              h(\n                'a',\n                {\n                  style: {\n                    color: 'red',\n                    marginRight: '10px',\n                  },\n                  on: {\n                    click: () => {\n                      this.handleDel(params.row);\n                    },\n                  },\n                },\n                '删除'\n              ),\n            ]);\n          },\n        },\n      ],\n      bizList: [],\n      bizMap: {},\n      initPara: {\n        page_number: 1,\n        page_size: 15,\n        searchVal: null,\n        order_by: 'update_time', //排序字段\n        order: 'descend', //排序 ascend descend\n      },\n      i: {\n        pageTotal: 0, //总数\n        tableLoading: true,\n      },\n      initForm: {\n        biz_id: '501',\n        perm_group_name: null,\n        perm_type: '',\n        perm_group_detail: '',\n        perm_start_time: new Date(),\n        jms_org_id: \"00000000-0000-0000-0000-000000000002\",\n      },\n      spinShow: false,\n      // serverList: [{ name: \"test\" }],\n    };\n  },\n  methods: {\n    // 获取动态分组列表\n    async handleGetData() {\n      const res = await getPermGrouplist(this.initPara);\n      if (res.code == 0) {\n        this.tableData = res.data;\n        this.i.pageTotal = res.count;\n      } else {\n        this.$Message.error(res.msg);\n      }\n      this.i.tableLoading = false;\n    },\n    async handleGetBizList() {\n      const res = await getBusinesslist();\n      this.bizList = res.data;\n      this.bizList.forEach((ele) => {\n        this.bizMap[ele.biz_id] = ele.biz_cn_name;\n      });\n    },\n    handleClose() {\n      this.modalData.show = false;\n      this.handleGetData();\n    },\n    //创建分组\n    handCreate() {\n      // this.initForm.perm_group_name = null;\n      // this.initForm.perm_group_detail = null;\n      // this.theData = Object.assign(this.$options.data().theData, this.initForm)\n      this.modalData = {\n        show: true,\n        action: 'post',\n        title: '添加权限分组',\n      };\n      this.$refs.dgEdit.formValidate = this.initForm;\n    },\n    handleEdit(paramsRow) {\n      this.modalData = {\n        show: true,\n        action: 'put',\n        title: '编辑权限分组',\n      };\n      this.$refs.dgEdit.formValidate = this.rowToConfig(paramsRow);\n      // this.$refs.dgEdit.handleGetEnv()\n    },\n    // 获取配置,编辑\n    rowToConfig(row, id = row.id) {\n      // let dynamic_group_dict = row.dynamic_group_rules;\n      return {\n        ...row,\n        id: id,\n        // dynamic_group_rules: dynamic_group_dict['items'], // 因为存数据库的时候是个JSON\n      };\n    },\n    // 保存数据\n    async handleSaveData(saveData, action) {\n      console.info(saveData, action);\n      const res = await optPermGroup(saveData, action);\n      if (res.code === 0) {\n        this.$Notice.success({ title: `${res.msg}` });\n        this.handleClose();\n      } else {\n        this.$Notice.error({\n          title: '发生错误',\n          desc: `${res.msg}`,\n        });\n      }\n    },\n    // 保存数据\n    async SyncPerm(saveData, action) {\n      console.info(saveData, action)\n      const body = {\n        id: saveData.id,\n      };\n      const res = await SyncPermGroup(body, \"post\");\n      if (res.code === 0) {\n        this.$Notice.success({ title: `${res.msg}` });\n        this.handleClose();\n      } else {\n        this.$Notice.error({\n          title: '发生错误',\n          desc: `${res.msg}`,\n        });\n      }\n    },\n    // 删除分组\n    handleDel(paramsRow) {\n      this.$Modal.confirm({\n        title: '确认删除',\n        content: '您确认要删除分组 ' + paramsRow.perm_group_name + ' ?',\n        // loading: true,\n        onOk: () => {\n          optPermGroup({ id_list: [paramsRow.id] }, 'delete').then((res) => {\n            if (res.code === 0) {\n              this.$Notice.success({ title: `${res.msg}` });\n              this.handleClose();\n            } else {\n              this.$Notice.error({ title: `${res.msg}` });\n            }\n          });\n        },\n        onCancel: () => {\n          this.$Message.info('回头是岸~');\n        },\n      });\n    },\n\n    // 预览动态分组主机\n    async handlePreview(paramsRow) {\n      // groupPreview\n      this.spinShow = true;\n\n      try {\n        let res = await preViewPermGroupHost(paramsRow.exec_uuid);\n\n        if (res.code !== 0) {\n          this.$Message.error(`${res.msg}`);\n          return;\n        }\n        this.$refs.previewHost.serverList = res.data;\n        this.$refs.previewHost.setCurrentPageData();\n        this.dialog.show = true;\n      } catch (e) {\n        this.$Message.error(e.toString());\n      } finally {\n        this.spinShow = false;\n      }\n    },\n    handleSearch() {\n      this.initPara.page_number = 1;\n      this.handleGetData();\n    },\n    // 排序\n    handleSort(column, key, order) {\n      this.initPara.order = column.order === 'asc' ? 'ascend' : 'descend';\n      this.initPara.order_by = column.key;\n      this.handleGetData();\n    },\n    // 分页\n    handlerChangePage(value) {\n      this.initPara.page_number = value;\n      this.handleGetData();\n    },\n    handlePageSize(value) {\n      this.initPara.page_number = 1;\n      this.initPara.page_size = value;\n      this.handleGetData();\n    },\n  },\n  created() {\n    this.handleGetBizList();\n  },\n  mounted() {\n    this.handleGetData();\n  },\n};\n</script>\n<style>\n.drawer-footer {\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  border-top: 1px solid #e8e8e8;\n  padding: 10px 16px;\n  text-align: right;\n  background: #fff;\n}\n</style>\n\n<style lang=\"less\" scoped>\n.search-con {\n  padding: 10px 0;\n\n  .search {\n    &-col {\n      display: inline-block;\n      width: 200px;\n    }\n    &-input {\n      display: inline-block;\n      width: 400px;\n      margin-left: 2px;\n    }\n    &-btn {\n      margin-left: 10px;\n    }\n  }\n}\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./perm-group.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./perm-group.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./perm-group.vue?vue&type=template&id=31659650&scoped=true&\"\nimport script from \"./perm-group.vue?vue&type=script&lang=js&\"\nexport * from \"./perm-group.vue?vue&type=script&lang=js&\"\nimport style0 from \"./perm-group.vue?vue&type=style&index=0&id=31659650&prod&lang=css&\"\nimport style1 from \"./perm-group.vue?vue&type=style&index=1&id=31659650&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"31659650\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./perm-group.vue?vue&type=style&index=1&id=31659650&prod&lang=less&scoped=true&\""],"sourceRoot":""}