{"version":3,"sources":["webpack://cmdb-[name]/./src/views/cmdb/biz/components/dynamic-group-edit.vue","webpack://cmdb-[name]/src/views/cmdb/biz/components/dynamic-group-edit.vue","webpack://cmdb-[name]/./src/views/cmdb/biz/components/dynamic-group-edit.vue?021b","webpack://cmdb-[name]/./src/views/cmdb/biz/components/dynamic-group-edit.vue?6d53","webpack://cmdb-[name]/./src/api/service-tree.js","webpack://cmdb-[name]/./src/views/cmdb/biz/components/dynamic-group-edit.vue?b264"],"names":["render","_vm","this","_c","_self","attrs","modalData","title","model","value","show","callback","$$v","$set","expression","ref","staticStyle","formValidate","ruleValidate","dynamic_group_name","on","handleChange","dynamic_group_type","_v","biz_id","_l","bizList","item","key","biz_cn_name","dynamic_group_rules","index","status","query_name","query_conditions","query_value","$event","handleRemove","_e","handleAdd","slot","handleChangeBiz","env_name","envList","region_name","module_name","minRows","maxRows","dynamic_group_detail","staticClass","handleCancel","handleSubmit","staticRenderFns","name","props","type","Object","default","Array","data","btnLoading","required","message","trigger","methods","res","getBizEnv","code","env_list","$Message","error","msg","$emit","$Notice","warning","push","valid","$refs","validate","_index","setTimeout","action","watch","handler","newValue","oldValue","handleGetEnv","deep","mounted","component","postTreeAsset","request","url","method","getTreeAsset","params","changeTreeAssetStatus","deleteTreeAsset","getRelation","getServiceTreelist","operationTree"],"mappings":"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","file":"static/js/chunk-cea5e674.a831d2ea.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('Drawer',{attrs:{\"title\":_vm.modalData.title,\"width\":\"800\",\"draggable\":\"\",\"mask-closable\":false},model:{value:(_vm.modalData.show),callback:function ($$v) {_vm.$set(_vm.modalData, \"show\", $$v)},expression:\"modalData.show\"}},[_c('Form',{ref:\"formValidate\",staticStyle:{\"width\":\"750px\"},attrs:{\"model\":_vm.formValidate,\"rules\":_vm.ruleValidate,\"label-width\":90}},[_c('FormItem',{staticStyle:{\"padding-top\":\"10px\"},attrs:{\"label\":\"分组名称\",\"prop\":\"dynamic_group_name\"}},[_c('Input',{attrs:{\"maxlength\":50,\"placeholder\":\"请输入分组名称\"},model:{value:(_vm.formValidate.dynamic_group_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"dynamic_group_name\", $$v)},expression:\"formValidate.dynamic_group_name\"}})],1),_c('FormItem',{attrs:{\"label\":\"分组类型\",\"prop\":\"dynamic_group_type\"}},[_c('RadioGroup',{on:{\"on-change\":_vm.handleChange},model:{value:(_vm.formValidate.dynamic_group_type),callback:function ($$v) {_vm.$set(_vm.formValidate, \"dynamic_group_type\", $$v)},expression:\"formValidate.dynamic_group_type\"}},[_c('Radio',{attrs:{\"label\":\"normal\"}},[_vm._v(\"通用类型\")]),_c('Radio',{attrs:{\"label\":\"biz\"}},[_vm._v(\"业务类型\")])],1)],1),(_vm.formValidate.dynamic_group_type == 'normal')?[_c('FormItem',{attrs:{\"label\":\"选择业务\",\"prop\":\"biz_id\"}},[_c('Select',{attrs:{\"disabled\":\"\",\"placeholder\":\"请选择业务...\"},model:{value:(_vm.formValidate.biz_id),callback:function ($$v) {_vm.$set(_vm.formValidate, \"biz_id\", $$v)},expression:\"formValidate.biz_id\"}},_vm._l((_vm.bizList),function(item){return _c('Option',{key:item.biz_id,attrs:{\"value\":item.biz_id,\"label\":item.biz_cn_name}})}),1)],1),_vm._l((_vm.formValidate.dynamic_group_rules),function(item,index){return [(item.status)?_c('FormItem',{key:index,attrs:{\"label\":\"查询条件\",\"prop\":'dynamic_group_rules.' + index + '.value'}},[_c('Row',[_c('Col',{attrs:{\"span\":\"20\"}},[_c('Select',{staticStyle:{\"max-width\":\"110px\"},attrs:{\"placeholder\":\"选择名称\"},model:{value:(item.query_name),callback:function ($$v) {_vm.$set(item, \"query_name\", $$v)},expression:\"item.query_name\"}},[_c('Option',{attrs:{\"value\":\"name\"}},[_vm._v(\"资源名称\")]),_c('Option',{attrs:{\"value\":\"cloud_name\"}},[_vm._v(\"云厂商\")]),_c('Option',{attrs:{\"value\":\"inner_ip\"}},[_vm._v(\"内网IP\")]),_c('Option',{attrs:{\"value\":\"region\"}},[_vm._v(\"地域\")]),_c('Option',{attrs:{\"value\":\"state\"}},[_vm._v(\"运行状态\")])],1),_c('Select',{staticStyle:{\"margin-right\":\"1px\",\"margin-left\":\"1px\",\"max-width\":\"70px\"},attrs:{\"placeholder\":\"选择条件\"},model:{value:(item.query_conditions),callback:function ($$v) {_vm.$set(item, \"query_conditions\", $$v)},expression:\"item.query_conditions\"}},[_c('Option',{attrs:{\"value\":\"like\"}},[_vm._v(\"包含\")]),_c('Option',{attrs:{\"value\":\"=\"}},[_vm._v(\"等于\")]),_c('Option',{attrs:{\"value\":\"!=\"}},[_vm._v(\"不等于\")])],1),_c('Input',{staticStyle:{\"max-width\":\"350px\"},attrs:{\"placeholder\":\"\"},model:{value:(item.query_value),callback:function ($$v) {_vm.$set(item, \"query_value\", $$v)},expression:\"item.query_value\"}})],1),_c('Col',{attrs:{\"span\":\"3\"}},[_c('Icon',{attrs:{\"type\":\"md-trash\"},on:{\"click\":function($event){return _vm.handleRemove(index)}}})],1)],1)],1):_vm._e()]}),_c('FormItem',[_c('Row',[_c('Col',{attrs:{\"span\":\"18\"}},[_c('Tooltip',{attrs:{\"trigger\":\"hover\",\"placement\":\"top-start\",\"content\":\"多条件是or的关系\"}},[_c('Button',{attrs:{\"type\":\"dashed\",\"long\":\"\",\"icon\":\"md-add\"},on:{\"click\":_vm.handleAdd}},[_vm._v(\"添加条件\")])],1)],1)],1)],1)]:[_c('Row',{attrs:{\"gutter\":5}},[_c('FormItem',[_c('Alert',{attrs:{\"type\":\"success\",\"show-icon\":\"\",\"closable\":\"\"}},[_vm._v(\" 根据业务拓扑信息创建动态分组 \"),_c('template',{slot:\"desc\"},[_c('p',[_vm._v(\"下列条件的关系为且 业务为必填项，集群和模块为可以输入多个，以半角逗号或者空格来分隔。\")]),_c('p',[_vm._v(\"当前类型查询条件不支持通配符，全部为精确查询。\")])])],2)],1),_c('Col',{attrs:{\"span\":\"12\"}},[_c('FormItem',{attrs:{\"label\":\"选择业务\",\"prop\":\"biz_id\"}},[_c('Select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择业务...\"},on:{\"on-change\":_vm.handleChangeBiz},model:{value:(_vm.formValidate.biz_id),callback:function ($$v) {_vm.$set(_vm.formValidate, \"biz_id\", $$v)},expression:\"formValidate.biz_id\"}},_vm._l((_vm.bizList),function(item){return _c('Option',{key:item.biz_id,attrs:{\"value\":item.biz_id,\"label\":item.biz_cn_name}})}),1)],1)],1),_c('Col',{attrs:{\"span\":\"12\"}},[_c('FormItem',{attrs:{\"label\":\"\",\"prop\":\"env_name\"}},[_c('Select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择环境..\"},model:{value:(_vm.formValidate.env_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"env_name\", $$v)},expression:\"formValidate.env_name\"}},_vm._l((_vm.envList),function(item){return _c('Option',{key:item,attrs:{\"value\":item,\"label\":item}})}),1)],1)],1),_c('Col',{attrs:{\"span\":\"24\"}},[_c('FormItem',{attrs:{\"label\":\"集群名称\",\"prop\":\"region_name\"}},[_c('Input',{attrs:{\"maxlength\":500,\"placeholder\":\"输入集群、区服名称，多个以半角逗号或者空格区分\"},model:{value:(_vm.formValidate.region_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"region_name\", $$v)},expression:\"formValidate.region_name\"}})],1)],1),_c('Col',{attrs:{\"span\":\"24\"}},[_c('FormItem',{attrs:{\"label\":\"模块名称\",\"prop\":\"module_name\"}},[_c('Input',{attrs:{\"maxlength\":500,\"placeholder\":\"输入模块、服务名称，多个以半角逗号或者空格区分\"},model:{value:(_vm.formValidate.module_name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"module_name\", $$v)},expression:\"formValidate.module_name\"}})],1)],1)],1)],_c('FormItem',{attrs:{\"label\":\"备注信息\",\"prop\":\"dynamic_group_detail\"}},[_c('Input',{attrs:{\"type\":\"textarea\",\"autosize\":{minRows: 3,maxRows: 5},\"placeholder\":\"Enter something...\"},model:{value:(_vm.formValidate.dynamic_group_detail),callback:function ($$v) {_vm.$set(_vm.formValidate, \"dynamic_group_detail\", $$v)},expression:\"formValidate.dynamic_group_detail\"}})],1),_c('div',{staticClass:\"drawer-footer\"},[_c('Button',{staticStyle:{\"margin-right\":\"8px\"},on:{\"click\":_vm.handleCancel}},[_vm._v(\"取消\")]),_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.handleSubmit('formValidate')}}},[_vm._v(\"提交\")])],1)],2)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div >\n      <Drawer :title=\"modalData.title\" v-model=\"modalData.show\" width=\"800\"  draggable :mask-closable='false'>\n      <Form ref=\"formValidate\" :model=\"formValidate\" :rules=\"ruleValidate\" :label-width=\"90\" style=\"width: 750px\" >\n\n        <FormItem label=\"分组名称\" prop=\"dynamic_group_name\" style=\"padding-top: 10px\">\n          <Input v-model=\"formValidate.dynamic_group_name\" :maxlength=\"50\" placeholder=\"请输入分组名称\"></Input>\n        </FormItem>\n\n        <FormItem label=\"分组类型\"  prop=\"dynamic_group_type\">\n          <RadioGroup v-model=\"formValidate.dynamic_group_type\" @on-change=\"handleChange\">\n              <Radio label=\"normal\">通用类型</Radio>\n              <Radio label=\"biz\">业务类型</Radio>\n          </RadioGroup>\n        </FormItem>\n\n        <template v-if=\"formValidate.dynamic_group_type == 'normal'\">\n          <FormItem label=\"选择业务\" prop=\"biz_id\" >\n            <Select v-model=\"formValidate.biz_id\"  disabled placeholder=\"请选择业务...\" >\n              <Option v-for=\"item in bizList\" :key=\"item.biz_id\" :value=\"item.biz_id\" :label=\"item.biz_cn_name\" />\n            </Select>\n          </FormItem>\n\n          <template v-for=\"(item, index) in formValidate.dynamic_group_rules\">\n          <FormItem  v-if=\"item.status\" :key=\"index\" label=\"查询条件\" :prop=\"'dynamic_group_rules.' + index + '.value'\">\n            <Row>\n              <Col span=\"20\">\n              <Select v-model=\"item.query_name\" placeholder=\"选择名称\" style=\"max-width: 110px\">\n                <Option value=\"name\">资源名称</Option>\n                <Option value=\"cloud_name\">云厂商</Option>\n                <Option value=\"inner_ip\">内网IP</Option>\n                <Option value=\"region\">地域</Option>\n                <Option value=\"state\">运行状态</Option>\n              </Select>\n              <Select v-model=\"item.query_conditions\" placeholder=\"选择条件\" style=\"margin-right: 1px;margin-left: 1px; max-width: 70px\">\n                <Option value=\"like\">包含</Option>\n                <Option value=\"=\">等于</Option>\n                <Option value=\"!=\">不等于</Option>\n              </Select>\n              <Input style=\"max-width: 350px\" v-model=\"item.query_value\" placeholder=\"\"></Input>\n              </Col>\n              <Col span=\"3\">\n              <Icon v-on:click=\"handleRemove(index)\" type=\"md-trash\" />\n              </Col>\n            </Row>\n          </FormItem>\n          </template>\n          <FormItem>\n            <Row>\n              <Col span=\"18\">\n              <Tooltip trigger=\"hover\" placement=\"top-start\" content=\"多条件是or的关系\">\n                <Button type=\"dashed\" long @click=\"handleAdd\" icon=\"md-add\">添加条件</Button>\n              </Tooltip>\n              </Col>\n            </Row>\n          </FormItem>\n        </template>\n\n        <template v-else>\n          <Row :gutter=\"5\">\n            <FormItem >\n              <Alert type=\"success\" show-icon closable>\n                  根据业务拓扑信息创建动态分组\n                  <template slot=\"desc\">\n                    <p>下列条件的关系为且 业务为必填项，集群和模块为可以输入多个，以半角逗号或者空格来分隔。</p>\n                    <p>当前类型查询条件不支持通配符，全部为精确查询。</p>\n                  </template>\n              </Alert>\n            </FormItem>\n            <Col span=\"12\">\n              <FormItem label=\"选择业务\" prop=\"biz_id\" >\n                <Select v-model=\"formValidate.biz_id\"  filterable placeholder=\"请选择业务...\" @on-change=\"handleChangeBiz\">\n                  <Option v-for=\"item in bizList\" :key=\"item.biz_id\" :value=\"item.biz_id\" :label=\"item.biz_cn_name\" />\n                </Select>\n              </FormItem>\n            </Col>\n            <Col span=\"12\">\n              <FormItem label=\"\"  prop=\"env_name\" >\n                  <Select v-model=\"formValidate.env_name\" filterable placeholder=\"请选择环境..\">\n                    <Option v-for=\"item in envList\" :value=\"item\" :key=\"item\" :label=\"item\"></Option>\n                  </Select>\n              </FormItem>\n            </Col>\n            <Col span=\"24\">\n              <FormItem label=\"集群名称\"  prop=\"region_name\" >\n                  <Input v-model=\"formValidate.region_name\" :maxlength=\"500\" placeholder=\"输入集群、区服名称，多个以半角逗号或者空格区分\"></Input>\n              </FormItem>\n            </Col>\n            <Col span=\"24\">\n              <FormItem label=\"模块名称\"  prop=\"module_name\" >\n                  <Input v-model=\"formValidate.module_name\" :maxlength=\"500\" placeholder=\"输入模块、服务名称，多个以半角逗号或者空格区分\"></Input>\n              </FormItem>\n            </Col>\n          </Row>\n        </template>\n\n        <FormItem label=\"备注信息\" prop=\"dynamic_group_detail\">\n           <Input v-model=\"formValidate.dynamic_group_detail\" type=\"textarea\" :autosize=\"{minRows: 3,maxRows: 5}\" placeholder=\"Enter something...\"></Input>\n        </FormItem>\n        <div class=\"drawer-footer\">\n          <Button style=\"margin-right: 8px\" @click=\"handleCancel\">取消</Button>\n          <Button type=\"primary\" @click=\"handleSubmit('formValidate')\">提交</Button>\n        </div>\n      </Form>\n    </Drawer>\n  </div>\n</template>\n\n<script>\nimport { getBizEnv } from '@/api/service-tree'\nexport default {\n  name: 'dynamicGroupEdit',\n  props: {\n    modalData: {\n        type :Object,\n        default: {}\n    },\n    bizList: {\n        type :Object | Array,\n        default: []\n    },\n  },\n  data () {\n    return {\n      index: 1,\n      btnLoading: false,\n      envList: [],\n      formValidate: { },\n      ruleValidate: {\n        dynamic_group_name: [{ required: true, message: '动态分组名称不能为空', trigger: 'blur' }],\n        dynamic_group_type: [{ required: true, message: '请选择动态分组类型', trigger: 'change' }],\n        biz_id: [{ required: true, message: '业务类型的业务为必须', trigger: 'change' }],\n      }\n    }\n  },\n  methods: {\n    async handleGetEnv() {\n      const res = await getBizEnv({biz_id: this.formValidate.biz_id});\n      if (res.code == 0) {\n        this.envList = res.data.env_list\n      } else {\n        this.$Message.error(res.msg)\n      }\n    },\n    handleCancel () {\n      this.$emit('drawer-close')\n    },\n    handleChange () {\n      if (this.formValidate.dynamic_group_type == 'normal') {\n        this.formValidate.biz_id = '501'\n      } else {\n        this.formValidate.biz_id = null\n        this.formValidate.env_name = null\n      }\n    },\n    handleChangeBiz () {\n      this.formValidate.env_name = null\n    },\n    // 添加条件\n    handleAdd () {\n      this.index++;\n      if (this.index > 6) {\n        this.$Notice.warning({\n          title: \"条件超出最大限制\",\n        });\n        return;\n      }\n      // 条件默认配置\n      this.formValidate.dynamic_group_rules.push({\n        query_name: \"name\",\n        query_conditions: \"like\",\n        query_value: \"\",\n        index: this.index,\n        status: 1,\n      });\n    },\n        // 移除条件\n    handleRemove(index) {\n      this.index--;\n      this.formValidate.dynamic_group_rules[index].status = 0;\n    },\n    async handleSubmit (name) {\n      // 表单验证\n      const valid = await this.$refs[name].validate();\n      if (!valid) {\n        this.$Notice.error({ title: \"表单验证失败\" });\n        return;\n      }\n\n      // 验证条件\n       if (this.formValidate.dynamic_group_type == 'normal') {\n          for (var _index in this.formValidate.dynamic_group_rules) {\n            let query_value =\n            this.formValidate.dynamic_group_rules[_index][\"query_value\"];\n            let status = this.formValidate.dynamic_group_rules[_index][\"status\"];\n            if (status === 1) {\n              if (query_value === \"\" || !query_value) {\n                this.$Notice.warning({ title: \"查询条件存在空值！\" });\n                return;\n              }\n            }\n          }\n       } else {\n        \n       }\n\n      setTimeout(() => {\n        this.$emit('save-data', this.formValidate, this.modalData.action)\n      }, 200)\n    },\n  },\n  //\n  watch: {\n    // formData (value) {\n    //   this.formValidate = JSON.parse(JSON.stringify(value))\n    // },\n    'formValidate.biz_id': {\n      handler (newValue, oldValue) {\n        if (newValue && newValue != oldValue ) {\n             this.handleGetEnv()\n        }\n      },\n        deep: true\n      }\n  },\n  //\n  mounted () {\n  }\n  //\n}\n</script>\n<style>\n.drawer-footer {\n  width: 100%;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  border-top: 1px solid #e8e8e8;\n  padding: 10px 16px;\n  text-align: right;\n  background: #fff;\n}\n</style>","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./dynamic-group-edit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./dynamic-group-edit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./dynamic-group-edit.vue?vue&type=template&id=81f3775e&\"\nimport script from \"./dynamic-group-edit.vue?vue&type=script&lang=js&\"\nexport * from \"./dynamic-group-edit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./dynamic-group-edit.vue?vue&type=style&index=0&id=81f3775e&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import request from '@/plugins/axios'\n\n//  服务树\nexport const postTreeAsset = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'post',\n  data,\n})\n// 获取树资产\nexport const getTreeAsset = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'get',\n  params,\n})\n\n// 更改资产状态\nexport const changeTreeAssetStatus = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'patch',\n  data,\n})\n\nexport const deleteTreeAsset = (/** @type {any} */ data) => request({\n  url: '/api/v2/cmdb/tree/asset/',\n  method: 'delete',\n  data,\n})\n\n// 主机关系\nexport const getRelation = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/asset/relation/',\n  method: 'get',\n  params,\n})\n\n// 业务Tree\nexport const getServiceTreelist = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/',\n  method: 'get',\n  params,\n})\n\nexport const operationTree = (/** @type {any} */ data, /** @type {any} */ method) => request({\n  url: '/api/v2/cmdb/tree/',\n  method,\n  data,\n})\n\n\nexport const getBizEnv = (/** @type {any} */ params) => request({\n  url: '/api/v2/cmdb/tree/env/',\n  method: 'get',\n  params,\n})","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./dynamic-group-edit.vue?vue&type=style&index=0&id=81f3775e&prod&lang=css&\""],"sourceRoot":""}