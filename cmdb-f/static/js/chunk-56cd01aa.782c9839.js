(window["webpackJsonp_cmdb"]=window["webpackJsonp_cmdb"]||[]).push([["chunk-56cd01aa","chunk-2d0c8c03"],{"4d42":function(e,t,_){"use strict";_("93a7")},"55e2":function(e,t,_){"use strict";_.r(t),_.d(t,"getSecurityGroup",(function(){return a})),_.d(t,"optSecurityGroup",(function(){return s})),_.d(t,"getSecurityGroupRefs",(function(){return i}));var n=_("be3b");const a=e=>Object(n["default"])({url:"/api/v2/cmdb/security_group/",method:"get",params:e}),s=(e,t)=>Object(n["default"])({url:"/api/v2/cmdb/security_group/",method:t,data:e}),i=e=>Object(n["default"])({url:"/api/v2/cmdb/security_group/refs/",method:"get",params:e})},"75ac":function(e,t,_){"use strict";_.r(t);var n=function(){var e=this,t=e._self._c;return t("Drawer",{attrs:{title:e.templateInfo.name,width:"1000"},on:{"on-close":e.onClose},model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}},[t("div",{staticClass:"drawer__content"},[t("div",{staticClass:"drawer__content__section"},[t("div",{staticClass:"drawer__content__section__header"},[t("div",{staticClass:"drawer__content__section__header__title"},[e._v("基本信息")]),e.editBasicInfo?e._e():t("div",{staticClass:"drawer__content__section__header__icon",on:{click:function(t){e.editBasicInfo=!0}}},[t("Icon",{attrs:{type:"md-create"}}),t("span",{staticClass:"drawer__content__section__header__icon__text"},[e._v("编辑")])],1)]),e.editBasicInfo?t("div",{staticClass:"drawer__content__section__form"},[t("Form",{ref:"basicForm",attrs:{model:e.templateInfo,"label-width":100,rules:e.formRules}},[t("div",{staticClass:"modal__content__section__form"},[t("div",{staticClass:"modal__content__section__form__custom"},[t("FormItem",{attrs:{prop:"name",label:"模板名称"}},[t("Input",{attrs:{type:"text",placeholder:"请输入模板名称"},model:{value:e.templateInfo.name,callback:function(t){e.$set(e.templateInfo,"name",t)},expression:"templateInfo.name"}})],1)],1),t("div",{staticClass:"modal__content__section__form__select"},[t("FormItem",{attrs:{prop:"res_type",label:"模板类型"}},[t("Select",{attrs:{type:"text",placeholder:"请选择模板类型"},model:{value:e.templateInfo.res_type,callback:function(t){e.$set(e.templateInfo,"res_type",t)},expression:"templateInfo.res_type"}},e._l(e.resTypeOptions,(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"subnet_id",label:"私有子网"}},[t("Select",{attrs:{filterable:"",placeholder:"请选择私有子网"},on:{"on-change":e.handleInstanceChange},model:{value:e.templateInfo.subnet_id,callback:function(t){e.$set(e.templateInfo,"subnet_id",t)},expression:"templateInfo.subnet_id"}},e._l(e.vswitchOptions,(function(_){return t("Option",{key:_.id,attrs:{value:_.instance_id}},[e._v(e._s(_.label))])})),1)],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"vpc_name",label:"私有网络"}},[t("Input",{attrs:{type:"text",disabled:""},model:{value:e.templateInfo.vpc_name,callback:function(t){e.$set(e.templateInfo,"vpc_name",t)},expression:"templateInfo.vpc_name"}})],1)],1),t("div",{staticClass:"modal__content__section__form__select"},[t("FormItem",{attrs:{prop:"cloud_region_id",label:"云区域"}},[t("Input",{attrs:{type:"text",disabled:"",placeholder:""},model:{value:e.templateInfo.cloud_region_id,callback:function(t){e.$set(e.templateInfo,"cloud_region_id",t)},expression:"templateInfo.cloud_region_id"}})],1)],1),t("div",{staticClass:"modal__content__section__form__select"},[t("FormItem",{attrs:{prop:"cloundAccountRender",label:"云厂商"}},[t("Input",{attrs:{type:"text",disabled:"",placeholder:""},model:{value:e.templateInfo.cloundAccountRender,callback:function(t){e.$set(e.templateInfo,"cloundAccountRender",t)},expression:"templateInfo.cloundAccountRender"}})],1)],1),t("div",{staticClass:"modal__content__section__form__select"},[t("FormItem",{attrs:{prop:"region",label:"地域"}},[t("Input",{attrs:{type:"text",disabled:"",placeholder:""},model:{value:e.templateInfo.region,callback:function(t){e.$set(e.templateInfo,"region",t)},expression:"templateInfo.region"}})],1)],1),t("div",{staticClass:"modal__content__section__form__select"},[t("FormItem",{attrs:{prop:"zone",label:"可用区"}},[t("Input",{attrs:{type:"text",disabled:"",placeholder:""},model:{value:e.templateInfo.zone,callback:function(t){e.$set(e.templateInfo,"zone",t)},expression:"templateInfo.zone"}})],1)],1)])])],1):t("div",{staticClass:"drawer__content__section__info"},[t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("模板名称")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.name))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("模板类型")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.resTypeRender))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("私有子网")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.subnet_name))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("私有网络")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.vpc_name))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("云区域")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.cloud_region_id))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("云厂商")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.cloundAccountRender))])])])]),t("div",{staticClass:"drawer__content__box"},[t("div",{staticClass:"drawer__content__section"},[t("div",{staticClass:"drawer__content__section__header"},[t("div",{staticClass:"drawer__content__section__header__title"},[e._v("实例配置")]),e.editModelInfo?e._e():t("div",{staticClass:"drawer__content__section__header__icon",on:{click:e.handleEditModelInfo}},[t("Icon",{attrs:{type:"md-create"}}),t("span",{staticClass:"drawer__content__section__header__icon__text"},[e._v("编辑")])],1)]),e.editModelInfo?t("div",{staticClass:"drawer__content__section__form"},[t("Form",{ref:"resTypeForm",attrs:{model:e.templateInfo,"label-width":100,rules:e.formRules}},[t("div",{staticClass:"modal__content__section__form"},[t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"image_id",label:"镜像"}},[t("Select",{attrs:{disabled:!e.templateInfo.subnet_id,filterable:"",clearable:"",placeholder:e.templateInfo.subnet_id?"请搜索":"请先选择私有子网",loading:e.imageIdLoading},model:{value:e.templateInfo.image_id,callback:function(t){e.$set(e.templateInfo,"image_id",t)},expression:"templateInfo.image_id"}},e._l(e.imageIdOptions,(function(_,n){return t("Option",{key:n,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"instance_charge_type",label:"实例计费模式"}},[t("Select",{attrs:{placeholder:"请选择"},model:{value:e.templateInfo.instance_charge_type,callback:function(t){e.$set(e.templateInfo,"instance_charge_type",t)},expression:"templateInfo.instance_charge_type"}},e._l(e.instanceChargeTypeOptions,(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("div",{staticClass:"modal__content__section__form__special"},[t("div",{staticClass:"modal__content__section__form__special__label"},[e._v(" 实例配置 "),t("Tooltip",{attrs:{placement:"top-start"}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("div",[e._v("填写基础配置及实例类型后自动查询回填")])]),t("Icon",{staticStyle:{"margin-left":"5px"},attrs:{type:"ios-help-circle-outline"}})],1)],1),t("FormItem",{attrs:{prop:"cpu"}},[t("Input",{attrs:{type:"text",placeholder:"CPU",disabled:""},model:{value:e.templateInfo.cpu,callback:function(t){e.$set(e.templateInfo,"cpu",t)},expression:"templateInfo.cpu"}}),t("span",{staticClass:"modal__content__section__form__special__unit"},[e._v("核")])],1),t("FormItem",{attrs:{prop:"memory"}},[t("Input",{attrs:{type:"text",placeholder:"内存",disabled:""},model:{value:e.templateInfo.memory,callback:function(t){e.$set(e.templateInfo,"memory",t)},expression:"templateInfo.memory"}}),t("span",{staticClass:"modal__content__section__form__special__unit"},[e._v("GB")])],1)],1)]),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"instance_type",label:"实例类型"}},[t("Input",{attrs:{type:"text",placeholder:"请输入实例类型"},model:{value:e.templateInfo.instance_type,callback:function(t){e.$set(e.templateInfo,"instance_type",t)},expression:"templateInfo.instance_type"}})],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"system_disk_type",label:"系统盘类型"}},[t("Select",{attrs:{placeholder:"请选择"},model:{value:e.templateInfo.system_disk_type,callback:function(t){e.$set(e.templateInfo,"system_disk_type",t)},expression:"templateInfo.system_disk_type"}},e._l(e.systemDiskTypeOptions,(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"system_disk_size",label:"系统盘大小"}},[t("Input",{attrs:{type:"number",placeholder:"请输入"},model:{value:e.templateInfo.system_disk_size,callback:function(t){e.$set(e.templateInfo,"system_disk_size",t)},expression:"templateInfo.system_disk_size"}},[t("div",{staticClass:"modal__content__section__form__int__unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("G")])])],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"data_disk_type",label:"数据盘类型"}},[t("Select",{attrs:{placeholder:"请选择"},model:{value:e.templateInfo.data_disk_type,callback:function(t){e.$set(e.templateInfo,"data_disk_type",t)},expression:"templateInfo.data_disk_type"}},e._l(e.dataDiskTypeOptions,(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"data_disk_size",label:"数据盘大小"}},[t("Input",{attrs:{type:"number",placeholder:"请输入"},model:{value:e.templateInfo.data_disk_size,callback:function(t){e.$set(e.templateInfo,"data_disk_size",t)},expression:"templateInfo.data_disk_size"}},[t("div",{staticClass:"modal__content__section__form__int__unit",attrs:{slot:"suffix"},slot:"suffix"},[e._v("G")])])],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"internet_charge_type",label:"网络计费模式"}},[t("Select",{attrs:{placeholder:"请选择"},model:{value:e.templateInfo.internet_charge_type,callback:function(t){e.$set(e.templateInfo,"internet_charge_type",t)},expression:"templateInfo.internet_charge_type"}},e._l(e.internetChargeTypeOptions,(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"max_flow_out",label:"带宽限制"}},[t("InputNumber",{attrs:{max:2e3,min:1},model:{value:e.templateInfo.max_flow_out,callback:function(t){e.$set(e.templateInfo,"max_flow_out",t)},expression:"templateInfo.max_flow_out"}})],1)],1),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"securityGroupsValues",label:"安全组"}},[t("Select",{attrs:{filterable:"",placeholder:"请选择",multiple:""},model:{value:e.templateInfo.securityGroupsValues,callback:function(t){e.$set(e.templateInfo,"securityGroupsValues",t)},expression:"templateInfo.securityGroupsValues"}},e._l(e.securityGroupOptions,(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1)],1)])])],1):t("div",{staticClass:"drawer__content__section__info"},[t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("镜像")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.image_name))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("实例计费模式")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.instanceChargeTypeRender))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("CPU")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.cpu))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("内存")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.memory))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("实例类型")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.instance_type))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("系统盘类型")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.systemDiskTypeRender))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("系统盘大小")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.system_disk_size))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("数据盘类型")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.dataDiskTypeRender))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("数据盘大小")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.data_disk.size))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("私有IP")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.inner_ip))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("网络计费模式")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.internetChargeTypeRender))])]),"BANDWIDTH_PACKAGE"==e.templateInfo.internetChargeTypeRender?[t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("带宽包")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.bandwidth_pkg_id))])])]:e._e(),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("带宽限制")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.max_flow_out))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("安全组")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.renderSecurityGroups))])])],2)]),t("div",{staticClass:"drawer__content__section"},[t("div",{staticClass:"drawer__content__section__header"},[t("div",{staticClass:"drawer__content__section__header__title"},[e._v("其他设置")]),e.editOtherInfo?e._e():t("div",{staticClass:"drawer__content__section__header__icon",on:{click:function(t){e.editOtherInfo=!0}}},[t("Icon",{attrs:{type:"md-create"}}),t("span",{staticClass:"drawer__content__section__header__icon__text"},[e._v("编辑")])],1)]),e.editOtherInfo?t("div",[t("Form",{ref:"otherForm",attrs:{model:e.templateInfo,"label-width":100,rules:e.formRules}},[t("div",{staticClass:"modal__content__section__form"},[t("div",{staticClass:"modal__content__section__form__tags"},[t("div",{staticClass:"modal__content__section__form__tags__label"},[e._v("标签")]),t("div",{staticClass:"modal__content__section__form__tags__content"},e._l(e.templateInfo.tagsValues,(function(_,n){return t("div",{key:n,staticClass:"modal__content__section__form__tags__content__line"},[t("FormItem",{attrs:{prop:"tagsValues."+n+".key",rules:{required:!0,message:"标签键不能为空",trigger:"blur"}}},[t("Select",{attrs:{filterable:""},on:{"on-select":e.handleSelectTag},model:{value:_.key,callback:function(t){e.$set(_,"key",t)},expression:"item.key"}},e._l(e.tagKeyOptions,(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1),t("FormItem",{attrs:{prop:"tagsValues."+n+".value",rules:{required:!0,message:"标签值不能为空",trigger:"blur"}}},[t("Select",{attrs:{filterable:"",loading:void 0===e.tagValueOptions[_.key],disabled:""===_.key,placeholder:""===_.key?"请先选择标签键":"请选择"},model:{value:_.value,callback:function(t){e.$set(_,"value",t)},expression:"item.value"}},e._l(e.tagValueOptions[_.key],(function(_){return t("Option",{key:_.value,attrs:{value:_.value}},[e._v(e._s(_.label))])})),1)],1),n===e.templateInfo.tagsValues.length-1?t("Icon",{attrs:{size:"20",type:"md-add"},on:{click:e.handleAddTag}}):e._e(),e.templateInfo.tagsValues.length>1?t("Icon",{attrs:{size:"20",type:"md-close"},on:{click:function(t){return e.handleRemoveTag(n)}}}):e._e()],1)})),0)]),t("div",{staticClass:"modal__content__section__form__longer"},[t("FormItem",{attrs:{prop:"description",label:"备注"}},[t("Input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:e.templateInfo.description,callback:function(t){e.$set(e.templateInfo,"description",t)},expression:"templateInfo.description"}})],1)],1)])])],1):t("div",{staticClass:"drawer__content__section__info"},[t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("标签")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.renderTags))])]),t("div",{staticClass:"drawer__content__section__info__line"},[t("div",{staticClass:"drawer__content__section__info__line__label"},[e._v("备注")]),t("div",{staticClass:"drawer__content__section__info__line__value"},[e._v(e._s(e.templateInfo.description))])])])])])]),e.editBasicInfo||e.editModelInfo||e.editOtherInfo?t("div",{staticClass:"drawer__footer"},[t("Button",{attrs:{type:"primary"},on:{click:e.handleUpdate}},[e._v("确认修改")])],1):e._e()])},a=[],s=(_("d9e2"),_("14d9"),_("2ef0")),i=_("30b3"),o=_("a743"),l=_("55e2"),r=_("3261"),c=_("7063");const d=300,p=1e3;var m={name:"EditTemplate",props:{show:{type:Boolean,default:!1},row:{type:Object,default:()=>({})}},data(){return{imageIdOptions:[],imageIdLoading:!1,specialSplit:"",editBasicInfo:!1,editModelInfo:!1,editOtherInfo:!1,vswitchOptions:[],securityGroupOptions:[],tagKeyOptions:[],resTypeOptions:c["resTypeOptions"],dataDiskTypeOptions:c["dataDiskTypeOptions"],systemDiskTypeOptions:c["systemDiskTypeOptions"],instanceChargeTypeOptions:c["instanceChargeTypeOptions"],internetChargeTypeOptions:c["internetChargeTypeOptions"],tagValueOptions:{},templateInfo:{cloud_region_id:"",cloud_region_name:"",account_id:"",name:"",res_type:"",vendor:"",region:"",zone:"",image_id:"",cpu:"",memory:"",instance_type:"",system_disk_size:"",system_disk_type:"",security_groups:{},renderSecurityGroups:"",tags:{},tagsValues:[{key:"",value:""}],renderTags:"",vpc_id:"",vpc_name:"",subnet_id:"",subnet_name:"",max_flow_out:1,image_passwd:"",instance_charge_type:"",internet_charge_type:"",description:"",data_disk_type:"",data_disk_size:"",data_disk:{size:"",type:""},is_eip:"",inner_ip:"",bandwidth_pkg_id:"",cloundAccountRender:"",resTypeRender:"",instanceChargeTypeRender:"",systemDiskTypeRender:"",dataDiskTypeRender:"",internetChargeTypeRender:"",securityGroupsValues:""},formRules:{name:[{required:!0,message:"模板名称必填",trigger:"blur"}],res_type:[{required:!0,message:"模板类型必选",trigger:"blur"}],subnet_id:[{required:!0,message:"私有子网必选",trigger:"change"}],cloud_region_id:[{required:!0,message:"云区域不能为空",trigger:"blur"}],cloundAccountRender:[{required:!0,message:"云厂商不能为空",trigger:"blur"}],vpc_name:[{required:!0,message:"私有网络不能为空",trigger:"blur"}],region:[{required:!0,message:"地域不能为空",trigger:"blur"}],zone:[{required:!0,message:"可用区不能为空",trigger:"blur"}],image_id:[{required:!0,message:"镜像必填",trigger:"blur"}],instance_charge_type:[{required:!0,message:"实例计费模式必填",trigger:"blur"}],cpu:[{required:!0,validator:(e,t,_)=>{t?_():_(new Error("cpu必填"))},trigger:"blur"}],memory:[{required:!0,validator:(e,t,_)=>{t?_():_(new Error("内存必填"))},trigger:"blur"}],instance_type:[{required:!0,message:"实例类型必填",trigger:"blur"}],system_disk_type:[{required:!0,message:"系统盘类型必填",trigger:"blur"}],system_disk_size:[{required:!0,validator:(e,t,_)=>{t?_():_(new Error("系统盘大小必填"))},trigger:"blur"}],internet_charge_type:[{required:!0,message:"网络计费模式必填",trigger:"blur"}],max_flow_out:[{required:!0,validator:(e,t,_)=>{t?_():_(new Error("带宽限制必填"))},trigger:"blur"}],securityGroupsValues:[{required:!0,validator:(e,t,_)=>{t&&0!==t.length?_():_(new Error("安全组必填"))},trigger:"blur"}],tags:[{required:!0,message:"标签必填",trigger:"blur"}]},showDrawer:!1}},computed:{insTypeParams(){const{account_id:e,vendor:t,res_type:_,region:n,zone:a,instance_type:s}=this.templateInfo;return{account_id:e,vendor:t,res_type:_,region:n,zone:a,instance_type:s,isEdit:this.editModelInfo}}},watch:{show(e){e&&this.getSettings(),this.showDrawer=e},row(e){this.editBasicInfo=!1,this.editModelInfo=!1,this.editOtherInfo=!1,this.templateInfo=Object(r["getFeFormInfo"])(e,this)},insTypeParams:{async handler(e){const{account_id:t,vendor:_,res_type:n,region:a,zone:s,instance_type:i,isEdit:o}=e;t&&_&&n&&a&&s&&i&&o&&this.getInsTypeOptions()},deep:!0}},mounted(){this.specialSplit=Object(r["getUniqueStr"])(3)},methods:{handleEditModelInfo(){this.editModelInfo=!0,this.getSecurityGroupData({filter_map:{region:this.templateInfo.region,cloud_name:this.templateInfo.vendor}}),this.getImageIdOptions({filter_map:{region:this.templateInfo.region,cloud_name:this.templateInfo.vendor}})},getInsTypeOptions:Object(s["debounce"])((async function(){try{const{account_id:e,vendor:t,res_type:_,region:n,zone:a,instance_type:s}=this.templateInfo,{data:o}=await Object(i["getInsType"])({account_id:e,vendor:t,res_type:_,region:n,zone:a,instance_type:s});this.templateInfo.cpu=o.cpu,this.templateInfo.memory=o.memory}catch(e){this.templateInfo.cpu="",this.templateInfo.memory=""}}),p),getImageIdOptions:Object(s["debounce"])((async function(e){try{this.imageIdLoading=!0;const{data:t}=await Object(i["getImageIds"])(e);this.imageIdOptions=t.map(e=>({label:`${e.instance_id} | ${e.name} | ${e.os_name}`,value:e.instance_id}))}catch(t){this.imageIdOptions=[]}finally{this.imageIdLoading=!1}}),d),tipFormat(e){return e+"Mbps"},async handleUpdate(){try{const e=new Promise((e,t)=>{this.editBasicInfo?this.$refs.basicForm.validate(_=>{_||t(new Error("表单校验失败，请检查")),e()}):e()}),t=new Promise((e,t)=>{this.editModelInfo?this.$refs.resTypeForm.validate(_=>{_||t(new Error("表单校验失败，请检查")),e()}):e()}),_=new Promise((e,t)=>{this.editOtherInfo?this.$refs.otherForm.validate(_=>{_||t(new Error("表单校验失败，请检查")),e()}):e()});await Promise.all([e,t,_]);const n=Object(r["getParams"])(this.templateInfo,this),a=await Object(i["modifyOrderTemplate"])({id:this.templateInfo.id,...n});if(!a)throw new Error("请求错误，请重试");this.$emit("editSuccessCallback"),this.showDrawer=!1,this.$Message.success(a.msg)}catch(e){console.log(e),this.$Message.error(e.message)}},handleInstanceChange(e){const t=this.vswitchOptions.find(t=>t.instance_id===e);this.templateInfo={...this.templateInfo,subnet_name:`${t.instance_id} | ${t.name} | ${t.cidr_block_v4}`,vendor:t.cloud_name,account_id:t.account_id,cloundAccountRender:`${t.account_id} | ${t.cloud_name}`,vpc_id:t.vpc_id,vpc_name:`${t.vpc_id} | ${t.vpc_name}`,cloud_region_id:t.cloud_region_id,cloudRender:""+t.cloud_region_id,region:t.region,zone:t.zone},this.getSecurityGroupData({filter_map:{region:t.region,cloud_name:t.cloud_name}}),this.getImageIdOptions({filter_map:{region:t.region,cloud_name:t.cloud_name}})},async getSettings(){this.getVswitchData(),this.getTagData()},async getVswitchData(){const{data:e}=await Object(o["getVswitch"])();this.vswitchOptions=e.map(e=>({...e,label:`${e.instance_id} | ${e.name} | ${e.cidr_block_v4}`}))},async getSecurityGroupData(e){const{data:t}=await Object(l["getSecurityGroup"])(e);this.securityGroupOptions=t.map(e=>({...e,label:`${e.instance_id} | ${e.security_group_name}`,value:`${e.instance_id}${this.specialSplit}${e.security_group_name}`}))},async getTagData(){const{data:e}=await Object(i["getTagList"])();this.tagKeyOptions=e.map(e=>({label:e,value:e}))},async handleSelectTag(e){const{data:t}=await Object(i["getTagList"])({tag_key:e.value});this.$set(this.tagValueOptions,e.value,t.map(e=>({label:e,value:e})))},handleAddTag(){this.templateInfo.tagsValues.push({key:"",value:""})},handleRemoveTag(e){this.templateInfo.tagsValues=this.templateInfo.tagsValues.filter((t,_)=>_!==e)},onClose(){this.showDrawer=!1,this.$emit("closeDrawer")}}},u=m,f=(_("4d42"),_("2877")),v=Object(f["a"])(u,n,a,!1,null,"1c2fc41e",null);t["default"]=v.exports},"93a7":function(e,t,_){}}]);
//# sourceMappingURL=chunk-56cd01aa.782c9839.js.map