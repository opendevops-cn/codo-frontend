(window["webpackJsonp_cmdb"]=window["webpackJsonp_cmdb"]||[]).push([["chunk-3b107d00","chunk-2d22a11c","chunk-2d0de8d7","chunk-2d0d5fe1","chunk-2d213107","chunk-2d0ae8c9"],{"0b12":function(e,t,a){"use strict";a.r(t),a.d(t,"postTreeAsset",(function(){return r})),a.d(t,"getTreeAsset",(function(){return i})),a.d(t,"changeTreeAssetStatus",(function(){return o})),a.d(t,"deleteTreeAsset",(function(){return n})),a.d(t,"getRelation",(function(){return d})),a.d(t,"getServiceTreelist",(function(){return l})),a.d(t,"operationTree",(function(){return u})),a.d(t,"getBizEnv",(function(){return c})),a.d(t,"getTreeModule",(function(){return m}));var s=a("be3b");const r=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/asset/",method:"post",data:e}),i=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/asset/",method:"get",params:e}),o=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/asset/",method:"patch",data:e}),n=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/asset/",method:"delete",data:e}),d=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/asset/relation/",method:"get",params:e}),l=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/",method:"get",params:e}),u=(e,t)=>Object(s["default"])({url:"/api/v2/cmdb/tree/",method:t,data:e}),c=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/env/",method:"get",params:e}),m=e=>Object(s["default"])({url:"/api/v2/cmdb/tree/module/",method:"get",params:e})},"713d":function(e,t,a){"use strict";a.r(t),a.d(t,"getRedisList",(function(){return r})),a.d(t,"optrationRedis",(function(){return i}));var s=a("be3b");const r=e=>Object(s["default"])({url:"/api/v2/cmdb/redis/",method:"get",params:e}),i=(e,t)=>Object(s["default"])({url:"/api/v2/cmdb/redis/",method:t,data:e})},"85ae":function(e,t,a){"use strict";a.r(t),a.d(t,"getMySQLList",(function(){return r})),a.d(t,"optrationMysQL",(function(){return i}));var s=a("be3b");const r=e=>Object(s["default"])({url:"/api/v2/cmdb/mysql/",method:"get",params:e}),i=(e,t)=>Object(s["default"])({url:"/api/v2/cmdb/mysql/",method:t,data:e})},aaa2:function(e,t,a){"use strict";a.r(t),a.d(t,"getServerList",(function(){return r})),a.d(t,"optServer",(function(){return i})),a.d(t,"optBatchServer",(function(){return o})),a.d(t,"getUserField",(function(){return n})),a.d(t,"optrationUserField",(function(){return d}));var s=a("be3b");const r=e=>Object(s["default"])({url:"/api/v2/cmdb/server/",method:"get",params:e}),i=(e,t)=>Object(s["default"])({url:"/api/v2/cmdb/server/",method:t,data:e}),o=(e,t)=>Object(s["default"])({url:"/api/v2/cmdb/server/batch/",method:t,data:e}),n=e=>Object(s["default"])({url:"/api/v2/cmdb/user_field/",method:"get",params:e}),d=e=>Object(s["default"])({url:"/api/v2/cmdb/user_field/",method:"put",data:e})},dfae:function(e,t,a){"use strict";a.r(t),a.d(t,"deleteLB",(function(){return r})),a.d(t,"getLBList",(function(){return i}));var s=a("be3b");const r=e=>Object(s["default"])({url:"/api/v2/cmdb/lb/",method:"delete",data:e}),i=e=>Object(s["default"])({url:"/api/v2/cmdb/lb/",method:"get",params:e})},f22a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("Modal",{attrs:{title:e.dialog.title,"footer-hide":!0,width:"850","mask-closable":!1},model:{value:e.modalMap.show,callback:function(t){e.$set(e.modalMap,"show",t)},expression:"modalMap.show"}},[t("Form",{ref:"formValidate",attrs:{model:e.formValidate,"label-width":95}},[t("FormItem",{attrs:{label:"当前节点"}},[t("span",[e._v("/"+e._s(e.theBusinessName)+"/"+e._s(e.formValidate.env_name)+"//"+e._s(e.formValidate.region_name)+"/"+e._s(e.formValidate.module_name))])]),t("FormItem",{attrs:{label:"添加方式"}},[t("span",[e._v("基础资源")])]),t("FormItem",{attrs:{label:"选择资源"}},[t("Select",{attrs:{filterable:"",multiple:""},model:{value:e.formValidate.asset_ids,callback:function(t){e.$set(e.formValidate,"asset_ids",t)},expression:"formValidate.asset_ids"}},e._l(e.assetList,(function(a){return t("Option",{key:a.id,attrs:{value:a.id}},[e._v(e._s(a.name)+" - "+e._s(a.inner_ip))])})),1)],1),2===e.nodeType?t("FormItem",{attrs:{label:"选择模块"}},[t("Select",{attrs:{filterable:"",multiple:""},model:{value:e.formValidate.module_list,callback:function(t){e.$set(e.formValidate,"module_list",t)},expression:"formValidate.module_list"}},e._l(e.moduleList,(function(e){return t("Option",{key:e.id,attrs:{value:e.title,label:e.title}})})),1)],1):e._e(),t("FormItem",{attrs:{label:"是否启用"}},[t("i-switch",{attrs:{size:"large"},model:{value:e.formValidate.is_enable,callback:function(t){e.$set(e.formValidate,"is_enable",t)},expression:"formValidate.is_enable"}},[t("span",{attrs:{slot:"open"},slot:"open"},[e._v("开启")]),t("span",{attrs:{slot:"close"},slot:"close"},[e._v("关闭")])])],1),t("FormItem",{attrs:{label:"扩展字段"}},[t("vue-json-editor",{attrs:{"show-btns":!1,mode:"code",lang:"zh"},on:{"json-change":e.onJsonChange,"json-save":e.onJsonSave,"has-error":e.onError},model:{value:e.formValidate.ext_info,callback:function(t){e.$set(e.formValidate,"ext_info",t)},expression:"formValidate.ext_info"}})],1),t("FormItem",{staticStyle:{"text-align":"right"}},[t("Button",{attrs:{type:"primary",loading:e.isLoading},on:{click:function(t){return e.handleSubmit("formValidate")}}},[e._v("Submit")])],1)],1)],1)],1)},r=[],i=a("aaa2"),o=a("713d"),n=a("85ae"),d=a("dfae"),l=a("0b12"),u=a("45a3"),c={name:"AssetAdd",components:{vueJsonEditor:u["a"]},props:{dialog:{default(){return{}},type:Object},form:{default(){return{}},type:Object}},data(){return{jsonErrFlag:!1,theBusinessName:"",assetList:[],moduleList:[],nodeType:3,isLoading:!1}},computed:{formValidate(){return this.form},modalMap(){return this.dialog}},methods:{async getAssetData(){if("server"===this.formValidate.asset_type){const e=await Object(i["getServerList"])({page_number:1,page_size:999999});this.assetList=e.data}else if("mysql"===this.formValidate.asset_type){const e=await Object(n["getMySQLList"])({page_number:1,page_size:999999});this.assetList=e.data}else if("redis"===this.formValidate.asset_type){const e=await Object(o["getRedisList"])({page_number:1,page_size:999999});this.assetList=e.data}else if("lb"===this.formValidate.asset_type){const e=await Object(d["getLBList"])({page_number:1,page_size:999999});this.assetList=e.data}},async handleGetTreeModule(e){let t={node_type:e,biz_id:this.formValidate.biz_id,env_name:this.formValidate.env_name,region_name:this.formValidate.region_name};const a=await Object(l["getTreeModule"])(t);this.moduleList=a.data},async handleSubmit(){try{this.isLoading=!0,this.formValidate["node_type"]=this.nodeType;const e=await Object(l["postTreeAsset"])(this.formValidate);this.$Message.success(e.msg)}finally{this.isLoading=!1,this.$emit("e-close"),this.$emit("e-update")}},handleRefresh(e){console.log("调了hanleRefresh",e),this.nodeType=e,this.theBusinessName=localStorage.getItem("selectBusinessName"),this.getAssetData(),2===e?this.handleGetTreeModule(e):this.moduleList=[]},onJsonChange(e){console.log("更改了--\x3e",e),this.jsonErrFlag=!1},onJsonSave(e){console.log("保存了---\x3e",e)},onError(e){console.log("报错了---\x3e",e),this.jsonErrFlag=!0}}},m=c,f=a("2877"),b=Object(f["a"])(m,s,r,!1,null,null,null);t["default"]=b.exports}}]);
//# sourceMappingURL=chunk-3b107d00.06768a8c.js.map