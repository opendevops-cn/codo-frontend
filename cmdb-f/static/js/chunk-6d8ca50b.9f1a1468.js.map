{"version":3,"sources":["webpack://cmdb-[name]/./src/views/cmdb/resource/orderList/orderList.vue","webpack://cmdb-[name]/src/views/cmdb/resource/orderList/orderList.vue","webpack://cmdb-[name]/./src/views/cmdb/resource/orderList/orderList.vue?09e0","webpack://cmdb-[name]/./src/views/cmdb/resource/orderList/orderList.vue?04dc","webpack://cmdb-[name]/./src/views/cmdb/resource/orderList/orderList.vue?4579"],"names":["render","_vm","this","_c","_self","staticClass","attrs","model","value","searchParams","searchVal","callback","$$v","$set","expression","on","getTableData","_v","ref","columns","tableData","staticStyle","pageTotal","page_number","page_size","changePage","handlePageSize","deleteModalLoading","deleteModalOk","deleteModalCancel","showDeleteModal","showModal","buyRow","closeAddModal","addSuccessCallback","staticRenderFns","getStatusColor","status","QUERY_POLLING_TIME","components","AddTemplateModal","data","timer","curRow","tableLoading","title","key","width","h","params","style","color","cursor","click","window","open","row","flow_id","minWidth","props","status_alias","type","size","order_by","order","mounted","beforeDestroy","clearTimeout","methods","id","res","deleteOrderInfo","id_list","Error","$Message","success","msg","err","error","message","$nextTick","count","getOrderInfoList","setTimeout","val","component"],"mappings":"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","file":"static/js/chunk-6d8ca50b.9f1a1468.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"orders__header\"},[_c('Input',{staticClass:\"orders__header__input\",attrs:{\"placeholder\":\"请输入搜索内容\"},model:{value:(_vm.searchParams.searchVal),callback:function ($$v) {_vm.$set(_vm.searchParams, \"searchVal\", $$v)},expression:\"searchParams.searchVal\"}}),_c('Button',{staticClass:\"orders__header__button\",on:{\"click\":_vm.getTableData}},[_vm._v(\"搜索\")])],1),_c('Table',{ref:\"selection\",attrs:{\"stripe\":\"\",\"size\":\"small\",\"columns\":_vm.columns,\"data\":_vm.tableData}}),_c('div',{staticStyle:{\"display\":\"flex\",\"justify-content\":\"flex-end\",\"margin-top\":\"10px\",\"overflow\":\"hidden\"}},[_c('Page',{attrs:{\"total\":_vm.pageTotal,\"current\":_vm.searchParams.page_number,\"page-size\":_vm.searchParams.page_size,\"page-size-opts\":[12, 35, 50, 100],\"show-sizer\":\"\",\"show-total\":\"\"},on:{\"on-change\":_vm.changePage,\"on-page-size-change\":_vm.handlePageSize}})],1),_c('Modal',{attrs:{\"title\":\"删除采购记录\",\"width\":520,\"loading\":_vm.deleteModalLoading},on:{\"on-ok\":_vm.deleteModalOk,\"on-cancel\":_vm.deleteModalCancel},model:{value:(_vm.showDeleteModal),callback:function ($$v) {_vm.showDeleteModal=$$v},expression:\"showDeleteModal\"}},[_c('div',[_vm._v(\" 确认删除采购记录吗？ \")])]),_c('AddTemplateModal',{attrs:{\"show\":_vm.showModal,\"buyRow\":_vm.buyRow},on:{\"closeAddModal\":_vm.closeAddModal,\"addSuccessCallback\":_vm.addSuccessCallback}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!-- eslint-disable vue/attribute-hyphenation -->\n<template>\n  <div>\n    <div class=\"orders__header\">\n      <Input v-model=\"searchParams.searchVal\" class=\"orders__header__input\" placeholder=\"请输入搜索内容\" />\n      <Button class=\"orders__header__button\" @click=\"getTableData\">搜索</Button>\n    </div>\n    <Table ref=\"selection\" stripe size=\"small\" :columns=\"columns\" :data=\"tableData\" />\n    <!-- 分页 -->\n    <div style=\"display: flex; justify-content: flex-end; margin-top: 10px; overflow: hidden\">\n      <Page\n        :total=\"pageTotal\"\n        :current=\"searchParams.page_number\"\n        :page-size=\"searchParams.page_size\"\n        :page-size-opts=\"[12, 35, 50, 100]\"\n        show-sizer\n        show-total\n        @on-change=\"changePage\"\n        @on-page-size-change=\"handlePageSize\" />\n    </div>\n\n    <!-- 删除采购记录 -->\n    <Modal\n      v-model=\"showDeleteModal\"\n      title=\"删除采购记录\"\n      :width=\"520\"\n      :loading=\"deleteModalLoading\"\n      @on-ok=\"deleteModalOk\"\n      @on-cancel=\"deleteModalCancel\">\n      <div>\n        确认删除采购记录吗？\n      </div>\n    </Modal>\n\n    <!-- 复购 -->\n    <AddTemplateModal :show=\"showModal\" :buyRow=\"buyRow\" @closeAddModal=\"closeAddModal\" @addSuccessCallback=\"addSuccessCallback\" />\n  </div>\n</template>\n\n<script>\n\nimport {\n  getOrderInfoList,\n  deleteOrderInfo,\n} from \"@/api/cmdb\"\n\nimport AddTemplateModal from \"../templateManagement/addTemplate.vue\"\n\nconst getStatusColor = (status) => {\n  switch (status) {\n  case \"0\":\n    return \"#FF9900\"\n  case \"1\":\n    return \"#19BE6B\"\n  default:\n    return \"#ED4014\"\n  }\n}\n\nconst QUERY_POLLING_TIME = 5000\n\nexport default {\n  components: {\n    AddTemplateModal,\n  },\n  data() {\n    return {\n      buyRow: null,\n      showModal: false,\n      timer: null,\n      curRow: {},\n      showDeleteModal: false,\n      deleteModalLoading: true,\n      pageTotal: 0,\n      tableLoading: false,\n      columns: [{\n        title: \"ID\",\n        key: \"id\",\n        width: 100,\n      }, {\n        title: \"任务ID\",\n        key: \"flow_id\",\n        width: 120,\n        render: (h, params) => h(\"div\", [\n          h(\"div\", {\n            style: {\n              color: \"#2d8cf0\",\n              cursor: \"pointer\",\n            },\n            on: {\n              click: () => {\n                window.open(`https://flow.huanle.com/#/orderCenter/order-list?order_id=${params.row.flow_id}`)\n              },\n            },\n          }, params.row.flow_id),\n        ]),\n      }, {\n        title: \"名称\",\n        key: \"instance_name\",\n        width: 220,\n      }, {\n        title: \"模板\",\n        key: \"name\",\n        minWidth: 200,\n      },{\n        title: \"资源\",\n        key: \"res_type_alias\",\n        minWidth: 120,\n      }, {\n        title: \"厂商\",\n        key: \"vendor_alias\",\n        width: 160,\n      }, {\n        title: \"状态\",\n        key: \"status_alias\",\n        width: 160,\n        render: (h, params) => h(\"div\", [\n          h(\"Tag\", {\n            props: {\n              color: getStatusColor(params.row.status),\n            },\n            style: {\n              // \"font-weight\": \"bold\",\n            },\n          }, params.row.status_alias),\n        ]),\n      }, {\n        title: \"开始时间\",\n        key: \"create_time\",\n        width: 240,\n      }, {\n        title: \"结束时间\",\n        key: \"update_time\",\n        width: 240,\n      }, {\n        title: \"操作\",\n        render: (h, params) => h(\"div\", [\n          h(\"Button\", {\n            props: {\n              type: \"text\",\n              size: \"small\",\n            },\n            style: {\n              color: \"#2d8cf0\",\n            },\n            on: {\n              click: () => {\n                this.buyRow = params.row.data\n                this.showModal = true\n              },\n            },\n          }, \"复购\"),\n          // h(\"Button\", {\n          //   props: {\n          //     type: \"text\",\n          //     size: \"small\",\n          //   },\n          //   on: {\n          //     click: () => {\n          //       this.curRow = params.row\n          //       this.showDeleteModal = true\n          //     },\n          //   },\n          // }, \"删除\"),\n        ]),\n        width: 120,\n      }],\n      tableData: [],\n      searchParams: {\n        page_number: 1,\n        page_size: 12,\n        order_by: \"id\",\n        order: \"descend\",\n        searchVal: \"\",\n      },\n    }\n  },\n  mounted() {\n    this.getTableData()\n  },\n  beforeDestroy() {\n    clearTimeout(this.timer)\n  },\n  methods: {\n    addSuccessCallback() {\n      this.showModal = false\n      this.getTableData()\n    },\n    closeAddModal() {\n      this.showModal = false\n    },\n    async deleteModalOk() {\n      try {\n        const {\n          id,\n        } = this.curRow\n        const res = await deleteOrderInfo({\n          id_list: [id],\n        })\n        if (!res) {\n          throw new Error(\"请求错误，请重试\")\n        }\n        this.showDeleteModal = false\n        this.$Message.success(res.msg)\n        this.getTableData()\n      } catch (err) {\n        this.$Message.error(err.message)\n        this.deleteModalLoading = false\n      } finally {\n        this.$nextTick(() => {\n          this.deleteModalLoading = true\n        })\n      }\n    },\n    deleteModalCancel() {\n      this.showDeleteModal = false\n    },\n    async getTableData() {\n      try {\n        this.tableLoading = true\n        const { data, count } = await getOrderInfoList(this.searchParams)\n        this.pageTotal = count\n        this.tableData = data\n      } catch (err) {\n        this.$Message.error(err.message)\n      } finally {\n        this.tableLoading = false\n        clearTimeout(this.timer)\n        this.timer = setTimeout(() => {\n          this.getTableData()\n        }, QUERY_POLLING_TIME)\n      }\n    },\n    // 每页条数\n    handlePageSize(val) {\n      this.searchParams.page_size = val\n      this.getTableData()\n    },\n    // 切换分页\n    changePage(val) {\n      this.searchParams.page_number = val\n      this.getTableData()\n    },\n  },\n}\n\n</script>\n\n<style scoped lang=\"less\">\n\n.orders {\n  &__header {\n    margin-bottom: 12px;\n    display: flex;\n    &__input {\n      margin-right: 20px;\n      width: 200px;\n    }\n  }\n}\n\n/deep/ .ivu-table-wrapper {\n  max-height: calc(~\"100vh - 200px\");\n  .ivu-table-body {\n    max-height: calc(~\"100vh - 280px\");\n    overflow-y: auto;\n  }\n}\n\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./orderList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./orderList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./orderList.vue?vue&type=template&id=bbea0208&scoped=true&\"\nimport script from \"./orderList.vue?vue&type=script&lang=js&\"\nexport * from \"./orderList.vue?vue&type=script&lang=js&\"\nimport style0 from \"./orderList.vue?vue&type=style&index=0&id=bbea0208&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bbea0208\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./orderList.vue?vue&type=style&index=0&id=bbea0208&prod&scoped=true&lang=less&\""],"sourceRoot":""}