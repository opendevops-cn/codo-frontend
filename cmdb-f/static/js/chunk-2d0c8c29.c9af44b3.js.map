{"version":3,"sources":["webpack://cmdb-[name]/./src/views/cmdb/biz/components/preview-host.vue","webpack://cmdb-[name]/src/views/cmdb/biz/components/preview-host.vue","webpack://cmdb-[name]/./src/views/cmdb/biz/components/preview-host.vue?0eb5","webpack://cmdb-[name]/./src/views/cmdb/biz/components/preview-host.vue?c4f5"],"names":["render","_vm","this","_c","_self","attrs","model","value","dialog","show","callback","$$v","$set","expression","_v","_s","totalCount","staticStyle","on","handleFilter","nativeOn","$event","type","indexOf","_k","keyCode","key","apply","arguments","searchVal","ref","columns","tableData","pageNum","pageSize","handlerChangePage","staticRenderFns","name","props","Object","default","data","serverList","serverFilteredList","pageTotal","filterState","undefined","filterAgentStatus","title","align","sortable","minWidth","width","h","params","row","color","state","text","filterMultiple","filters","label","filterRemote","status","agent_status","computed","length","watch","newVal","initData","setCurrentPageData","methods","begin","end","slice","checkExecList","item","instance_id","inner_ip","includes","filter","$refs","table","handleFilterReset","component"],"mappings":"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","file":"static/js/chunk-2d0c8c29.c9af44b3.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('Modal',{attrs:{\"title\":\"预览主机\",\"width\":\"950\",\"mask-closable\":false,\"footer-hide\":true},model:{value:(_vm.dialog.show),callback:function ($$v) {_vm.$set(_vm.dialog, \"show\", $$v)},expression:\"dialog.show\"}},[_c('alert',[_vm._v(\"一共查询到:\"+_vm._s(_vm.totalCount)+\"条数据\")]),_c('Input',{staticStyle:{\"width\":\"330px\",\"margin\":\"0px\"},attrs:{\"clearable\":\"\",\"placeholder\":\"输入实例ID、主机名、内网IP搜索\",\"search\":\"\"},on:{\"on-change\":_vm.handleFilter},nativeOn:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.handleFilter.apply(null, arguments)}},model:{value:(_vm.searchVal),callback:function ($$v) {_vm.searchVal=$$v},expression:\"searchVal\"}}),_c('div',{staticStyle:{\"margin-top\":\"5px\"}},[_c('Table',{ref:\"table\",attrs:{\"stripe\":\"\",\"border\":\"\",\"size\":\"small\",\"columns\":_vm.columns,\"data\":_vm.tableData}})],1),_c('div',{staticStyle:{\"margin\":\"10px\",\"overflow\":\"hidden\"}},[_c('Page',{attrs:{\"total\":_vm.totalCount,\"current\":_vm.pageNum,\"page-size\":_vm.pageSize,\"show-total\":\"\"},on:{\"on-change\":_vm.handlerChangePage}})],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!-- eslint-disable vue/no-mutating-props -->\n<template>\n  <div>\n    <Modal v-model=\"dialog.show\" title=\"预览主机\" width=\"950\" :mask-closable=\"false\" :footer-hide=\"true\">\n      <alert>一共查询到:{{ totalCount }}条数据</alert>\n      <Input v-model=\"searchVal\" style=\"width: 330px; margin: 0px\" clearable placeholder=\"输入实例ID、主机名、内网IP搜索\" @keydown.enter.native=\"handleFilter\" @on-change=\"handleFilter\" search/>\n\n\n\n      <div style=\"margin-top: 5px\">\n        <Table stripe border size=\"small\" :columns=\"columns\" :data=\"tableData\" ref=\"table\"/>\n      </div>\n\n      <div style=\"margin: 10px; overflow: hidden\">\n        <Page :total=\"totalCount\" :current=\"pageNum\" :page-size=\"pageSize\" show-total @on-change=\"handlerChangePage\" />\n      </div>\n    </Modal>\n  </div>\n</template>\n<script>\nexport default {\n  name: \"PreViewHost\",\n  props: {\n    dialog: {\n      type: Object,\n      default: {},\n    },\n  },\n  data() {\n    return {\n      serverList: [], // 初始总数\n      serverFilteredList: [],\n      tableData: [],\n      searchVal: \"\",\n      pageTotal: 0,\n      pageSize: 10,\n      pageNum: 1,\n      filterState: undefined,\n      filterAgentStatus: undefined,\n      columns: [\n        {\n          title: \"实例ID\",\n          key: \"instance_id\",\n          align: \"center\",\n          sortable: true,\n        },\n        {\n          title: \"主机名称\",\n          key: \"name\",\n          align: \"center\",\n          minWidth: 100,\n          sortable: true,\n        },\n        {\n          title: \"内网IP\",\n          key: \"inner_ip\",\n          align: \"center\",\n          width: 140,\n\n          sortable: true,\n        },\n        {\n          title: \"外网IP\",\n          key: \"outer_ip\",\n          align: \"center\",\n          width: 140,\n          sortable: true,\n        },\n        {\n          title: \"运行状态\",\n          key: \"state\",\n          align: \"center\",\n          width: 135,\n          sortable: true,\n          render: (h, params) => {\n            const { row } = params\n            // eslint-disable-next-line no-nested-ternary\n            const color = row.state === \"运行中\" ? \"success\" : row.state === \"关机\" ? \"error\" : row.state === \"创建中\" ? \"primary\" : \"error\"\n            // eslint-disable-next-line no-nested-ternary\n            const text = row.state === \"运行中\" ? \"运行中\" : row.state === \"关机\" ? \"已关机\" : row.state === \"创建中\" ? \"创建中\" : \"Fail\"\n            return h(\n              \"Tag\",\n              {\n                props: {\n                  type: \"dot\",\n                  color,\n                },\n              },\n              text,\n            )\n          },\n          filterMultiple: false,\n          filters: [\n            { label: \"运行中\", value: \"运行中\" },\n            { label: \"已关机\", value: \"关机\" },\n            { label: \"创建中\", value: \"创建中\" },\n            { label: \"Fail\", value: \"Fail\" },\n          ],\n\n          filterRemote: (value, row) => {\n            this.filterState = value[0]\n            this.handleFilter()\n          },\n        },\n        {\n          title: \"Agent状态\",\n          key: \"agent_status\",\n          align: \"center\",\n          width: 135,\n          sortable: true,\n          render: (h, params) => {\n            const status = params.row.agent_status\n            if (status == \"1\") {\n              return h(\"div\", [h(\"Tag\", { props: { color: \"green\", type: \"border\" } }, \"在线\")])\n            } if (status == \"2\") {\n              return h(\"div\", [h(\"Tag\", { props: { color: \"red\" } }, \"离线\")])\n            }\n            return h(\"div\", [h(\"Tag\", { props: { color: \"error\" } }, \"未知\")])\n          },\n          filterMultiple: false,\n          filters: [\n            { label: \"在线\", value: \"1\" },\n            { label: \"离线\", value: \"2\" },\n            { label: \"未知\", value: \"error\" },\n          ],\n          filterRemote: (value, row) => {\n            this.filterAgentStatus = value[0]\n            this.handleFilter()\n          },\n        },\n      ],\n    }\n  },\n  computed: {\n    totalCount() {\n      return this.serverFilteredList.length\n    },\n  },\n  watch: {\n\n    \"dialog.show\": function (newVal) {\n      if (newVal) {\n        this.initData()\n        this.setCurrentPageData()\n      }\n    },\n  },\n  methods: {\n    handlerChangePage(value) {\n      this.pageNum = value\n      this.setCurrentPageData()\n    },\n    // 分页处理\n    setCurrentPageData() {\n      const begin = (this.pageNum - 1) * this.pageSize\n      const end = this.pageNum * this.pageSize\n      this.tableData = this.serverFilteredList.slice(begin, end)\n    },\n    checkExecList(item) {\n\n      return (item.instance_id.indexOf(this.searchVal) >= 0 || item.name.indexOf(this.searchVal) >= 0 || item.inner_ip.indexOf(this.searchVal) >= 0) && (!this.filterState || item.state === this.filterState || this.filterState === \"Fail\" && ![\"运行中\", \"关机\", \"创建中\"].includes(item.state)) && (!this.filterAgentStatus || item.agent_status === this.filterAgentStatus || this.filterAgentStatus === \"error\" && ![\"1\", \"2\"].includes(item.agent_status))\n    },\n    // 前端搜索和筛选\n    handleFilter() {\n      this.pageNum = 1\n      if (this.searchVal || this.filterState||this.filterAgentStatus) {\n        this.serverFilteredList = this.serverList.filter(this.checkExecList)\n      } else {\n        this.serverFilteredList = this.serverList\n      }\n\n      this.setCurrentPageData()\n    },\n    initData() {\n      this.serverFilteredList = this.serverList\n      this.pageNum = 1\n      this.pageSize = 10\n      this.searchVal = \"\"\n      this.filterState = undefined\n      this.filterAgentStatus = undefined\n\n      // 重置筛选状态，运行状态和Agent状态两个列有筛选,都要重置。handleFilterReset这个方法文档中没有，是查了源码找到的\n      this.$refs.table.handleFilterReset(4);\n      this.$refs.table.handleFilterReset(5);\n\n    },\n  },\n}\n</script>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./preview-host.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./preview-host.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./preview-host.vue?vue&type=template&id=4cd7f56a&\"\nimport script from \"./preview-host.vue?vue&type=script&lang=js&\"\nexport * from \"./preview-host.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}