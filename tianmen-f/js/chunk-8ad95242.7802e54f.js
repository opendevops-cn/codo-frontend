(window["webpackJsonp_gw"]=window["webpackJsonp_gw"]||[]).push([["chunk-8ad95242"],{"0c9b":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"100%"}},[e("Alert",{attrs:{type:"success","show-icon":""}},[t._v("\n    使用说明：\n    "),e("Icon",{attrs:{slot:"icon",type:"ios-bulb-outline"},slot:"icon"}),e("template",{slot:"desc"},[t._v("\n      此处的权限为API网关中实际加载的权限数据，如果启用了RBAC插件的路由会校验用户是否有某个服务的某个请求方法+请求路径的权限\n    ")])],2),e("Table",{attrs:{size:"small",columns:t.columns,data:t.tableData}}),e("rule-show",{attrs:{modalData:t.modalData,ruleData:t.ruleData},on:{"modal-close":t.handlerModalClose}})],1)},o=[],r=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),i=n("2f62"),l=n("90de"),c=n("66df"),s=function(){return c["a"].request({url:"/api/admin/rbac/list",method:"get"})},u=function(t){return c["a"].request({url:"/api/admin/rbac/remove",method:"delete",data:t})},d=function(){var t=this,e=t._self._c;return e("Drawer",{staticStyle:{"background-color":"#f8f8f9"},attrs:{title:t.modalData.title,width:"500px;",draggable:"","footer-hide":!0},model:{value:t.modalData.show,callback:function(e){t.$set(t.modalData,"show",e)},expression:"modalData.show"}},[e("Table",{attrs:{size:"small",columns:t.columnsRule,data:t.ruleData}})],1)},h=[],f=(n("7f7f"),{name:"ruleShow",props:{modalData:{type:Object,default:{}},ruleData:{type:Array|Object,default:[]}},data:function(){return{columnsRule:[{title:"用户ID",key:"user_id",minWidth:120},{title:"状态",key:"handle",width:90,render:function(t,e){var n=e.row.status;return t("div","y"===n?[t("Tag",{props:{color:"green"}},"up")]:[t("Tag",{props:{color:"orange"}},"down")])}}]}},methods:{handleCancel:function(){this.$emit("modal-close")},handleSubmit:function(t){var e=this;this.$refs[t].validate((function(t){t?(e.btnLoading=!0,setTimeout((function(){e.$emit("handle-submit-service",e.formValidate,e.modalData.action),e.btnLoading=!1}),500)):e.$Message.error("表单校验不通过!")}))},handlerReset:function(t){this.$refs[t].resetFields()}}}),m=f,p=n("2877"),w=Object(p["a"])(m,d,h,!1,null,null,null),b=w.exports;function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var D={components:{ruleShow:b},data:function(){var t=this;return{columns:[{title:"ID",key:"func_id",minWidth:120,maxWidth:180,sortable:!0},{title:"权限名称",key:"name",minWidth:120,maxWidth:180,sortable:!0},{title:"服务编码",key:"app_code",minWidth:90},{title:"请求",key:"method",minWidth:90},{title:"后端服务uri",key:"uri",minWidth:150},{title:"状态",key:"handle",width:100,render:function(t,e){var n=e.row.status;return t("div",1===n?[t("Tag",{props:{color:"green"}},"up")]:0===n?[t("Tag",{props:{color:"orange"}},"down")]:[t("Tag",{props:{color:"error"}},"未知")])}},{title:"更新时间",key:"time",width:155,render:function(t,e){return t("div",Object(l["b"])(new Date(e.row.time),"yyyy-MM-dd hh:mm"))}},{title:"#",key:"handle",minWidth:110,maxWidth:130,render:function(e,n){return e("div",[e("a",{style:{marginRight:"5px"},on:{click:function(){t.handlerInfo(n.row.rules)}}},"详情"),e("a",{style:{marginRight:"5px"},on:{click:function(){t.handlerDelete(n)}}},"删除")])}}],tableData:[],modalData:{},ruleData:[]}},methods:{handleGetGwAPIRule:function(){var t=this;s().then((function(e){t.tableData=e.data}))},handlerDelete:function(t){var e=this;this.$Modal.confirm({title:"提醒",content:"<p>确定要删除API权限：《/".concat(t.row.func_id,"/").concat(t.row.app_code).concat(t.row.key,"》</p>"),onOk:function(){setTimeout((function(){u({key:"/".concat(t.row.func_id,"/").concat(t.row.app_code).concat(t.row.key)}).then((function(t){e.$Message.success("删除成功"),e.handleGetGwAPIRule()}))}),500)},onCancel:function(){e.$Message.info("回头是岸~")}})},handlerInfo:function(t){var e=[];for(var n in t){var a=n,o=t[n];e.push({user_id:a,status:o}),this.ruleData=e}this.modalData={show:!0,title:"展示权限信息"}},handlerModalClose:function(){this.modalData.show=!1,this.handleGetGwAPIRule()}},watch:{},computed:g({},Object(i["e"])({rules:function(t){return t.user.rules}})),mounted:function(){this.handleGetGwAPIRule()}},v=D,O=(n("f014"),Object(p["a"])(v,a,o,!1,null,"18a4dadf",null));e["default"]=O.exports},5983:function(t,e,n){},f014:function(t,e,n){"use strict";n("5983")}}]);