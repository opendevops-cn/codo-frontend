(window["webpackJsonp_mg"]=window["webpackJsonp_mg"]||[]).push([["chunk-40dd0696"],{"7c80":function(t,e,a){"use strict";a("8e64")},"8baa":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("Alert",{attrs:{type:"success","show-icon":""}},[t._v("\n    使用说明：\n    "),e("Icon",{attrs:{slot:"icon",type:"ios-bulb-outline"},slot:"icon"}),e("template",{slot:"desc"},[t._v("租户隔离，代表业务/项目/资源组/租户")])],2),e("div",{staticClass:"search-con search-con-top"},[e("Input",{staticClass:"search-input",attrs:{search:"",maxlength:100,placeholder:"输入关键字全局搜索"},on:{"on-search":t.handleSearch},model:{value:t.initPara.searchVal,callback:function(e){t.$set(t.initPara,"searchVal",e)},expression:"initPara.searchVal"}}),e("ButtonGroup",{staticClass:"search-btn"},[e("Button",{attrs:{icon:"ios-add"},on:{click:t.handleAdd}},[t._v(" 新建业务")]),e("Button",{attrs:{icon:"ios-download-outline"},on:{click:function(e){return t.handlerExport()}}},[t._v("导出数据")])],1)],1),e("Table",{ref:"businessTable",attrs:{size:"small",columns:t.tableColumns,data:t.tableData}}),e("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[e("div",{staticStyle:{float:"left"}},[e("Page",{attrs:{total:t.i.pageTotal,current:t.initPara.page_number,"page-size":t.initPara.page_size,"show-total":"","show-sizer":"","page-size-opts":[15,50,100,1e3]},on:{"on-change":t.handlerChangePage,"on-page-size-change":t.handlePageSize}})],1)]),e("business-edit",{ref:"bizEdit",attrs:{modalData:t.modalData},on:{"save-data":t.handleSave,"save-data-t":t.handleSave2,close:t.handleClose}})],1)},n=[],r=(a("ac6a"),a("96cf"),a("3b8d")),l=a("66df"),o=function(t){return l["a"].request({url:"/api/p/v4/biz/",method:"get",params:t})},s=function(t,e){return l["a"].request({url:"/api/p/v4/biz/",method:e,data:t})},d=function(t,e){return l["a"].request({url:"/api/p/v4/tenant/",method:e,data:t})},c=a("f7ab"),u=(a("7f7f"),a("55dd"),function(){var t=this,e=t._self._c;return e("div",[e("Drawer",{attrs:{title:t.modalData.title,width:"850px",draggable:"","mask-closable":!1,"footer-hide":!0},model:{value:t.modalData.show,callback:function(e){t.$set(t.modalData,"show",e)},expression:"modalData.show"}},[e("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":100}},[e("FormItem",{attrs:{label:"业务ID",prop:"biz_id"}},[e("Input",{attrs:{maxlength:10,placeholder:"业务ID"},model:{value:t.formValidate.biz_id,callback:function(e){t.$set(t.formValidate,"biz_id",e)},expression:"formValidate.biz_id"}})],1),e("FormItem",{attrs:{label:"中文名",prop:"biz_cn_name"}},[e("Input",{attrs:{maxlength:20,placeholder:"请输入业务中文名"},model:{value:t.formValidate.biz_cn_name,callback:function(e){t.$set(t.formValidate,"biz_cn_name",e)},expression:"formValidate.biz_cn_name"}})],1),e("FormItem",{attrs:{label:"英文名",prop:"biz_en_name"}},[e("Input",{attrs:{maxlength:20,placeholder:"请输入业务英文名"},model:{value:t.formValidate.biz_en_name,callback:function(e){t.$set(t.formValidate,"biz_en_name",e)},expression:"formValidate.biz_en_name"}})],1),e("FormItem",{attrs:{label:"业务实体",prop:"corporate"}},[e("Input",{attrs:{maxlength:25,placeholder:"关联公司实体信息"},model:{value:t.formValidate.corporate,callback:function(e){t.$set(t.formValidate,"corporate",e)},expression:"formValidate.corporate"}})],1),e("FormItem",{attrs:{label:"管理员",prop:"maintainer"}},[e("Select",{staticClass:"search-input-long",attrs:{maxlength:"500",filterable:"",multiple:"","max-tag-count":1,placeholder:"请选择业务角色"},model:{value:t.formValidate.maintainer,callback:function(e){t.$set(t.formValidate,"maintainer",e)},expression:"formValidate.maintainer"}},t._l(t.roleList,(function(t){return e("Option",{key:t.id,attrs:{value:t.id,label:t.role_name}})})),1)],1),e("FormItem",{attrs:{label:"运维人员",prop:"biz_sre"}},[e("Select",{staticClass:"search-input-long",attrs:{maxlength:"500",filterable:"",multiple:"","max-tag-count":1,placeholder:"请选择业务角色"},model:{value:t.formValidate.biz_sre,callback:function(e){t.$set(t.formValidate,"biz_sre",e)},expression:"formValidate.biz_sre"}},t._l(t.roleList,(function(t){return e("Option",{key:t.id,attrs:{value:t.id,label:t.role_name}})})),1)],1),e("FormItem",{attrs:{label:"开发人员",prop:"biz_developer"}},[e("Select",{staticClass:"search-input-long",attrs:{maxlength:"500",filterable:"",multiple:"","max-tag-count":1,placeholder:"请选择业务角色"},model:{value:t.formValidate.biz_developer,callback:function(e){t.$set(t.formValidate,"biz_developer",e)},expression:"formValidate.biz_developer"}},t._l(t.roleList,(function(t){return e("Option",{key:t.id,attrs:{value:t.id,label:t.role_name}})})),1)],1),e("FormItem",{attrs:{label:"测试人员",prop:"biz_tester"}},[e("Select",{staticClass:"search-input-long",attrs:{maxlength:"500",filterable:"",multiple:"","max-tag-count":1,placeholder:"请选择业务角色"},model:{value:t.formValidate.biz_tester,callback:function(e){t.$set(t.formValidate,"biz_tester",e)},expression:"formValidate.biz_tester"}},t._l(t.roleList,(function(t){return e("Option",{key:t.id,attrs:{value:t.id,label:t.role_name}})})),1)],1),e("FormItem",{attrs:{label:"产品运营",prop:"biz_pm"}},[e("Select",{staticClass:"search-input-long",attrs:{maxlength:"500",filterable:"",multiple:"","max-tag-count":1,placeholder:"请选择业务角色"},model:{value:t.formValidate.biz_pm,callback:function(e){t.$set(t.formValidate,"biz_pm",e)},expression:"formValidate.biz_pm"}},t._l(t.roleList,(function(t){return e("Option",{key:t.id,attrs:{value:t.id,label:t.role_name}})})),1)],1),e("FormItem",{attrs:{label:"生命周期",prop:"life_cycle"}},[e("Select",{attrs:{placeholder:"生命周期"},model:{value:t.formValidate.life_cycle,callback:function(e){t.$set(t.formValidate,"life_cycle",e)},expression:"formValidate.life_cycle"}},[e("Option",{attrs:{value:"开发中"}},[t._v("开发中")]),e("Option",{attrs:{value:"测试中"}},[t._v("测试中")]),e("Option",{attrs:{value:"已上线"}},[t._v("已上线")]),e("Option",{attrs:{value:"停运"}},[t._v("停运")])],1)],1),e("FormItem",{attrs:{label:"排序"}},[e("InputNumber",{attrs:{max:1e3,min:5},model:{value:t.formValidate.sort,callback:function(e){t.$set(t.formValidate,"sort",e)},expression:"formValidate.sort"}})],1),e("FormItem",{attrs:{label:"备注信息",prop:"description"}},[e("Input",{attrs:{maxlength:200,type:"textarea",placeholder:"请输入备注信息"},model:{value:t.formValidate.description,callback:function(e){t.$set(t.formValidate,"description",e)},expression:"formValidate.description"}})],1),e("FormItem",[e("Button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("提交")]),e("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleSubmit("formValidate",!0)}}},[t._v("保存并继续")]),e("Button",{staticStyle:{"margin-left":"8px"},on:{click:t.handleCancel}},[t._v("取消")])],1)],1)],1),e("Modal",{attrs:{title:"新增租户",styles:{top:"30px"},"footer-hide":!0},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[e("Form",{ref:"formValidate2",attrs:{model:t.formValidate2,rules:t.ruleValidate2,"label-width":80}},[e("FormItem",{attrs:{label:"租户名称",prop:"name"}},[e("Input",{attrs:{maxlength:"20",placeholder:"租户名称"},model:{value:t.formValidate2.name,callback:function(e){t.$set(t.formValidate2,"name",e)},expression:"formValidate2.name"}})],1),e("FormItem",{attrs:{label:"展示排序",prop:"sort"}},[e("InputNumber",{attrs:{max:300,min:10},model:{value:t.formValidate2.sort,callback:function(e){t.$set(t.formValidate2,"sort",e)},expression:"formValidate2.sort"}})],1),e("FormItem",{attrs:{label:"描述信息",prop:"description"}},[e("Input",{attrs:{maxlength:"20",placeholder:"描述信息"},model:{value:t.formValidate2.description,callback:function(e){t.$set(t.formValidate2,"description",e)},expression:"formValidate2.description"}})],1),e("FormItem",[e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSave("formValidate2")}}},[t._v("保存")]),e("Button",{staticStyle:{"margin-left":"8px"},on:{click:t.handleCancel2}},[t._v("取消")])],1)],1)],1)],1)}),m=[],p={name:"businessEdit",props:{modalData:{type:Object,default:{}}},data:function(){return{btnLoading:!1,showModal:!1,tenantList:[],roleList:[],formValidate2:{sort:100},ruleValidate2:{name:[{required:!0,message:"不能为空",trigger:"blur"}]},formValidate:{},ruleValidate:{biz_cn_name:[{required:!0,message:"业务中文名不能为空",trigger:"blur"}],biz_en_name:[{required:!0,message:"业务英文名不能为空",trigger:"blur"}],corporate:[{required:!0,message:"公司实体不能为空",trigger:"blur"}],description:[{required:!0,message:"描述信息不能为空",trigger:"blur"}]}}},methods:{handleCancel:function(){this.$emit("close")},handleSubmit:function(t,e){var a=this;this.$refs[t].validate((function(t){t?(a.btnLoading=!0,setTimeout((function(){a.$emit("save-data",a.formValidate,a.modalData.action,e),a.btnLoading=!1}),300)):a.$Message.error("表单验证失败")}))},handleAddT:function(){this.showModal=!0},handleSave:function(t){var e=this;this.$refs[t].validate((function(t){t?setTimeout((function(){e.$emit("save-data-t",e.formValidate2)}),1e3):e.$Message.error("表单校验不通过!")}))},handleCancel2:function(){this.showModal=!1}},watch:{}},h=p,f=a("2877"),b=Object(f["a"])(h,u,m,!1,null,null,null),g=b.exports,_={components:{businessEdit:g},data:function(){var t=this;return{tableColumns:[{title:"业务ID",key:"biz_id",sortable:!0,minWidth:90,maxWidth:150},{title:"英文名",key:"biz_en_name",sortable:!0,minWidth:100},{title:"中文名",key:"biz_cn_name",sortable:!0,minWidth:120},{title:"更新时间",key:"update_time",sortable:!0,minWidth:145},{title:"#",key:"handle",width:120,render:function(e,a){return e("div",[e("a",{style:{marginRight:"5px"},on:{click:function(){t.handleEdit(a.row)}}},"编辑"),e("a",{style:{marginLeft:"5px",color:"red"},on:{click:function(){t.handleDel(a.row)}}},"删除")])}}],tableData:[],tenantList:[],selectList:[],initPara:{page_number:1,page_size:15,searchVal:null,order_by:"sort",order:"ascend"},i:{pageTotal:0,tableLoading:!0},normalRoleList:[],modalData:{show:!1,title:"添加业务",action:"post"},initForm:{life_cycle:"已上线",sort:100},userList:null}},methods:{handleGetData:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o(this.initPara);case 2:e=t.sent,0===e.data.code?(this.tableData=e.data.data,this.i.pageTotal=e.data.count):this.$Message.error("".concat(e.data.msg)),this.i.tableLoading=!1;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleGetRoleList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["b"])();case 2:e=t.sent,0===e.data.code?this.normalRoleList=e.data.data.filter((function(t){return"normal"===t.role_type})):this.$Message.error("".concat(e.data.msg));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleSave:function(t,e,a){var i=this;s(t,e).then((function(t){0===t.data.code?a?i.handleGetData():i.handleClose():i.$Message.error(t.data.msg)}))},handleSave2:function(t){var e=this;d(t,"post").then((function(t){0===t.data.code?(e.$Message.success(t.data.msg),e.handleClose()):e.$Message.error(t.data.msg)}))},handleDel:function(t){var e=this;this.$Modal.confirm({content:"<p>真的确定要删除 ".concat(t.business_en," ？</p> <p>请确认！！！</p>"),onOk:function(){s({id:t.id},"delete").then((function(t){t.data.result?(e.$Message.success(t.data.msg),e.handleGetBizList()):e.$Message.error(t.data.msg)}))},onCancel:function(){e.$Message.info("回头是岸")}})},handleAdd:function(){this.$refs.bizEdit.formValidate=this.$options.data().initForm,this.$refs.bizEdit.roleList=this.normalRoleList,this.$refs.bizEdit.tenantList=this.tenantList,this.modalData={show:!0,title:"添加业务",action:"post"}},handleEdit:function(t){this.$refs.bizEdit.formValidate=JSON.parse(JSON.stringify(t)),this.$refs.bizEdit.roleList=this.normalRoleList,this.$refs.bizEdit.tenantList=this.tenantList,this.modalData={show:!0,title:"修改业务",action:"put"}},handleClose:function(){this.modalData.show=!1,this.$refs.bizEdit.showModal=!1,this.$refs.bizEdit.formValidate=this.$options.data().initForm,this.handleGetData()},handleSelect:function(t){var e=[];t.forEach((function(t){e.push(t.id)})),this.selectList=e},handleSearch:function(){this.initPara.page_number=1,this.handleGetData()},handleSort:function(t,e,a){this.initPara.order="asc"===t.order?"ascend":"descend",this.initPara.order_by=t.key,this.handleGetData()},handlerChangePage:function(t){this.initPara.page_number=t,this.handleGetData()},handlePageSize:function(t){this.initPara.page_number=1,this.initPara.page_size=t,this.handleGetData()},handlerExport:function(){var t=Date.parse(new Date);this.$refs.businessTable.exportCsv({filename:"业务列表-".concat(t)})}},watch:{},mounted:function(){this.handleGetData(),this.handleGetRoleList()}},v=_,V=(a("7c80"),Object(f["a"])(v,i,n,!1,null,"19a8d028",null));e["default"]=V.exports},"8e64":function(t,e,a){},f7ab:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return l})),a.d(e,"c",(function(){return o})),a.d(e,"e",(function(){return s})),a.d(e,"f",(function(){return d}));var i=a("66df"),n=function(t){return i["a"].request({url:"/api/p/v4/role/",method:"get",params:t})},r=function(){return i["a"].request({url:"/api/p/v4/role/base_list/",method:"get"})},l=function(t,e){return i["a"].request({url:"/api/p/v4/role/",method:e,data:t})},o=function(t){return i["a"].request({url:"/api/p/v4/role_user/",method:"get",params:t})},s=function(t,e){return i["a"].request({url:"/api/p/v4/role_user/",method:e,data:t})},d=function(t){return i["a"].request({url:"/api/p/v4/role/sync/",method:"post",data:t})}}}]);