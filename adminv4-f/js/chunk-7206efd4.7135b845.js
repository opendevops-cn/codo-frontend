(window["webpackJsonp_mg"]=window["webpackJsonp_mg"]||[]).push([["chunk-7206efd4"],{3210:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"100%"}},[e("Alert",{attrs:{type:"success","show-icon":""}},[t._v("\n    使用说明：\n    "),e("Icon",{attrs:{slot:"icon",type:"ios-bulb-outline"},slot:"icon"}),e("template",{slot:"desc"},[t._v("这里用来所有所有用户的长期token，后续会设置黑名单禁用无状态的JWT令牌。")])],2),e("div",{staticClass:"search-con search-con-top"},[e("Input",{staticClass:"search-input",attrs:{search:"",maxlength:100,placeholder:"输入关键字全局搜索"},on:{"on-search":t.handleSearch},model:{value:t.initPara.searchVal,callback:function(e){t.$set(t.initPara,"searchVal",e)},expression:"initPara.searchVal"}})],1),e("Table",{attrs:{size:"small",columns:t.columns,data:t.tableData},on:{"on-sort-change":t.handleSort}}),e("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[e("div",{staticStyle:{float:"left"}},[e("Page",{attrs:{total:t.i.pageTotal,current:t.initPara.page_number,"page-size":t.initPara.page_size,"show-total":"","show-sizer":"","page-size-opts":[15,50,100,1e3]},on:{"on-change":t.handlerChangePage,"on-page-size-change":t.handlePageSize}})],1)])],1)},i=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),r=a("2f62"),s=a("66df"),c=function(t){return s["a"].request({url:"/api/p/v4/token/",method:"get",params:t})},l=function(t,e){return s["a"].request({url:"/api/p/v4/token/",method:e,data:t})};function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var h={data:function(){var t=this;this.$createElement;return{newDetails:null,theData:{},initPara:{page_number:1,page_size:15,searchVal:null,order_by:"create_time",order:"descend"},i:{pageTotal:0,tableLoading:!0},btn_loading:!1,modalData:{},tableData:[],columns:[{title:"用户ID",key:"user_id",minWidth:90,maxWidth:120},{title:"昵称",key:"nickname",minWidth:110,maxWidth:260},{title:"状态",key:"status",minWidth:80,maxWidth:100,render:function(e,a){var n=t.tableData[a.index].status,i="0"===n?{cursor:"pointer"}:{cursor:"pointer",color:"#f50"},o="0"===n?"启用":"禁用";return e("div",[e("Badge",{style:i,props:{status:"0"===n?"success":"default"},nativeOn:{click:function(){t.handleSwitch(a)}}}),e("span"," "+o)])}},{title:"令牌（MD5）",key:"token_md5",minWidth:250},{title:"令牌",key:"token",minWidth:245},{title:"备注",key:"details",minWidth:70,render:function(t,e){return t("Tooltip",{props:{placement:"top"}},[t("Icon",{attrs:{type:"ios-help-circle"}}),t("span",{slot:"content",style:{whiteSpace:"normal",wordBreak:"break-all"}},e.row.details)])}},{title:"过期时间",key:"expire_time",width:160},{title:"创建时间",key:"create_time",width:160},{title:"#",key:"handle",minWidth:100,maxWidth:180,render:function(e,a){return e("div",[t.rules&&t.rules.del_token_a&&e("a",{on:{click:function(){t.handleDelete(a)}}},"删除"),t.rules&&t.rules.edit_token_a&&e("a",{style:{marginLeft:"8px"},on:{click:function(){t.handleRenderEdit(a)}}},"备注")])}}]}},methods:{handleGetData:function(){var t=this;c(this.initPara).then((function(e){0===e.data.code?(t.i.pageTotal=e.data.count,t.tableData=e.data.data):(t.i.pageTotal=0,t.$Message.error("".concat(e.data.msg)))}))},handleAdd:function(){this.modalData={show:!0,title:"添加菜单",action:"post"},this.theData=this.$options.data().theData},handleSwitch:function(t){var e=this,a="0"===t.row.status?"禁用之后会把当前token列入黑名单":"启用token";this.$Modal.confirm({title:"提醒",content:"<p>".concat(a,"，五分钟内生效！！！</p>"),onOk:function(){setTimeout((function(){l({token_id:t.row.token_id},"patch").then((function(t){0==t.data.code?(e.$Message.success(t.data.msg),e.handleGetData()):e.$Message.error(t.data.msg)}))}),500)},onCancel:function(){e.$Message.info("回头是岸~")}})},handleDelete:function(t){var e=this;this.$Modal.confirm({title:"提醒",content:"<p>删除token：之后会把当前token写入黑名单，请谨慎操作！</p>",onOk:function(){setTimeout((function(){l({token_id:t.row.token_id},"delete").then((function(a){0==a.data.code?(e.$Message.success(a.data.msg),e.tableData.splice(t.index,1)):e.$Message.error(a.data.msg)}))}),500)},onCancel:function(){e.$Message.info("回头是岸~")}})},handleRenderEdit:function(t){var e=this;this.$Modal.confirm({onOk:function(){e.handleEdit(t)},render:function(a){return a("Input",{props:{type:"textarea",maxlength:150,showWordLimit:!0,value:t.row.details,autofocus:!0,placeholder:"添加备注信息"},on:{input:function(t){e.newDetails=t}}})}})},handleEdit:function(t){var e=this;setTimeout((function(){l({token_id:t.row.token_id,details:e.newDetails},"put").then((function(t){0==t.data.code?(e.handleGetData(),e.$Message.success(t.data.msg)):e.$Message.error(t.data.msg)}))}),500)},handleSearch:function(){this.initPara.page_number=1,this.handleGetData()},handleSort:function(t,e,a){this.initPara.order="asc"===t.order?"ascend":"descend",this.initPara.order_by=t.key,this.handleGetData()},handlerChangePage:function(t){this.initPara.page_number=t,this.handleGetData()},handlePageSize:function(t){this.initPara.page_number=1,this.initPara.page_size=t,this.handleGetData()}},watch:{searchValue:function(t){this.pageNum=1,this.handleGetData()}},computed:u({},Object(r["e"])({rules:function(t){return t.user.rules}})),mounted:function(){this.handleGetData()}},p=h,f=(a("4a2c"),a("2877")),m=Object(f["a"])(p,n,i,!1,null,"4f4457b5",null);e["default"]=m.exports},"4a2c":function(t,e,a){"use strict";a("4a62")},"4a62":function(t,e,a){}}]);