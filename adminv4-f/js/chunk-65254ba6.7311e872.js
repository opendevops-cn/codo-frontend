(window["webpackJsonp_mg"]=window["webpackJsonp_mg"]||[]).push([["chunk-65254ba6"],{"0c97":function(e,t,a){},"7ce2":function(e,t,a){"use strict";a("0c97")},a308:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return s}));var n=a("66df"),i=function(e){return n["a"].request({url:"/api/p/v4/menus/",method:"get",params:e})},r=function(e,t){return n["a"].request({url:"/api/p/v4/menus/",method:t,data:e})},o=function(e){return n["a"].request({url:"/api/p/v4/role_menu/",method:"get",params:e})},s=function(e,t){return n["a"].request({url:"/api/p/v4/role_menu/",method:t,data:e})}},eba4:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a("66df"),i=function(e){return n["a"].request({url:"/api/p/v4/apps/",method:"get",params:e})},r=function(e,t){return n["a"].request({url:"/api/p/v4/apps/",method:t,data:e})}},eedf:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{height:"100%"}},[t("Alert",{attrs:{type:"success","show-icon":""}},[e._v("\n    使用说明：\n    "),t("Icon",{attrs:{slot:"icon",type:"ios-bulb-outline"},slot:"icon"}),t("template",{slot:"desc"},[e._v("所有菜单，不区分应用，请勿重名。")])],2),t("div",{staticClass:"search-con search-con-top"},[t("Input",{staticClass:"search-input",attrs:{search:"",maxlength:100,placeholder:"输入关键字全局搜索"},on:{"on-search":e.handleSearch},model:{value:e.initPara.searchVal,callback:function(t){e.$set(e.initPara,"searchVal",t)},expression:"initPara.searchVal"}}),t("Select",{staticClass:"search-select",attrs:{filterable:"",clearable:"",placeholder:"请选择应用"},on:{"on-change":e.handleSearch},model:{value:e.initPara.app_code,callback:function(t){e.$set(e.initPara,"app_code",t)},expression:"initPara.app_code"}},e._l(e.app_list,(function(a){return t("Option",{key:a.id,attrs:{value:a.app_code}},[e._v(e._s(a.app_name)+" "+e._s(a.app_code))])})),1),t("Button",{staticClass:"search-btn",on:{click:e.handleAdd}},[e._v("添加菜单")]),t("Button",{staticClass:"search-btn",attrs:{type:"error",disabled:0===e.selectList.length},on:{click:e.handleDelB}},[e._v("批量删除")])],1),t("Table",{ref:"selection",attrs:{size:"small",columns:e.columns,data:e.tableData},on:{"on-sort-change":e.handleSort,"on-selection-change":e.handleSelect}}),t("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[t("div",{staticStyle:{float:"left"}},[t("Page",{attrs:{total:e.i.pageTotal,current:e.initPara.page_number,"page-size":e.initPara.page_size,"show-total":"","show-sizer":"","page-size-opts":[15,50,100,1e3]},on:{"on-change":e.handlerChangePage,"on-page-size-change":e.handlePageSize}})],1)]),t("menu-edit",{attrs:{modalData:e.modalData,formValidate:e.theData,app_list:e.app_list},on:{"save-data":e.handleSaveMenu,close:e.handleClose}})],1)},i=[],r=(a("8e6e"),a("456d"),a("bd86")),o=(a("ac6a"),a("96cf"),a("3b8d")),s=a("2f62"),l=a("a308"),c=a("eba4"),d=(a("7f7f"),function(){var e=this,t=e._self._c;return t("Drawer",{attrs:{title:e.modalData.title,width:"750px;",draggable:"","footer-hide":!0},model:{value:e.modalData.show,callback:function(t){e.$set(e.modalData,"show",t)},expression:"modalData.show"}},[t("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":100,"label-colon":!0}},[t("FormItem",{attrs:{label:"菜单名称",prop:"menu_name"}},[t("Input",{attrs:{maxlength:"80",type:"text",placeholder:"请输入菜单名称..."},model:{value:e.formValidate.menu_name,callback:function(t){e.$set(e.formValidate,"menu_name",t)},expression:"formValidate.menu_name"}})],1),t("FormItem",{attrs:{label:"服务编码",prop:"app_code"}},[t("Select",{attrs:{filterable:"",clearable:"",placeholder:"请选择所属应用"},model:{value:e.formValidate.app_code,callback:function(t){e.$set(e.formValidate,"app_code",t)},expression:"formValidate.app_code"}},e._l(e.app_list,(function(a){return t("Option",{key:a.id,attrs:{value:a.app_code}},[e._v(e._s(a.name)+" "+e._s(a.app_code))])})),1)],1),t("FormItem",{attrs:{label:"备注名称",prop:"details"}},[t("Input",{attrs:{maxlength:"200",type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入备注信息..."},model:{value:e.formValidate.details,callback:function(t){e.$set(e.formValidate,"details",t)},expression:"formValidate.details"}})],1),t("FormItem",[t("Button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.handleSubmit("formValidate")}}},[e._v("提交")]),t("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleCancel()}}},[e._v("取消")])],1)],1)],1)}),u=[],h={name:"menuEdit",props:{modalData:{type:Object,default:{}},formValidate:{type:Object,default:{}},app_list:{type:Array,default:[]}},data:function(){return{btnLoading:!1,ruleValidate:{menu_name:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],app_code:[{required:!0,message:"服务编码不能为空",trigger:"blur"}],details:[{required:!0,message:"备注信息不能为空",trigger:"blur"}]}}},methods:{handleCancel:function(){this.$emit("close")},handleSubmit:function(e){var t=this;this.$refs[e].validate((function(e){e?(t.btnLoading=!0,setTimeout((function(){t.$emit("save-data",t.formValidate,t.modalData.action),t.btnLoading=!1}),500)):t.$Message.error("表单校验不通过!")}))},handlerReset:function(e){this.$refs[e].resetFields()}}},p=h,m=a("2877"),f=Object(m["a"])(p,d,u,!1,null,null,null),g=f.exports;function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){Object(r["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v={components:{menuEdit:g},data:function(){var e=this;return{theData:{},app_list:[],selectList:[],initPara:{page_number:1,page_size:15,app_code:null,searchVal:null,order_by:"update_time",order:"descend"},i:{pageTotal:0,tableLoading:!0},modalData:{},tableData:[],columns:[{type:"selection",title:"",key:"",width:60,align:"center"},{title:"应用编号",key:"app_code",minWidth:80,maxWidth:150,sortable:!0},{title:"菜单名称",key:"menu_name",minWidth:200,maxWidth:400,sortable:!0},{title:"备注名",key:"details",minWidth:200},{title:"#",key:"handle",minWidth:120,maxWidth:180,render:function(t,a){return t("div",[t("a",{style:{marginRight:"5px"},on:{click:function(){e.handleEdit(a.row)}}},"编辑"),t("a",{style:{color:"red"},on:{click:function(){e.handleDel(a)}}},"删除")])}}]}},methods:{handleGetData:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["b"])(this.initPara);case 2:t=e.sent,0===t.data.code?(this.tableData=t.data.data,this.i.pageTotal=t.data.count):this.$Message.error("".concat(t.data.msg)),this.i.tableLoading=!1;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleGetApplist:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["a"])();case 2:t=e.sent,0===t.data.code?this.app_list=t.data.data:this.$Message.error("".concat(t.data.msg));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleAdd:function(){this.modalData={show:!0,title:"添加菜单",action:"post"},this.theData=this.$options.data().theData},handleEdit:function(e){this.modalData={show:!0,title:"编辑菜单",action:"put"},this.theData=e},handleSaveMenu:function(e,t){var a=this;Object(l["c"])(e,t).then((function(e){0==e.data.code?(a.$Message.success("".concat(e.data.msg)),a.modalData.show=!1,a.handleGetData()):a.$Message.error("".concat(e.data.msg))}))},handleClose:function(){this.handleGetData(),this.modalData={},this.theData=this.$options.data().theData,this.selectList=[]},handleSwitch:function(e){var t=this;Object(l["c"])({menu_id:e.menu_id},"patch").then((function(e){0==e.data.code?t.$Message.success("".concat(e.data.msg)):t.$Message.error("".concat(e.data.msg))}))},handleDelB:function(){var e=this;this.$Modal.confirm({title:"提醒",content:"<p>删除菜单：之后无法找回，请谨慎操作！</p>",onOk:function(){setTimeout((function(){Object(l["c"])({id_list:e.selectList},"delete").then((function(t){0==t.data.code?(e.$Message.success(t.data.msg),e.handleClose()):e.$Message.error(t.data.msg)}))}),500)},onCancel:function(){e.$Message.info("回头是岸~")}})},handleDel:function(e){var t=this;this.$Modal.confirm({title:"提醒",content:"<p>删除菜单：《".concat(e.row.menu_name,"》之后无法找回，请谨慎操作！</p>"),onOk:function(){setTimeout((function(){Object(l["c"])({id_list:[e.row.id]},"delete").then((function(a){0==a.data.code?(t.$Message.success(a.data.msg),t.tableData.splice(e.index,1)):t.$Message.error(a.data.msg)}))}),500)},onCancel:function(){t.$Message.info("回头是岸~")}})},handleSelect:function(e){var t=[];e.forEach((function(e){t.push(e.id)})),this.selectList=t},handleSearch:function(){this.initPara.page_number=1,this.handleGetData()},handleSort:function(e,t,a){this.initPara.order="asc"===e.order?"ascend":"descend",this.initPara.order_by=e.key,this.handleGetData()},handlerChangePage:function(e){this.initPara.page_number=e,this.handleGetData()},handlePageSize:function(e){this.initPara.page_number=1,this.initPara.page_size=e,this.handleGetData()}},watch:{},computed:_({},Object(s["e"])({rules:function(e){return e.user.rules}})),mounted:function(){this.handleGetData(),this.handleGetApplist()}},y=v,D=(a("7ce2"),Object(m["a"])(y,n,i,!1,null,"9e438f74",null));t["default"]=D.exports}}]);