"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[7158],{8117:function(e,n,t){t.d(n,{Z:function(){return i}});var r=t(79482),o=t(50959),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"},l=t(35399),c=function(e,n){return o.createElement(l.Z,(0,r.Z)({},e,{ref:n,icon:a}))};var i=o.forwardRef(c)},2031:function(e,n,t){t.d(n,{Z:function(){return w}});var r=t(15558),o=t.n(r),a=t(90228),l=t.n(a),c=t(87999),i=t.n(c),s=t(48305),u=t.n(s),d=t(30813),p=t(60396),f=t(69346),m=t(60148),g=t(29882),h=t(27948),b=t(88934),v=t(97628),C=t(51142),y=t(50959),x=t(11527),k=function(e){var n=e.onCancel,t=e.defaultValue,r=void 0===t?null:t,o=e.title,a=e.onOk,l=(0,y.useState)(r),c=u()(l,2),i=c[0],s=c[1];return(0,x.jsx)(b.Z,{open:!0,title:o,onCancel:n,onOk:function(){null!==i?a(i):v.ZP.warning("请输入副本数")},children:(0,x.jsxs)(C.Z,{align:"center",style:{marginTop:20},children:[(0,x.jsx)("div",{style:{marginRight:20},children:"副本数"}),(0,x.jsx)(h.Z,{value:i,onChange:s,style:{width:200}})]})})},j=t(32030),$=t(59614),S=t(94687),w=function(e){var n=(0,j.useParams)().clusterName,t=void 0===n?"":n,r=e.api,a=e.type,c=void 0===a?"":a,s=(0,y.useState)([]),h=u()(s,2),C=h[0],w=h[1],O=(0,y.useState)(""),Z=u()(O,2),I=Z[0],P=Z[1],E=(0,y.useRef)();(0,y.useEffect)((function(){(0,d.Vb)({cluster_name:t,list_all:1}).then((function(e){w(e.list.map((function(e){return{label:e.name,value:e.name}})))}))}),[]);var T=function(e,n){var t,r,o;(v.ZP.success("修改成功"),n)?null===(t=E.current)||void 0===t||null===(r=t.reloadAndRest)||void 0===r||r.call(t):null===(o=E.current)||void 0===o||o.reload();e()};return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(f.Z,{actionRef:E,request:function(){var e=i()(l()().mark((function e(n){var o;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.list({cluster_name:t,page:n.current,page_size:n.pageSize,keyword:n.keyword,namespace:I});case 2:return o=e.sent,e.abrupt("return",{data:o.list||[],total:o.total||0});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),refreshDeps:[I],placeholder:"模糊搜索负载名称、镜像、标签",columns:[{dataIndex:"name",title:"名称",render:function(e,n){return(0,x.jsx)(j.Link,{to:"/cluster/".concat(t,"/workloads/").concat(c,"/detail/").concat(n.name,"/").concat(n.namespace),children:e})}},{dataIndex:"namespace",title:"命名空间"},{dataIndex:"containers",title:"镜像",width:160,render:function(e,n){return(0,x.jsx)(m.Z,{tagStyle:{maxWidth:150},items:n.containers.map((function(e){return{value:e.image}})),direction:"vertical"})}},{dataIndex:"status",title:"状态",width:200,render:function(e){return"就绪: ".concat(e.readyReplicas,"/").concat(e.replicas," | 已更新: ").concat(e.updatedReplicas," | 可用: ").concat(e.availableReplicas)}},{dataIndex:"create_time",title:"创建时间",width:150},{dataIndex:"operation",title:"操作",fixed:"right",width:220,render:function(e,n){return(0,x.jsxs)($.Z,{children:[(0,x.jsx)(p.Z,{modalRender:function(e){return(0,x.jsx)(g.Z,{defaultValue:n.yaml,clusterName:t,onCancel:function(){e()},sourceType:"deployment"})},children:(0,x.jsx)("a",{children:"编辑yaml"})}),(0,x.jsx)(p.Z,{modalRender:function(e){return(0,x.jsx)(k,{title:"【".concat(n.name,"】伸缩"),onCancel:function(){e()},defaultValue:n.status.replicas,onOk:function(o){r.scale({name:n.name,cluster_name:t,namespace:n.namespace,replicas:o}).then((function(){T(e)}))}})},children:(0,x.jsx)("a",{children:"伸缩"})}),(0,x.jsx)(p.Z,{modalRender:function(e){return(0,x.jsxs)(b.Z,{open:!0,title:"【".concat(n.name,"】重启"),onCancel:function(){e()},onOk:function(){r.restart({name:n.name,cluster_name:t,namespace:n.namespace}).then((function(){T(e)}))},children:["确认重新部署：",n.name,"？"]})},children:(0,x.jsx)("a",{children:"重启"})}),(0,x.jsx)(p.Z,{modalRender:function(e){return(0,x.jsxs)(b.Z,{open:!0,title:"【".concat(n.name,"】删除"),onCancel:function(){e()},onOk:function(){r.delete({name:n.name,cluster_name:t,namespace:n.namespace}).then((function(){T(e,!0)}))},children:["确认删除资源：",n.name,"？"]})},children:(0,x.jsx)("a",{children:"删除"})})]})}}],rightTitle:[(0,x.jsx)(S.Z,{showSearch:!0,value:I,onChange:P,style:{width:200},options:[{label:"全部命名空间",value:""}].concat(o()(C)),filterOption:function(e,n){var t;return(null!==(t=null==n?void 0:n.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())}},"select")]})})}},10534:function(e,n,t){var r=t(99938),o=t(66292),a=t.n(o),l=t(50959),c=t(53270),i=t(77924),s=t(25492),u=t(80785);n.Z=function(e,n){var t;u.Z&&((0,s.mf)(e)||console.error("useDebounceFn expected parameter is a function, got ".concat(typeof e)));var o=(0,c.Z)(e),d=null!==(t=null==n?void 0:n.wait)&&void 0!==t?t:1e3,p=(0,l.useMemo)((function(){return a()((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return o.current.apply(o,(0,r.ev)([],(0,r.CR)(e),!1))}),d,n)}),[]);return(0,i.Z)((function(){p.cancel()})),{run:p,cancel:p.cancel,flush:p.flush}}},85584:function(e,n,t){t.d(n,{Z:function(){return I}});var r=t(50959),o=t(16646),a=t(82187),l=t.n(a),c=t(80687),i=t(69361),s=t(75053),u=t(2444),d=t(601),p=t(99978),f=t(60926),m=t(41748),g=t(75775);const h=e=>{const{lineWidth:n,fontSizeIcon:t,calc:r}=e,o=e.fontSizeSM;return(0,m.TS)(e,{tagFontSize:o,tagLineHeight:(0,d.bf)(r(e.lineHeightSM).mul(o).equal()),tagIconSize:r(t).sub(r(n).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.colorFillTertiary})},b=e=>({defaultBg:new p.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var v=(0,g.I$)("Tag",(e=>(e=>{const{paddingXXS:n,lineWidth:t,tagPaddingHorizontal:r,componentCls:o,calc:a}=e,l=a(r).sub(t).equal(),c=a(n).sub(t).equal();return{[o]:Object.assign(Object.assign({},(0,f.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:l,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,d.bf)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${o}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${o}-close-icon`]:{marginInlineStart:c,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${o}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${o}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:l}}),[`${o}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}})(h(e))),b),C=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t};const y=r.forwardRef(((e,n)=>{const{prefixCls:t,style:o,className:a,checked:c,onChange:i,onClick:s}=e,d=C(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:p,tag:f}=r.useContext(u.E_),m=p("tag",t),[g,h,b]=v(m),y=l()(m,`${m}-checkable`,{[`${m}-checkable-checked`]:c},null==f?void 0:f.className,a,h,b);return g(r.createElement("span",Object.assign({},d,{ref:n,style:Object.assign(Object.assign({},o),null==f?void 0:f.style),className:y,onClick:e=>{null==i||i(!c),null==s||s(e)}})))}));var x=y,k=t(35047);var j=(0,g.bk)(["Tag","preset"],(e=>(e=>(0,k.Z)(e,((n,t)=>{let{textColor:r,lightBorderColor:o,lightColor:a,darkColor:l}=t;return{[`${e.componentCls}${e.componentCls}-${n}`]:{color:r,background:a,borderColor:o,"&-inverse":{color:e.colorTextLightSolid,background:l,borderColor:l},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}})))(h(e))),b);const $=(e,n,t)=>{const r="string"!=typeof(o=t)?o:o.charAt(0).toUpperCase()+o.slice(1);var o;return{[`${e.componentCls}${e.componentCls}-${n}`]:{color:e[`color${t}`],background:e[`color${r}Bg`],borderColor:e[`color${r}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var S=(0,g.bk)(["Tag","status"],(e=>{const n=h(e);return[$(n,"success","Success"),$(n,"processing","Info"),$(n,"error","Error"),$(n,"warning","Warning")]}),b),w=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t};const O=(e,n)=>{const{prefixCls:t,className:a,rootClassName:d,style:p,children:f,icon:m,color:g,onClose:h,closeIcon:b,closable:C,bordered:y=!0}=e,x=w(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:k,direction:$,tag:O}=r.useContext(u.E_),[Z,I]=r.useState(!0);r.useEffect((()=>{"visible"in x&&I(x.visible)}),[x.visible]);const P=(0,c.o2)(g),E=(0,c.yT)(g),T=P||E,R=Object.assign(Object.assign({backgroundColor:g&&!T?g:void 0},null==O?void 0:O.style),p),N=k("tag",t),[z,B,H]=v(N),_=l()(N,null==O?void 0:O.className,{[`${N}-${g}`]:T,[`${N}-has-color`]:g&&!T,[`${N}-hidden`]:!Z,[`${N}-rtl`]:"rtl"===$,[`${N}-borderless`]:!y},a,d,B,H),F=e=>{e.stopPropagation(),null==h||h(e),e.defaultPrevented||I(!1)},[,L]=(0,i.Z)(C,b,(e=>null===e?r.createElement(o.Z,{className:`${N}-close-icon`,onClick:F}):r.createElement("span",{className:`${N}-close-icon`,onClick:F},e)),null,!1),M="function"==typeof x.onClick||f&&"a"===f.type,W=m||null,q=W?r.createElement(r.Fragment,null,W,f&&r.createElement("span",null,f)):f,D=r.createElement("span",Object.assign({},x,{ref:n,className:_,style:R}),q,L,P&&r.createElement(j,{key:"preset",prefixCls:N}),E&&r.createElement(S,{key:"status",prefixCls:N}));return z(M?r.createElement(s.Z,{component:"Tag"},D):D)},Z=r.forwardRef(O);Z.CheckableTag=x;var I=Z}}]);