"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[6677],{73979:function(e,n,a){a.r(n);var l=a(26068),t=a.n(l),r=a(48305),s=a.n(r),i=a(30813),c=a(60396),d=a(58082),o=a(44908),u=a(36970),m=a(32030),x=a(16639),p=a(88934),j=a(97628),h=a(24390),b=a(80699),v=a(35028),Z=(a(50959),a(11527)),g=function(e){var n=e.onCancel,a=e.onOK,l=x.Z.useForm(),r=s()(l,1)[0],c=(0,m.useParams)(),d=c.clusterName,o=void 0===d?"":d,u=c.name,v=void 0===u?"":u,g=c.namespace,y=void 0===g?"":g,f=x.Z.useWatch("update_strategy_type",r);return(0,Z.jsx)(p.Z,{title:"更新策略",open:!0,width:600,onCancel:n,onOk:function(){r.validateFields().then((function(e){(0,i.jv)(t()({cluster_name:o,name:v,namespace:y},e)).then((function(){a(),j.ZP.success("更新策略成功")}))}))},children:(0,Z.jsxs)(x.Z,{form:r,labelCol:{span:7},children:[(0,Z.jsx)(x.Z.Item,{name:"update_strategy_type",label:"更新方式",initialValue:0,children:(0,Z.jsxs)(h.ZP.Group,{children:[(0,Z.jsx)(h.ZP,{value:0,children:"滚动更新 RollingUpdate"}),(0,Z.jsx)(h.ZP,{value:1,children:"重新创建 Recreate"})]})}),0===f&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(x.Z.Item,{name:"max_surge",label:"最大超出副本数",initialValue:"25%",rules:[{required:!0,message:"最大超出副本数不能为空"},{pattern:/^(?:[0-9]\d*|100(?:\.0+)?|(?:[0-9]|[1-9]\d)(?:\.\d+)?)%$/,message:"大于等于0的整数，或者正百分数"}],tooltip:{title:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("p",{children:"maxSurge"}),(0,Z.jsxs)("p",{children:["滚动更新过程中，可以超出期望副本数的最大值。",(0,Z.jsx)("br",{}),"该取值可以是一个绝对值（例如：5），也可以是一个相对于期望副本数的百分比（例如：10%）；",(0,Z.jsx)("br",{}),"如果填写百分比，则以期望副本数乘以该百分比后向上取整的方式计算对应的绝对值；",(0,Z.jsx)("br",{}),"当最大不可用副本数 maxUnavailable 为 0 时，此数值（maxSurge）不能为 0；默认值为 25%。",(0,Z.jsx)("br",{}),"例如：假设此值被设定为30%，当滚动更新开始时，新的副本集（ReplicaSet）可以立刻扩容， 但是旧 Pod 和新 Pod 的总数不超过 Deployment 期待副本数（spec.repilcas）的 130%。 一旦旧 Pod 被终止后，新的副本集可以进一步扩容，但是整个滚动更新过程中，新旧 Pod 的总 数不超过 Deployment 期待副本数（spec.repilcas）的 130%。"]})]}),overlayInnerStyle:{width:630}},children:(0,Z.jsx)(b.Z,{placeholder:"大于等于0的整数，或者正百分数（default：25%）"})}),(0,Z.jsx)(x.Z.Item,{name:"max_unavailable",label:"最大不可用副本数",rules:[{required:!0,message:"最大不可用副本数不能为空"},{pattern:/^(?:[0-9]\d*|100(?:\.0+)?|(?:[0-9]|[1-9]\d)(?:\.\d+)?)%$/,message:"大于等于0的整数，或者正百分数"}],initialValue:"25%",tooltip:{overlayInnerStyle:{width:630},title:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("p",{children:"maxUnavailable"}),(0,Z.jsxs)("p",{children:["滚动更新过程中，不可用副本数的最大值。",(0,Z.jsx)("br",{}),"该取值可以是一个绝对值（例如：5），也可以是一个相对于期望副本数的百分比（例如：10%）；",(0,Z.jsx)("br",{}),"如果填写百分比，则以期望副本数乘以该百分比后向下取整的方式计算对应的绝对值；",(0,Z.jsx)("br",{}),"当最大超出副本数 maxSurge 为 0 时，此数值（maxUnavailable）不能为 0；默认值为 25%；",(0,Z.jsx)("br",{}),"例如：假设此值被设定为 30%，当滚动更新开始时，旧的副本集（ReplicaSet）可以缩容到期望 副本数的 70%；在新副本集扩容的过程中，一旦新的 Pod 已就绪，旧的副本集可以进一步缩容， 整个滚动更新过程中，确保新旧就绪副本数之和不低于期望副本数的 70%。"]})]})},children:(0,Z.jsx)(b.Z,{placeholder:"大于等于0的整数，或者正百分数（default：25%）"})})]})]})})};n.default=function(){var e=(0,m.useParams)(),n=e.clusterName,a=void 0===n?"":n,l=e.name,t=void 0===l?"":l,r=(0,d.J)();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(o.Z,{clusterName:a,items:[{title:(0,Z.jsx)(m.Link,{to:"/cluster/".concat(a,"/workloads/deployment"),children:"Deployment"})},{title:"负载详情：".concat(t)}],sourceType:"deployment"}),(0,Z.jsx)(u.Z,{type:"deployment",operationRender:function(){return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(c.Z,{modalRender:function(e){return(0,Z.jsx)(g,{onCancel:e,onOK:function(){e(),r()}})},children:(0,Z.jsx)(v.ZP,{children:"更新策略"})})})}})]})}}}]);