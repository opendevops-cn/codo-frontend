"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[4931],{1018:function(e,t,n){var r=n(24680),l=n(65095),a=n(83408),o=n(61960),c=n(56031),i=n(97500),s=n(32699),d=n(50959),u=n(22241),f=n(99182),h=n(2177),v=n(24831),m=n(32779),p=n(59409),x=n(5695),j=n(19175),g=n(11527),w=[l.N,a.N,o.N],y=[u.N,f.N,h.N,v.N,m.N,p.N,x.N];c.D([].concat(w,y,[j.N]));var _={tooltip:{confine:!0},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{},showTitle:!1}};t.Z=function(e){var t=e.option,n=e.opts,l=e.onEvents,a=e.onChartReady,o=e.theme,c=e.style,u=e.showLoading,f=void 0!==u&&u,h=(0,d.useRef)(),v=(0,d.useMemo)((function(){return(0,s.merge)({},_,t)}),[t]);return(0,d.useEffect)((function(){h.current&&h.current.getEchartsInstance().setOption(v)}),[v]),(0,g.jsx)(r.Z,{ref:h,echarts:i,option:v,notMerge:!0,lazyUpdate:!1,theme:o,onChartReady:a,onEvents:l,opts:n,showLoading:f,style:c})}},69346:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(15558),l=n.n(r),a=n(26068),o=n.n(a),c=n(48305),i=n.n(c),s=n(56330),d=n(79179),u=n(60125),f=n(10534),h=n(65460),v=n(80699),m=n(82187),p=n.n(m),x=n(50959),j="no-left-title___t8LWq",g=n(11527),w=function(e){var t=e.placeholder,n=e.request,r=e.columns,a=e.leftTitle,c=e.tableProps,m=e.showSearch,w=void 0===m||m,y=e.dataSource,_=e.searchWidth,b=e.rightTitle,Z=void 0===b?[]:b,C=e.refreshDeps,N=e.actionRef,A=e.hideTitle,S=(0,u.T)(N),k=(0,x.useState)(""),F=i()(k,2),O=F[0],$=F[1],I=(0,x.useRef)(""),T=(0,f.Z)((function(){var e,t;null===(e=S.current)||void 0===e||null===(t=e.reloadAndRest)||void 0===t||t.call(e)}),{wait:500}).run;return(0,h.Z)((function(){var e;null===(e=S.current)||void 0===e||e.reload()}),C||[]),(0,g.jsx)(d.Z,o()({className:p()((""===a||void 0===a)&&j),actionRef:S,headerTitle:a,dataSource:y,search:!1,columns:r,request:n&&function(e){return n(o()(o()({},e),{},{keyword:I.current}))},pagination:{showSizeChanger:!0},options:{reload:!!n},toolBarRender:!A&&function(){return[].concat(l()(Z),l()(w?[(0,g.jsx)(v.Z,{style:{width:null!=_?_:300},value:O,placeholder:t,onChange:function(e){$(e.target.value),I.current=e.target.value,T()},allowClear:!0,suffix:(0,g.jsx)(s.Z,{style:{color:"#918f8f"}})},"__search__input")]:[]))}},c))}},60148:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(26068),l=n.n(r),a=n(59614),o=n(26059),c=n(85584),i=(n(50959),"tag___Cjdmk"),s=n(11527),d=function(e){var t=e.items,n=e.max,r=e.direction,d=void 0===r?"horizontal":r,u=e.tagStyle;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{direction:d,size:[4,0],wrap:!0,children:t.slice(0,n).map((function(e,t){return(0,s.jsx)(o.Z,{title:e.value,children:(0,s.jsx)(c.Z,{className:i,color:e.color,style:l()({overflow:"hidden",textOverflow:"ellipsis"},u),children:e.value},t)},t)}))}),n&&t.length>n&&(0,s.jsx)(o.Z,{color:"#ffffff",title:(0,s.jsx)(s.Fragment,{children:t.slice(n).map((function(e,t){return(0,s.jsx)(c.Z,{className:i,color:e.color,children:e.value},t)}))}),children:(0,s.jsx)(c.Z,{className:i,children:"..."})})]})}},60125:function(e,t,n){n.d(t,{T:function(){return l}});var r=n(50959),l=function(e,t){var n=(0,r.useRef)(t);return e||n}},75352:function(e,t,n){n.r(t),n.d(t,{default:function(){return _}});var r=n(90228),l=n.n(r),a=n(87999),o=n.n(a),c=n(30813),i=n(1018),s=n(51142),d=n(50959),u={block:"block___rwgjW",container:"container___gdFZ0","summary-card":"summary-card___tVJAZ",summaryCard:"summary-card___tVJAZ",divide:"divide___CEO4P",circle:"circle___MIUXo"},f=n(11527),h=function(e){var t=e.data,n=e.subtitle,r=e.title,l=e.className,a=(0,d.useMemo)((function(){return{legend:{show:!1},toolbox:{show:!1},title:{text:"".concat(r,"\n").concat(n),left:"center",top:58,textStyle:{fontSize:14,lineHeight:20,textAlign:"center"}},color:t.map((function(e){return e.color})),series:[{type:"pie",radius:["63%","75%"],label:{show:!1},data:t}]}}),[]);return(0,f.jsxs)(s.Z,{className:l,children:[(0,f.jsx)(i.Z,{option:a,style:{height:160,width:200}}),(0,f.jsx)(s.Z,{vertical:!0,style:{padding:"30px 0"},justify:"space-around",children:t.map((function(e,t){return(0,f.jsxs)(s.Z,{children:[(0,f.jsx)("div",{className:u.circle,style:{background:e.color}}),(0,f.jsx)("div",{style:{width:60},children:e.name}),(0,f.jsx)("div",{children:e.value})]},t)}))})]})},v=n(47212),m=n(69328),p=n(11181),x=n(54690),j=n(32030),g=n(82187),w=n.n(g),y=m.Z.Title,_=function(){var e=(0,v.Z)(o()(l()().mark((function e(){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.Rn)();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{pollingInterval:3e3}).data;if(!e)return(0,f.jsx)(p.Z,{tip:"加载中..."});var t=e.overview,n=t.cluster,r=t.node,a=t.cpu,i=t.memory,d=e.follow,m=e.error;return(0,f.jsxs)("div",{children:[(0,f.jsxs)("div",{className:w()(u.container,u.block),style:{height:240},children:[(0,f.jsxs)(s.Z,{justify:"space-between",children:[(0,f.jsx)(y,{level:5,children:"资源概览"}),(0,f.jsx)(j.Link,{to:"/cluster-list",children:"全部集群"})]}),(0,f.jsxs)(s.Z,{children:[(0,f.jsx)(h,{className:u.summaryCard,title:"集群总数",subtitle:e.overview.cluster.total,data:[{value:n.running_total,name:"运行中",color:"#00C782"},{value:n.error_total,name:"异常",color:"#FF4D4F"},{value:n.offline_total,name:"离线",color:"#AAAAAA"}]}),(0,f.jsx)("div",{className:u.divide}),(0,f.jsx)(h,{className:u.summaryCard,title:"节点总数",subtitle:r.total,data:[{value:r.running_total,name:"运行中",color:"#00C782"},{value:r.error_total,name:"异常",color:"#FF4D4F"}]}),(0,f.jsx)("div",{className:u.divide}),(0,f.jsx)(h,{className:u.summaryCard,title:"CPU总数",subtitle:"".concat(a.total,"核"),data:[{value:a.unallocated_total,name:"未分配",color:"#3BA1FF"},{value:a.allocated_total,name:"已分配",color:"#00C782"}]}),(0,f.jsx)("div",{className:u.divide}),(0,f.jsx)(h,{className:u.summaryCard,title:"内存总数",subtitle:"".concat(i.total,"GB"),data:[{value:i.unallocated_total,name:"未分配",color:"#3BA1FF"},{value:i.allocated_total,name:"已分配",color:"#00C782"}]})]})]}),(0,f.jsx)("div",{className:u.containerTable,children:(0,f.jsx)(x.Z,{leftTitle:(0,f.jsx)(y,{level:5,children:"我的关注"}),dataSource:d.list||[],scroll:{y:160},showAll:!0})}),(0,f.jsx)("div",{className:u.containerTable,style:{marginTop:10},children:(0,f.jsx)(x.Z,{leftTitle:(0,f.jsx)(y,{level:5,children:"异常集群"}),showPagination:!1,dataSource:m.list||[],showFollow:!1,scroll:{y:160},showAll:!0})})]})}},54690:function(e,t,n){n.d(t,{Z:function(){return $}});var r=n(26068),l=n.n(r),a=n(90228),o=n.n(a),c=n(87999),i=n.n(c),s=n(15558),d=n.n(s),u=n(67825),f=n.n(u),h=n(30813),v=n(69346),m=n(60148),p=n(32030),x=n(51142),j=n(26059),g=n(41637),w=n(69042),y=n(88934),_=n(80699),b=n(97628),Z=n(50959),C="ellipsis-text___uYXM_",N="comment___kKz5f",A="follow___EsJHj",S=n(11527),k=["showAll","leftTitle","dataSource","request","deletable","showFollow"],F={0:{label:"运行中",color:"#52C41A"},1:{label:"异常",color:"#FF4D4F"},2:{label:"离线",color:"#AAAAAA"}},O={0:{label:"健康",color:"green"},1:{label:"内存使用量过80%",color:"red"},2:{label:"离线",color:"green"},3:{label:"CPU使用量过80%",color:"red"},4:{label:"磁盘使用量过80%",color:"red"},5:{label:"网络IO过高",color:"red"},6:{label:"节点状态异常",color:"red"},7:{label:"调度器异常",color:"red"},8:{label:"控制器管理器异常",color:"red"},9:{label:"存储异常",color:"red"}},$=function(e){var t=e.showAll,n=e.leftTitle,r=e.dataSource,a=e.request,c=e.deletable,s=e.showFollow,u=void 0===s||s,$=f()(e,k),I=(0,Z.useRef)(null),T=(0,Z.useMemo)((function(){var e,t=(e={follow:u},[{title:"名称/备注",dataIndex:"name",width:220,render:function(t,n){return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(x.Z,{children:[(0,S.jsx)(j.Z,{title:t,overlayInnerStyle:{width:100,overflow:"hidden"},children:(0,S.jsx)(p.Link,{to:"/cluster/".concat(t,"/namespace"),style:{maxWidth:160},className:C,children:t})}),(null==e?void 0:e.follow)&&(0,S.jsx)(g.Z,{count:1,className:A})]}),(0,S.jsx)(j.Z,{title:t,overlayInnerStyle:{width:100,overflow:"hidden"},children:(0,S.jsx)("div",{className:"".concat(N," ").concat(C),style:{maxWidth:200},children:n.description})})]})}},{title:"状态",dataIndex:"cluster_state",width:80,render:function(e){var t,n;return(0,S.jsx)("span",{style:{color:(null===(t=F[e])||void 0===t?void 0:t.color)||"#000000"},children:null===(n=F[e])||void 0===n?void 0:n.label})}},{title:"健康检查",dataIndex:"health_state",width:240,render:function(e){return(0,S.jsx)(m.Z,{items:e.map((function(e){var t,n;return{value:null===(t=O[e])||void 0===t?void 0:t.label,color:null===(n=O[e])||void 0===n?void 0:n.color}}))})}},{title:"版本",dataIndex:"server_version",width:160},{title:"创建时间",dataIndex:"build_date",width:160},{title:"节点数",dataIndex:"node_count",width:100},{title:"CPU使用量",dataIndex:"cpu_usage",width:180,render:function(e,t){var n=e?e/t.cpu_total*100:0,r="#1677ff";return n>80?r="#ff4d4f":n>60&&(r="#faad14"),(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:"".concat(e||0,"/").concat(t.cpu_total||0,"核")}),(0,S.jsx)(w.Z,{style:{marginBottom:0},percent:n,strokeColor:r,format:function(){return Math.round(n)+"%"}})]})}},{title:"内存使用量",dataIndex:"memory_usage",width:180,render:function(e,t){var n=e?e/t.memory_total*100:0,r="#1677ff";return n>80?r="#ff4d4f":n>60&&(r="#faad14"),(0,S.jsxs)("div",{children:[(0,S.jsx)("div",{children:"".concat(e||0,"/").concat(t.memory_total||0,"GB")}),(0,S.jsx)(w.Z,{style:{marginBottom:0},percent:n,strokeColor:r,format:function(){return Math.round(n)+"%"}})]})}}]);return c?[].concat(d()(t),[{title:"操作",dataIndex:"operation",width:100,render:function(e,t){return(0,S.jsx)("a",{onClick:function(){var e,n=y.Z.confirm({title:"删除集群",content:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)("p",{children:["删除命名空间,确认删除集群【$",t.name,"】"]})," ",(0,S.jsx)(_.Z,{placeholder:"请输入集群名",onChange:function(e){e.target.value===t.name?n.update({okButtonProps:{disabled:!1}}):n.update({okButtonProps:{disabled:!0}})}})]}),okButtonProps:{disabled:!0},onOk:(e=i()(o()().mark((function e(){var n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.Ue)({id:t.id});case 2:b.ZP.success("删除成功"),null===(n=I.current)||void 0===n||n.reload();case 4:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})})},children:"删除"})}}]):t}),[c,u]);return(0,S.jsx)(v.Z,{searchWidth:320,actionRef:I,columns:T,request:a,leftTitle:"function"==typeof n?null==n?void 0:n(I):n,placeholder:"模糊搜索集群名称、备注、状态、版本",showSearch:!t,tableProps:l()(l()({rowKey:"id"},$),{},{pagination:!t&&void 0}),dataSource:r})}},51142:function(e,t,n){n.d(t,{Z:function(){return b}});var r=n(50959),l=n(82187),a=n.n(l),o=n(8146),c=n(56445),i=n(2444),s=n(75775),d=n(41748);const u=["wrap","nowrap","wrap-reverse"],f=["flex-start","flex-end","start","end","center","space-between","space-around","space-evenly","stretch","normal","left","right"],h=["center","start","end","flex-start","flex-end","self-start","self-end","baseline","normal","stretch"];var v=function(e,t){return a()(Object.assign(Object.assign(Object.assign({},((e,t)=>{const n={};return u.forEach((r=>{n[`${e}-wrap-${r}`]=t.wrap===r})),n})(e,t)),((e,t)=>{const n={};return h.forEach((r=>{n[`${e}-align-${r}`]=t.align===r})),n[`${e}-align-stretch`]=!t.align&&!!t.vertical,n})(e,t)),((e,t)=>{const n={};return f.forEach((r=>{n[`${e}-justify-${r}`]=t.justify===r})),n})(e,t)))};const m=e=>{const{componentCls:t}=e;return{[t]:{display:"flex","&-vertical":{flexDirection:"column"},"&-rtl":{direction:"rtl"},"&:empty":{display:"none"}}}},p=e=>{const{componentCls:t}=e;return{[t]:{"&-gap-small":{gap:e.flexGapSM},"&-gap-middle":{gap:e.flexGap},"&-gap-large":{gap:e.flexGapLG}}}},x=e=>{const{componentCls:t}=e,n={};return u.forEach((e=>{n[`${t}-wrap-${e}`]={flexWrap:e}})),n},j=e=>{const{componentCls:t}=e,n={};return h.forEach((e=>{n[`${t}-align-${e}`]={alignItems:e}})),n},g=e=>{const{componentCls:t}=e,n={};return f.forEach((e=>{n[`${t}-justify-${e}`]={justifyContent:e}})),n};var w=(0,s.I$)("Flex",(e=>{const{paddingXS:t,padding:n,paddingLG:r}=e,l=(0,d.TS)(e,{flexGapSM:t,flexGap:n,flexGapLG:r});return[m(l),p(l),x(l),j(l),g(l)]}),(()=>({})),{resetStyle:!1}),y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(n[r[l]]=e[r[l]])}return n};const _=r.forwardRef(((e,t)=>{const{prefixCls:n,rootClassName:l,className:s,style:d,flex:u,gap:f,children:h,vertical:m=!1,component:p="div"}=e,x=y(e,["prefixCls","rootClassName","className","style","flex","gap","children","vertical","component"]),{flex:j,direction:g,getPrefixCls:_}=r.useContext(i.E_),b=_("flex",n),[Z,C,N]=w(b),A=null!=m?m:null==j?void 0:j.vertical,S=a()(s,l,null==j?void 0:j.className,b,C,N,v(b,e),{[`${b}-rtl`]:"rtl"===g,[`${b}-gap-${f}`]:(0,c.n)(f),[`${b}-vertical`]:A}),k=Object.assign(Object.assign({},null==j?void 0:j.style),d);return u&&(k.flex=u),f&&!(0,c.n)(f)&&(k.gap=f),Z(r.createElement(p,Object.assign({ref:t,className:S,style:k},(0,o.Z)(x,["justify","wrap","align"])),h))}));var b=_}}]);