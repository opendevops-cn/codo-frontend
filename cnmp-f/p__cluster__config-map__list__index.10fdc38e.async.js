(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[7436],{27274:function(t,e,n){"use strict";n.d(e,{Z:function(){return x}});var a=n(15558),r=n.n(a),i=n(26068),o=n.n(i),s=n(48305),u=n.n(s),c=n(45778),l=n(95974),f=n(41710),d=n(10534),h=n(65460),m=n(96286),p=n(50959),v="table___Rup7Y",g=n(11527),x=function(t){var e=t.placeholder,n=t.request,a=t.columns,i=t.leftTitle,s=t.tableProps,x=t.showSearch,$=void 0===x||x,y=t.dataSource,C=t.searchWidth,Z=t.rightTitle,j=void 0===Z?[]:Z,S=t.refreshDeps,T=t.actionRef,k=t.hideTitle,w=t.searchStyle,D=t.onSearch,M=(0,c.T)(T),O=(0,p.useState)(""),b=u()(O,2),_=b[0],R=b[1],F=(0,p.useRef)(""),U=(0,d.Z)((function(){var t,e;null==D||D(_),null===(t=M.current)||void 0===t||null===(e=t.reloadAndRest)||void 0===e||e.call(t)}),{wait:500}).run;return(0,h.Z)((function(){var t;null===(t=M.current)||void 0===t||t.reload()}),S||[]),(0,g.jsx)(f.Z,o()({className:v,actionRef:M,headerTitle:i,dataSource:y,search:!1,columns:a,request:n&&function(t){return n(o()(o()({},t),{},{keyword:F.current}))},pagination:{showSizeChanger:!0,defaultPageSize:50},options:{reload:!!n},toolBarRender:!k&&function(){return[].concat(r()(j),r()($?[(0,g.jsx)(m.Z,{style:o()({width:null!=C?C:300},w),value:_,placeholder:e,onChange:function(t){R(t.target.value),F.current=t.target.value,U()},allowClear:!0,suffix:(0,g.jsx)(l.Z,{style:{color:"#918f8f"}})},"__search__input")]:[]))}},s))}},45778:function(t,e,n){"use strict";n.d(e,{T:function(){return r}});var a=n(50959),r=function(t,e){var n=(0,a.useRef)(e);return t||n}},84818:function(t,e,n){"use strict";n.r(e);var a=n(90228),r=n.n(a),i=n(87999),o=n.n(i),s=n(48305),u=n.n(s),c=n(15268),l=n(79890),f=n(27274),d=n(34015),h=n(21213),m=n(34593),p=n(36954),v=n(16782),g=n(56765),x=n(38218),$=n(21630),y=n(3885),C=n(3827),Z=n(70334),j=n(69180),S=n(32699),T=n.n(S),k=n(50959),w=n(11527);e.default=function(){var t=(0,k.useState)(!1),e=u()(t,2),n=e[0],a=e[1],i=(0,k.useState)("create"),s=u()(i,2),S=s[0],D=s[1],M=(0,x.useParams)(),O=M.clusterName,b=void 0===O?"":O,_=M.namespace,R=void 0===_?"":_,F=(0,k.useRef)(),U=$.Z.useForm(),Y=u()(U,1)[0];return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(m.Z,{items:[{title:"ConfigMap"}],sourceType:"config-map",showNamespace:!0}),(0,w.jsx)(f.Z,{actionRef:F,tableProps:{rowKey:"name"},columns:[{dataIndex:"name",title:"名称",render:function(t,e){return(0,w.jsx)(v.Z,{follow_type:"ConfigMap",follow_value:e.name,follow:e.is_followed,style:{paddingRight:6},title:t,children:(0,w.jsx)(x.Link,{to:"/cluster/".concat(b,"/configuration-resources/").concat(R,"/config-map/").concat(e.name),children:e.name})})}},{dataIndex:"ref_count",title:"引用数"},{dataIndex:"labels",title:"标签",render:function(t,e){return"-"===t?"-":(0,w.jsx)(d.Z,{items:Object.keys(e.labels||{}).map((function(t){return{value:"".concat(t,":").concat(e.labels[t])}})),tagStyle:{maxWidth:200},max:1})}},{dataIndex:"annotations",title:"注解",render:function(t,e){return"-"===t?"-":(0,w.jsx)(d.Z,{items:Object.keys(e.annotations||{}).map((function(t){return{value:"".concat(t,":").concat(e.annotations[t])}})),tagStyle:{maxWidth:200},max:1})}},{dataIndex:"create_time",title:"创建时间",render:g.kZ},{dataIndex:"operation",title:"操作",render:function(t,e){return(0,w.jsxs)(y.Z,{children:[(0,w.jsx)("a",{onClick:function(){a(!0),D("edit"),Y.setFieldsValue({data:T().map(e.data,(function(t,e){return{key:e,value:t}})),annotations:T().map(e.annotations,(function(t,e){return{key:e,value:t}})),labels:T().map(e.labels,(function(t,e){return{key:e,value:t}})),name:e.name})},children:"编辑"}),(0,w.jsx)(l.Z,{modalRender:function(t){return(0,w.jsx)(p.Z,{defaultValue:e.yaml,clusterName:b,onCancel:function(){t()},sourceType:"config-map"})},children:(0,w.jsx)("a",{children:"编辑yaml"})}),(0,w.jsx)("a",{onClick:function(){C.Z.confirm({title:"删除命名空间",content:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("p",{children:["确认删除ConfigMap【",e.name,"】"]}),!T().isEmpty(e.refs)&&(0,w.jsxs)("p",{style:{color:"#FF4D4F"},children:["当前ConfigMap已经被",e.refs.map((function(t){return"".concat(t.kind,"-").concat(t.name)})).join("、"),"引用，删除可能导致引用的工作负载失效"]})]}),onOk:function(){(0,c.ZH)({cluster_name:b,name:e.name,namespace:R}).then((function(){var t;Z.ZP.success("删除成功"),null===(t=F.current)||void 0===t||t.reload(!0)}))}})},children:"删除"}),(0,w.jsx)(l.Z,{})]})}}],request:function(){var t=o()(r()().mark((function t(e){var n;return r()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,c.Co)({cluster_name:b,namespace:R,keyword:e.keyword,page:e.current,page_size:e.pageSize});case 2:return n=t.sent,t.abrupt("return",{data:n.list||[],total:n.total||0});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),leftTitle:(0,w.jsx)(j.ZP,{type:"primary",onClick:function(){a(!0),D("create"),Y.setFieldsValue({})},children:"新建ConfigMap"}),placeholder:"模糊搜索ConfigMap名称"}),(0,w.jsx)(h.Z,{title:"edit"===S?"编辑ConfigMap":"新建ConfigMap",form:Y,open:n,onClose:function(){a(!1)},onOk:function(){var t;null===(t=F.current)||void 0===t||t.reload(!0),a(!1)},type:S})]})}},10534:function(t,e,n){"use strict";var a=n(99938),r=n(66292),i=n.n(r),o=n(50959),s=n(53270),u=n(77924),c=n(25492),l=n(80785);e.Z=function(t,e){var n;l.Z&&((0,c.mf)(t)||console.error("useDebounceFn expected parameter is a function, got ".concat(typeof t)));var r=(0,s.Z)(t),f=null!==(n=null==e?void 0:e.wait)&&void 0!==n?n:1e3,d=(0,o.useMemo)((function(){return i()((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.current.apply(r,(0,a.ev)([],(0,a.CR)(t),!1))}),f,e)}),[]);return(0,u.Z)((function(){d.cancel()})),{run:d,cancel:d.cancel,flush:d.flush}}},11110:function(t){t.exports=function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(a,r,i){var o=r.prototype;i.utc=function(t){return new r({date:t,utc:!0,args:arguments})},o.utc=function(e){var n=i(this.toDate(),{locale:this.$L,utc:!0});return e?n.add(this.utcOffset(),t):n},o.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var s=o.parse;o.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),s.call(this,t)};var u=o.init;o.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else u.call(this)};var c=o.utcOffset;o.utcOffset=function(a,r){var i=this.$utils().u;if(i(a))return this.$u?0:i(this.$offset)?c.call(this):this.$offset;if("string"==typeof a&&(a=function(t){void 0===t&&(t="");var a=t.match(e);if(!a)return null;var r=(""+a[0]).match(n)||["-",0,0],i=r[0],o=60*+r[1]+ +r[2];return 0===o?0:"+"===i?o:-o}(a),null===a))return this;var o=Math.abs(a)<=16?60*a:a,s=this;if(r)return s.$offset=o,s.$u=0===a,s;if(0!==a){var u=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(o+u,t)).$offset=o,s.$x.$localOffset=u}else s=this.utc();return s};var l=o.format;o.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,e)},o.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var f=o.toDate;o.toDate=function(t){return"s"===t&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():f.call(this)};var d=o.diff;o.diff=function(t,e,n){if(t&&this.$u===t.$u)return d.call(this,t,e,n);var a=this.local(),r=i(t).local();return d.call(a,r,e,n)}}}()}}]);