(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[9748],{27274:function(t,e,n){"use strict";n.d(e,{Z:function(){return g}});var r=n(15558),i=n.n(r),a=n(26068),u=n.n(a),o=n(48305),s=n.n(o),c=n(45778),l=n(95974),f=n(41710),d=n(10534),h=n(65460),m=n(96286),v=n(50959),p="table___Rup7Y",x=n(11527),g=function(t){var e=t.placeholder,n=t.request,r=t.columns,a=t.leftTitle,o=t.tableProps,g=t.showSearch,$=void 0===g||g,w=t.dataSource,y=t.searchWidth,_=t.rightTitle,Z=void 0===_?[]:_,j=t.refreshDeps,D=t.actionRef,S=t.hideTitle,T=t.searchStyle,C=t.onSearch,k=(0,c.T)(D),b=(0,v.useState)(""),M=s()(b,2),O=M[0],Y=M[1],R=(0,v.useRef)(""),I=(0,d.Z)((function(){var t,e;null==C||C(O),null===(t=k.current)||void 0===t||null===(e=t.reloadAndRest)||void 0===e||e.call(t)}),{wait:500}).run;return(0,h.Z)((function(){var t;null===(t=k.current)||void 0===t||t.reload()}),j||[]),(0,x.jsx)(f.Z,u()({className:p,actionRef:k,headerTitle:a,dataSource:w,search:!1,columns:r,request:n&&function(t){return n(u()(u()({},t),{},{keyword:R.current}))},pagination:{showSizeChanger:!0,defaultPageSize:50},options:{reload:!!n},toolBarRender:!S&&function(){return[].concat(i()(Z),i()($?[(0,x.jsx)(m.Z,{style:u()({width:null!=y?y:300},T),value:O,placeholder:e,onChange:function(t){Y(t.target.value),R.current=t.target.value,I()},allowClear:!0,suffix:(0,x.jsx)(l.Z,{style:{color:"#918f8f"}})},"__search__input")]:[]))}},o))}},45778:function(t,e,n){"use strict";n.d(e,{T:function(){return i}});var r=n(50959),i=function(t,e){var n=(0,r.useRef)(e);return t||n}},41700:function(t,e,n){"use strict";n.r(e);var r=n(90228),i=n.n(r),a=n(87999),u=n.n(a),o=n(15268),s=n(79890),c=n(27274),l=n(34015),f=n(34593),d=n(36954),h=n(16782),m=n(56765),v=n(38218),p=n(3885),x=n(70334),g=n(3827),$=n(50959),w=n(11527);e.default=function(){var t=(0,v.useParams)(),e=t.clusterName,n=void 0===e?"":e,r=t.namespace,a=void 0===r?"":r,y=(0,$.useRef)();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(f.Z,{items:[{title:"弹性伸缩HPA"}],sourceType:"hpa",showNamespace:!0}),(0,w.jsx)(c.Z,{actionRef:y,columns:[{dataIndex:"name",title:"名称",width:200,render:function(t,e){return(0,w.jsx)(h.Z,{follow_type:"Hpa",follow_value:e.name,follow:e.is_followed,style:{paddingRight:6},title:t,children:(0,w.jsx)(v.Link,{to:"/cluster/".concat(n,"/scale/").concat(a,"/hpa/").concat(e.name),children:t})})}},{dataIndex:"namespace",title:"命名空间",ellipsis:!0},{dataIndex:"workload_type",title:"工作负载",render:function(t,e){return"".concat(e.workload,"(").concat(e.workload_type,")")},ellipsis:!0},{dataIndex:"utilization",title:"伸缩指标",render:function(t,e){return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{children:["CPU 利用率：",e.target_cpu_utilization]}),(0,w.jsxs)("div",{children:["内存 利用率：",e.target_memory_utilization]})]})}},{dataIndex:"min_replicas",title:"最小实例数",width:100},{dataIndex:"max_replicas",title:"最大实例数",width:100},{dataIndex:"current_replicas",title:"当前实例数",width:100},{dataIndex:"labels",title:"标签",render:function(t,e){return e.labels?(0,w.jsx)(l.Z,{tagStyle:{maxWidth:150},items:Object.keys(e.labels).map((function(t){return{value:"".concat(t,":").concat(e.labels[t])}})),direction:"vertical",max:3}):"-"}},{dataIndex:"create_time",title:"创建时间",render:m.kZ},{dataIndex:"operation",title:"操作",fixed:"right",width:160,render:function(t,e){return(0,w.jsxs)(p.Z,{children:[(0,w.jsx)(s.Z,{modalRender:function(t){return(0,w.jsx)(d.Z,{defaultValue:e.yaml,clusterName:n,onCancel:function(){t()},onOk:function(e){(0,o.F_)({cluster_name:n,yaml:e}).then((function(){t(),x.ZP.success("编辑成功")}))}})},children:(0,w.jsx)("a",{children:"编辑yaml"})}),(0,w.jsx)(s.Z,{modalRender:function(t){return(0,w.jsx)(g.Z,{open:!0,title:"【".concat(e.name,"】删除"),onCancel:function(){t()},onOk:function(){(0,o.g8)({cluster_name:n,namespace:a,name:e.name}).then((function(){var t;null===(t=y.current)||void 0===t||t.reload(!0),x.ZP.success("删除成功")}))},children:(0,w.jsxs)("p",{children:["确认删除：",e.name,"？"]})})},children:(0,w.jsx)("a",{children:"删除"})})]})}}],request:function(){var t=u()(i()().mark((function t(e){var r;return i()().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.ob)({cluster_name:n,page:e.current,page_size:e.pageSize,keyword:e.keyword,namespace:a});case 2:return r=t.sent,t.abrupt("return",{data:r.list||[],total:r.total||0});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),tableProps:{scroll:{x:1400},rowKey:"name"},placeholder:"模糊搜索负载名称、镜像、标签"})]})}},56765:function(t,e,n){"use strict";n.d(e,{jp:function(){return s},kZ:function(){return l},yq:function(){return c}});var r=n(5726),i=n.n(r),a=n(11110),u=n.n(a);i().extend(u());var o=function(t){var e=(Date.now()-t)/1e3;return e<60?{duration:e,unit:"second"}:e<3600?{duration:Math.floor(e/60),unit:"minute"}:e<86400?{duration:Math.floor(e/3600),unit:"hour"}:{duration:Math.floor(e/86400),unit:"day"}},s=function(t){if(void 0===t)return"";var e=o(t);return"second"===e.unit?"1分钟内":"".concat(e.duration," ").concat({second:"秒",minute:"分钟",hour:"小时",day:"天"}[e.unit],"前")},c=function(t){var e=o(t);return"second"===e.unit?"1分钟内":"约".concat(e.duration).concat({second:"秒",minute:"分钟",hour:"小时",day:"天"}[e.unit])},l=function(t){return isNaN(Number(t))?t:i()(Number(t)).format("YYYY-MM-DD HH:mm:ss")}},10534:function(t,e,n){"use strict";var r=n(99938),i=n(66292),a=n.n(i),u=n(50959),o=n(53270),s=n(77924),c=n(25492),l=n(80785);e.Z=function(t,e){var n;l.Z&&((0,c.mf)(t)||console.error("useDebounceFn expected parameter is a function, got ".concat(typeof t)));var i=(0,o.Z)(t),f=null!==(n=null==e?void 0:e.wait)&&void 0!==n?n:1e3,d=(0,u.useMemo)((function(){return a()((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return i.current.apply(i,(0,r.ev)([],(0,r.CR)(t),!1))}),f,e)}),[]);return(0,s.Z)((function(){d.cancel()})),{run:d,cancel:d.cancel,flush:d.flush}}},11110:function(t){t.exports=function(){"use strict";var t="minute",e=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,i,a){var u=i.prototype;a.utc=function(t){return new i({date:t,utc:!0,args:arguments})},u.utc=function(e){var n=a(this.toDate(),{locale:this.$L,utc:!0});return e?n.add(this.utcOffset(),t):n},u.local=function(){return a(this.toDate(),{locale:this.$L,utc:!1})};var o=u.parse;u.parse=function(t){t.utc&&(this.$u=!0),this.$utils().u(t.$offset)||(this.$offset=t.$offset),o.call(this,t)};var s=u.init;u.init=function(){if(this.$u){var t=this.$d;this.$y=t.getUTCFullYear(),this.$M=t.getUTCMonth(),this.$D=t.getUTCDate(),this.$W=t.getUTCDay(),this.$H=t.getUTCHours(),this.$m=t.getUTCMinutes(),this.$s=t.getUTCSeconds(),this.$ms=t.getUTCMilliseconds()}else s.call(this)};var c=u.utcOffset;u.utcOffset=function(r,i){var a=this.$utils().u;if(a(r))return this.$u?0:a(this.$offset)?c.call(this):this.$offset;if("string"==typeof r&&(r=function(t){void 0===t&&(t="");var r=t.match(e);if(!r)return null;var i=(""+r[0]).match(n)||["-",0,0],a=i[0],u=60*+i[1]+ +i[2];return 0===u?0:"+"===a?u:-u}(r),null===r))return this;var u=Math.abs(r)<=16?60*r:r,o=this;if(i)return o.$offset=u,o.$u=0===r,o;if(0!==r){var s=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(u+s,t)).$offset=u,o.$x.$localOffset=s}else o=this.utc();return o};var l=u.format;u.format=function(t){var e=t||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,e)},u.valueOf=function(){var t=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*t},u.isUTC=function(){return!!this.$u},u.toISOString=function(){return this.toDate().toISOString()},u.toString=function(){return this.toDate().toUTCString()};var f=u.toDate;u.toDate=function(t){return"s"===t&&this.$offset?a(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():f.call(this)};var d=u.diff;u.diff=function(t,e,n){if(t&&this.$u===t.$u)return d.call(this,t,e,n);var r=this.local(),i=a(t).local();return d.call(r,i,e,n)}}}()}}]);