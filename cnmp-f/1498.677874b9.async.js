"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[1498],{71389:function(e,n,t){t.d(n,{Z:function(){return o}});var r=t(26068),a=t.n(r),u=t(75398),i=(t(50959),"container___RmJld"),l=t(11527),o=function(e){var n=e.children,t=e.style;return(0,l.jsx)(u.Z,{orientation:"left",style:a()({},t),orientationMargin:.001,className:i,children:n})}},27274:function(e,n,t){t.d(n,{Z:function(){return x}});var r=t(15558),a=t.n(r),u=t(26068),i=t.n(u),l=t(48305),o=t.n(l),c=t(45778),s=t(95974),m=t(41710),d=t(10534),f=t(65460),_=t(96286),h=t(50959),v="table___Rup7Y",p=t(11527),x=function(e){var n=e.placeholder,t=e.request,r=e.columns,u=e.leftTitle,l=e.tableProps,x=e.showSearch,g=void 0===x||x,j=e.dataSource,Z=e.searchWidth,C=e.rightTitle,y=void 0===C?[]:C,b=e.refreshDeps,k=e.actionRef,w=e.hideTitle,P=e.searchStyle,R=e.onSearch,B=(0,c.T)(k),q=(0,h.useState)(""),M=o()(q,2),S=M[0],G=M[1],N=(0,h.useRef)(""),Y=(0,d.Z)((function(){var e,n;null==R||R(S),null===(e=B.current)||void 0===e||null===(n=e.reloadAndRest)||void 0===n||n.call(e)}),{wait:500}).run;return(0,f.Z)((function(){var e;null===(e=B.current)||void 0===e||e.reload()}),b||[]),(0,p.jsx)(m.Z,i()({className:v,actionRef:B,headerTitle:u,dataSource:j,search:!1,columns:r,request:t&&function(e){return t(i()(i()({},e),{},{keyword:N.current}))},pagination:{showSizeChanger:!0,defaultPageSize:50},options:{reload:!!t},toolBarRender:!w&&function(){return[].concat(a()(y),a()(g?[(0,p.jsx)(_.Z,{style:i()({width:null!=Z?Z:300},P),value:S,placeholder:n,onChange:function(e){G(e.target.value),N.current=e.target.value,Y()},allowClear:!0,suffix:(0,p.jsx)(s.Z,{style:{color:"#918f8f"}})},"__search__input")]:[]))}},l))}},45778:function(e,n,t){t.d(n,{T:function(){return a}});var r=t(50959),a=function(e,n){var t=(0,r.useRef)(n);return e||t}},26104:function(e,n,t){var r=t(82092),a=t.n(r),u=t(26068),i=t.n(u),l=t(90228),o=t.n(l),c=t(87999),s=t.n(c),m=t(48305),d=t.n(m),f=t(15268),_=t(71389),h=t(79890),v=t(36954),p=t(38218),x=t(99053),g=t(47212),j=t(72596),Z=t(22639),C=t(3827),y=t(3885),b=t(69180),k=t(70334),w=t(63983),P=t(80487),R=t(50959),B=t(11527),q=function(e){var n=e.label,t=e.value,r=e.unit,a=e.onChange;return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(j.Z,{span:4,style:{lineHeight:"32px"},children:n}),(0,B.jsx)(j.Z,{span:8,children:(0,B.jsx)("div",{style:{marginRight:20,marginBottom:20},children:(0,B.jsx)(Z.Z,{placeholder:"不限制",suffix:r,style:{width:"100%"},value:t,onChange:function(e){a(null!==e?"".concat(e):"")}})})})]})};n.Z=function(e){var n=e.namespace,t=e.onCancel,r=(0,p.useParams)().clusterName,u=void 0===r?"":r,l=(0,x.Z)({}),c=d()(l,2),m=c[0],j=c[1],Z=(0,R.useMemo)((function(){return P.ZP.dump({apiVersion:"v1",kind:"LimitRange",metadata:{name:n,namespace:n},spec:{}})}),[n]),M=(0,g.Z)(s()(o()().mark((function e(){var t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.B)({cluster_name:u,namespace:n,name:n});case 2:return t=e.sent,e.abrupt("return",t.detail);case 4:case"end":return e.stop()}}),e)}))),{onSuccess:function(e){j({container_limit_range:e.container_limit_range,pod_limit_range:e.pod_limit_range,persistent_volume_claim_limit_range:e.persistent_volume_claim_limit_range})}}).data,S=function(e,n){j({container_limit_range:i()(i()({},m.container_limit_range),{},a()({},e,n))})},G=function(e,n){j({pod_limit_range:i()(i()({},m.pod_limit_range),{},a()({},e,n))})},N=function(e,n){j({persistent_volume_claim_limit_range:i()(i()({},m.persistent_volume_claim_limit_range),{},a()({},e,n))})},Y=m.container_limit_range,U=m.pod_limit_range,T=m.persistent_volume_claim_limit_range;return(0,B.jsxs)(C.Z,{open:!0,title:"设置资源限制 LimitRange",width:800,footer:function(e){return(0,B.jsxs)(y.Z,{children:[(0,B.jsx)(h.Z,{modalRender:function(e){return(0,B.jsx)(v.Z,{defaultValue:(null==M?void 0:M.yaml)||Z,clusterName:u,onCancel:function(){e(),t()}})},children:(0,B.jsx)(b.ZP,{type:"primary",ghost:!0,children:"编辑YAML"})}),e]})},onCancel:t,onOk:s()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.BI)(i()({name:n,namespace:n,cluster_name:u},m));case 2:k.ZP.success("设置成功"),t();case 4:case"end":return e.stop()}}),e)}))),children:[(0,B.jsx)(_.Z,{children:"容器资源限制"}),(0,B.jsxs)(w.Z,{children:[(0,B.jsx)(q,{label:"默认CPU请求",onChange:function(e){S("default_cpu_request",e)},value:null==Y?void 0:Y.default_cpu_request,unit:"Core"}),(0,B.jsx)(q,{label:"默认CPU上限",value:null==Y?void 0:Y.default_cpu,unit:"Core",onChange:function(e){S("default_cpu",e)}}),(0,B.jsx)(q,{label:"默认内存请求",value:null==Y?void 0:Y.default_mem_request,onChange:function(e){S("default_mem_request",e)},unit:"GiB"}),(0,B.jsx)(q,{label:"默认内存上限",value:null==Y?void 0:Y.default_mem,unit:"GiB",onChange:function(e){S("default_mem",e)}}),(0,B.jsx)(q,{label:"最小CPU",value:null==Y?void 0:Y.min_cpu,unit:"Core",onChange:function(e){S("min_cpu",e)}}),(0,B.jsx)(q,{label:"最大CPU",value:null==Y?void 0:Y.max_cpu,unit:"Core",onChange:function(e){S("max_cpu",e)}}),(0,B.jsx)(q,{label:"最小内存",value:null==Y?void 0:Y.min_mem,unit:"GiB",onChange:function(e){S("min_mem",e)}}),(0,B.jsx)(q,{label:"最大内存",value:null==Y?void 0:Y.max_mem,unit:"GiB",onChange:function(e){S("max_mem",e)}})]}),(0,B.jsx)(_.Z,{children:"Pod资源限制"}),(0,B.jsxs)(w.Z,{children:[(0,B.jsx)(q,{label:"最大CPU",value:null==U?void 0:U.max_cpu,unit:"Core",onChange:function(e){G("max_cpu",e)}}),(0,B.jsx)(q,{label:"最大内存",value:null==U?void 0:U.max_mem,unit:"GiB",onChange:function(e){G("max_mem",e)}})]}),(0,B.jsx)(_.Z,{children:"存储卷声明资源限制"}),(0,B.jsxs)(w.Z,{children:[(0,B.jsx)(q,{label:"最小存储请求",value:null==T?void 0:T.min_resource_storage_request,unit:"GiB",onChange:function(e){N("min_resource_storage_request",e)}}),(0,B.jsx)(q,{label:"最大存储请求",value:null==T?void 0:T.max_resource_storage_request,unit:"GiB",onChange:function(e){N("max_resource_storage_request",e)}})]})]})}},93055:function(e,n,t){var r=t(82092),a=t.n(r),u=t(90228),i=t.n(u),l=t(87999),o=t.n(l),c=t(48305),s=t.n(c),m=t(15268),d=t(71389),f=t(38218),_=t(79890),h=t(36954),v=t(99053),p=t(47212),x=t(72596),g=t(22639),j=t(3827),Z=t(3885),C=t(69180),y=t(70334),b=t(63983),k=t(80487),w=t(50959),P=t(11527),R=function(e){var n=e.label,t=e.value,r=e.unit,a=e.onChange,u=e.usage;return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(x.Z,{span:4,children:n}),(0,P.jsxs)(x.Z,{span:8,children:[(0,P.jsx)("div",{style:{marginRight:20,marginBottom:10},children:(0,P.jsx)(g.Z,{placeholder:"不限制",suffix:r,style:{width:"100%"},value:t,onChange:function(e){a(null!==e?"".concat(e):"")}})}),(0,P.jsx)("div",{style:{marginBottom:20},children:(0,P.jsxs)("span",{children:["已使用：",u," ",r]})})]})]})};n.Z=function(e){var n=(0,v.Z)({}),t=s()(n,2),r=t[0],u=t[1],l=e.namespace,c=e.onCancel,x=(0,f.useParams)().clusterName,g=void 0===x?"":x,B=(0,w.useMemo)((function(){return k.ZP.dump({apiVersion:"v1",kind:"ResourceQuota",metadata:{name:l,namespace:l},spec:{}})}),[l]),q=(0,p.Z)(o()(i()().mark((function e(){var n;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.w9)({cluster_name:g,namespace:l,name:l});case 2:return n=e.sent,e.abrupt("return",n.detail);case 4:case"end":return e.stop()}}),e)}))),{onSuccess:function(e){u(e.hard_resource||{})}}).data,M=(null==q?void 0:q.used_resource)||{},S=function(e){return(0,P.jsx)(R,{label:e.label,value:r[e.key],usage:M[e.key],unit:e.unit,onChange:function(n){u(a()({},e.key,n))}})};return(0,P.jsxs)(j.Z,{open:!0,title:"设置资源配额 ResourceQuota",width:800,footer:function(e){return(0,P.jsxs)(Z.Z,{children:[(0,P.jsx)(_.Z,{modalRender:function(e){return(0,P.jsx)(h.Z,{defaultValue:(null==q?void 0:q.yaml)||B,clusterName:g,onCancel:function(){e(),c()}})},children:(0,P.jsx)(C.ZP,{type:"primary",ghost:!0,children:"编辑YAML"})}),e]})},onCancel:function(){c()},onOk:o()(i()().mark((function e(){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.Yo)({name:l,namespace:l,cluster_name:g,hard_resource:r});case 2:y.ZP.success("设置成功"),c();case 4:case"end":return e.stop()}}),e)}))),children:[(0,P.jsx)(d.Z,{children:"计算资源配额"}),(0,P.jsxs)(b.Z,{children:[S({label:"CPU请求",key:"cpu_request",unit:"Core"}),S({label:"CPU上限",key:"cpu_limit",unit:"Core"}),S({label:"内存请求",key:"mem_request",unit:"GiB"}),S({label:"内存上限",key:"mem_limit",unit:"GiB"})]}),(0,P.jsx)(d.Z,{children:"存储资源配额"}),(0,P.jsxs)(b.Z,{children:[S({label:"存储请求总量",key:"max_resource_storage",unit:"GiB"}),S({label:"存储卷声明数量",key:"max_persistent_volume_claim",unit:"个"})]}),(0,P.jsx)(d.Z,{children:"其他资源配额"}),(0,P.jsxs)(b.Z,{children:[S({label:"Pod数量",key:"max_pod",unit:"个"}),S({label:"ConfigMap数量",key:"max_configmap",unit:"个"}),S({label:"Secret数量",key:"max_secret",unit:"个"}),S({label:"服务数量",key:"max_service",unit:"个"})]})]})}},56765:function(e,n,t){t.d(n,{jp:function(){return o},kZ:function(){return s},yq:function(){return c}});var r=t(5726),a=t.n(r),u=t(11110),i=t.n(u);a().extend(i());var l=function(e){var n=(Date.now()-e)/1e3;return n<60?{duration:n,unit:"second"}:n<3600?{duration:Math.floor(n/60),unit:"minute"}:n<86400?{duration:Math.floor(n/3600),unit:"hour"}:{duration:Math.floor(n/86400),unit:"day"}},o=function(e){if(void 0===e)return"";var n=l(e);return"second"===n.unit?"1分钟内":"".concat(n.duration," ").concat({second:"秒",minute:"分钟",hour:"小时",day:"天"}[n.unit],"前")},c=function(e){var n=l(e);return"second"===n.unit?"1分钟内":"约".concat(n.duration).concat({second:"秒",minute:"分钟",hour:"小时",day:"天"}[n.unit])},s=function(e){return isNaN(Number(e))?e:a()(Number(e)).format("YYYY-MM-DD HH:mm:ss")}},10534:function(e,n,t){var r=t(99938),a=t(66292),u=t.n(a),i=t(50959),l=t(53270),o=t(77924),c=t(25492),s=t(80785);n.Z=function(e,n){var t;s.Z&&((0,c.mf)(e)||console.error("useDebounceFn expected parameter is a function, got ".concat(typeof e)));var a=(0,l.Z)(e),m=null!==(t=null==n?void 0:n.wait)&&void 0!==t?t:1e3,d=(0,i.useMemo)((function(){return u()((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return a.current.apply(a,(0,r.ev)([],(0,r.CR)(e),!1))}),m,n)}),[]);return(0,o.Z)((function(){d.cancel()})),{run:d,cancel:d.cancel,flush:d.flush}}},99053:function(e,n,t){var r=t(99938),a=t(50959),u=t(25492);n.Z=function(e){var n=(0,r.CR)((0,a.useState)(e),2),t=n[0],i=n[1];return[t,(0,a.useCallback)((function(e){i((function(n){var t=(0,u.mf)(e)?e(n):e;return t?(0,r.pi)((0,r.pi)({},n),t):n}))}),[])]}}}]);