"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[4453],{66780:function(e,n,a){a.d(n,{Z:function(){return u}});var t=a(79482),r=a(50959),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM704 536c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]},name:"plus-square",theme:"filled"},l=a(28371),s=function(e,n){return r.createElement(l.Z,(0,t.Z)({},e,{ref:n,icon:i}))};var u=r.forwardRef(s)},35837:function(e,n,a){var t=a(48305),r=a.n(t),i=a(32643),l=a(21630),s=a(3827),u=a(96286),c=(a(50959),a(11527));n.Z=function(e){var n=e.cancel,a=e.initialValues,t=e.onOk,o=l.Z.useForm(),d=r()(o,1)[0];return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(s.Z,{open:!0,title:a?"编辑数据":"添加数据",onCancel:function(){n()},width:800,onOk:function(){d.validateFields().then((function(e){null==t||t(e)}))},children:(0,c.jsxs)(l.Z,{form:d,labelCol:{span:2},initialValues:a,children:[(0,c.jsx)(l.Z.Item,{name:"key",label:"key",rules:[{required:!0,message:"请输入key"},{max:63,message:"最长253个字符"},{pattern:/^[a-zA-Z0-9_.-]+$/,message:'只能包含大小写字母、下划线(“_“)、分隔符("-")、小数点(".")'}],children:(0,c.jsx)(u.Z,{placeholder:'最长253个字符，只能包含大小写字母、下划线(“_“)、分隔符("-")、小数点(".")'})}),(0,c.jsx)(l.Z.Item,{name:"value",label:"value",children:(0,c.jsx)(i.ZP,{theme:"vs-dark",height:400,options:{minimap:{enabled:!1},fontSize:14,scrollBeyondLastLine:!1}})})]})})})}},21213:function(e,n,a){var t=a(15558),r=a.n(t),i=a(90228),l=a.n(i),s=a(87999),u=a.n(s),c=a(15268),o=a(79890),d=a(35837),m=a(89629),f=a(43040),x=a(39585),h=a(38218),y=a(22927),p=a(66780),Z=a(93441),k=a(3885),v=a(69180),j=a(70334),g=a(21630),b=a(96286),V=a(13702),F=a(86309),w=a(99790),I=a(62193),P=a(32699),z=a.n(P),C=(a(50959),a(11527));n.Z=function(e){var n=e.form,a=e.title,t=e.open,i=e.onClose,s=e.type,P=e.onOk,_=(0,h.useParams)(),A=_.clusterName,q=void 0===A?"":A,B=_.namespace,M=void 0===B?"":B,N=(0,m.gt)({variables:{list_all:1,cluster_name:q}}).data;return(0,C.jsx)(Z.Z,{open:t,title:a,width:900,onClose:function(){i(),n.resetFields()},extra:(0,C.jsxs)(k.Z,{children:[(0,C.jsx)(v.ZP,{onClick:function(){i(),n.resetFields()},children:"取消"}),(0,C.jsx)(v.ZP,{type:"primary",onClick:function(){n.validateFields().then(function(){var e=u()(l()().mark((function e(a){return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("edit"!==s){e.next=6;break}return e.next=3,(0,c.J9)({name:a.name,namespace:a.namespace,cluster_name:q,data:z().mapValues(z().keyBy(a.data,"key"),"value"),annotations:z().mapValues(z().keyBy(a.annotations,"key"),"value"),labels:z().mapValues(z().keyBy(a.labels,"key"),"value")});case 3:j.ZP.success("编辑成功"),e.next=9;break;case 6:return e.next=8,(0,c.bI)({name:a.name,namespace:a.namespace,cluster_name:q,data:z().mapValues(z().keyBy(a.data,"key"),"value"),annotations:z().mapValues(z().keyBy(a.annotations,"key"),"value"),labels:z().mapValues(z().keyBy(a.labels,"key"),"value")});case 8:j.ZP.success("创建成功");case 9:null==P||P(),n.resetFields();case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())},children:"确认"})]}),children:(0,C.jsxs)(g.Z,{labelCol:{span:4},form:n,children:[(0,C.jsx)(g.Z.Item,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称"},{max:63,message:"最长63个字符"},{pattern:/^[a-z0-9][a-z0-9.-]*[a-z0-9]$/,message:"只能包含小写字母、数字、分隔符(“-“）、小数点(“.”)，且必须以小写字母或数字开头和结尾"}],children:(0,C.jsx)(b.Z,{disabled:"edit"===s,placeholder:"最长63个字符，只能包含小写字母、数字、分隔符(“-“）、小数点(“.”)，且必须以小写字母或数字开头和结尾"})}),(0,C.jsx)(g.Z.Item,{label:"命名空间",name:"namespace",rules:[{required:!0,message:"请输入命名空间"}],initialValue:M,children:(0,C.jsx)(V.Z,{options:null==N?void 0:N.list.map((function(e){return{value:e.name,label:e.name}})),disabled:"edit"===s})}),(0,C.jsxs)(g.Z.Item,{label:"数据",required:!0,children:[(0,C.jsx)(g.Z.Item,{name:"data",rules:[{required:!0,message:"请添加数据"}],valuePropName:"dataSource",children:(0,C.jsx)(F.Z,{pagination:!1,columns:[{dataIndex:"key",title:"key",ellipsis:!0},{dataIndex:"value",title:"value",ellipsis:!0},{dataIndex:"operation",title:"操作",render:function(e,a){return(0,C.jsxs)(k.Z,{children:[(0,C.jsx)(o.Z,{modalRender:function(e){return(0,C.jsx)(d.Z,{cancel:e,initialValues:a,onOk:function(e){var t=n.getFieldValue("data")||[];t.some((function(n){return n.key===e.key}))?j.ZP.warning("存在重复key，请修改key"):n.setFieldsValue({data:(0,f.A)(t,e,{key:a.key})})}})},children:(0,C.jsx)("a",{children:"编辑"})}),(0,C.jsx)("a",{onClick:function(){n.setFieldsValue({data:z().reject(n.getFieldValue("data"),{key:a.key})})},children:"删除"})]})}}]})}),(0,C.jsxs)(k.Z,{style:{marginTop:10},children:[(0,C.jsx)(o.Z,{modalRender:function(e){return(0,C.jsx)(d.Z,{cancel:e,onOk:function(a){var t=n.getFieldValue("data")||[];t.some((function(e){return e.key===a.key}))?j.ZP.warning("存在重复key，请修改key"):(n.setFieldsValue({data:[].concat(r()(t),[a])}),e())}})},children:(0,C.jsx)(v.ZP,{type:"primary",children:"添加数据"})}),(0,C.jsx)(w.Z,{beforeUpload:function(e){if(e){var a=new FileReader;a.onload=function(a){var t,i=null===(t=a.target)||void 0===t?void 0:t.result,l=n.getFieldValue("data")||[];l.some((function(n){return n.key===(0,x.yZ)(e.name)}))?j.ZP.warning("存在重复key，请修改key"):n.setFieldsValue({data:[].concat(r()(l),[{key:(0,x.yZ)(e.name),value:i}])})},a.readAsText(e)}return!1},fileList:[],children:(0,C.jsx)(v.ZP,{type:"primary",onClick:function(){},children:"上传文件"})})]})]}),(0,C.jsx)(g.Z.Item,{label:"标签",children:(0,C.jsx)(g.Z.List,{name:"labels",children:function(e,a){var t=a.add,r=a.remove;return(0,C.jsxs)(C.Fragment,{children:[e.map((function(e,a){return(0,C.jsxs)(I.Z,{gap:16,children:[(0,C.jsx)(g.Z.Item,{name:[e.name,"key"],style:{width:"100%"},rules:[{required:!0,message:"请输入key"},{max:63,message:"最长63个字符"},{message:"支持字母、数字及分隔符（“-”、“_”、”.”、“/”），需以字母、数字开头",pattern:/^[a-zA-Z0-9][a-zA-Z0-9./_-]*$/},{validator:function(e,t){return(n.getFieldValue("labels")||[]).some((function(e,n){return e.key===t&&a!==n}))?Promise.reject(new Error("存在重复key，请修改key")):Promise.resolve()}}],children:(0,C.jsx)(b.Z,{placeholder:"请输入键"})}),(0,C.jsx)(g.Z.Item,{name:[e.name,"value"],style:{width:"100%"},rules:[{required:!0,message:"请输入value"},{max:63,message:"最长63个字符"},{message:"支持字母、数字及分隔符（“-”、“_”、”.”、“/”），需以字母、数字开头",pattern:/^[a-zA-Z0-9][a-zA-Z0-9./_-]*$/}],children:(0,C.jsx)(b.Z,{placeholder:"请输入值"})}),(0,C.jsx)(y.Z,{style:{display:"flex",alignSelf:"baseline",paddingTop:10},onClick:function(){r(e.name)}})]},e.key)})),(0,C.jsx)("div",{children:(0,C.jsx)("a",{onClick:function(){t()},children:(0,C.jsxs)(k.Z,{children:[(0,C.jsx)(p.Z,{style:{fontSize:20,verticalAlign:"text-bottom"}}),"添加"]})})})]})}})}),(0,C.jsx)(g.Z.Item,{label:"注解",children:(0,C.jsx)(g.Z.List,{name:"annotations",children:function(e,a){var t=a.add,r=a.remove;return(0,C.jsxs)(C.Fragment,{children:[e.map((function(e,a){return(0,C.jsxs)(I.Z,{gap:16,children:[(0,C.jsx)(g.Z.Item,{name:[e.name,"key"],rules:[{required:!0,message:"请输入key"},{max:63,message:"最长63个字符"},{message:"支持字母、数字及分隔符（“-”、“_”、”.”、“/”），需以字母、数字开头",pattern:/^[a-zA-Z0-9][a-zA-Z0-9./_-]*$/},{validator:function(e,t){return(n.getFieldValue("annotations")||[]).some((function(e,n){return e.key===t&&a!==n}))?Promise.reject(new Error("存在重复key，请修改key")):Promise.resolve()}}],style:{width:"100%"},children:(0,C.jsx)(b.Z,{placeholder:"请输入键"})}),(0,C.jsx)(g.Z.Item,{name:[e.name,"value"],rules:[{required:!0,message:"请输入value"}],style:{width:"100%"},children:(0,C.jsx)(b.Z,{placeholder:"请输入值"})}),(0,C.jsx)(y.Z,{style:{display:"flex",alignSelf:"baseline",paddingTop:10},onClick:function(){r(e.name)}})]},e.key)})),(0,C.jsx)("div",{children:(0,C.jsx)("a",{onClick:function(){t()},children:(0,C.jsxs)(k.Z,{children:[(0,C.jsx)(p.Z,{style:{fontSize:20,verticalAlign:"text-bottom"}}),"添加"]})})})]})}})})]})})}},43040:function(e,n,a){a.d(n,{A:function(){return i}});var t=a(32699),r=a.n(t),i=function(e,n,a){if(!e)return[];var t=r().findIndex(e,a);return t>-1?r().set(e,t,n):e}},56765:function(e,n,a){a.d(n,{jp:function(){return u},kZ:function(){return o},yq:function(){return c}});var t=a(5726),r=a.n(t),i=a(11110),l=a.n(i);r().extend(l());var s=function(e){var n=(Date.now()-e)/1e3;return n<60?{duration:n,unit:"second"}:n<3600?{duration:Math.floor(n/60),unit:"minute"}:n<86400?{duration:Math.floor(n/3600),unit:"hour"}:{duration:Math.floor(n/86400),unit:"day"}},u=function(e){if(void 0===e)return"";var n=s(e);return"second"===n.unit?"1分钟内":"".concat(n.duration," ").concat({second:"秒",minute:"分钟",hour:"小时",day:"天"}[n.unit],"前")},c=function(e){var n=s(e);return"second"===n.unit?"1分钟内":"约".concat(n.duration).concat({second:"秒",minute:"分钟",hour:"小时",day:"天"}[n.unit])},o=function(e){return isNaN(Number(e))?e:r()(Number(e)).format("YYYY-MM-DD HH:mm:ss")}}}]);