"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[3059],{39703:function(e,n,r){var t=r(88357),o=r(959),l=r(56929),a=r(11642),u=r(94693),i=r(35361),d=r(99381),c=r(80567),s=r(70436),f=r(61610),v=r(63855),p=r(5051),m=r(86489),h=r(97414),g=r(35028),y=r(16639),Z=r(3691),b=r(75124),w=r(19134),x=r(50959),C=r(79179),R=r(11527),V=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],j=["record","position","creatorButtonText","newRecordType","parentKey","style"],I=x.createContext(void 0);function P(e){var n,r=e.children,t=e.record,o=e.position,l=e.newRecordType,d=e.parentKey,c=(0,x.useContext)(I);return x.cloneElement(r,(0,i.Z)((0,i.Z)({},r.props),{},{onClick:(n=(0,u.Z)((0,a.Z)().mark((function e(n){var u,i,s;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(u=(i=r.props).onClick)||void 0===u?void 0:u.call(i,n);case 2:if(!1!==e.sent){e.next=5;break}return e.abrupt("return");case 5:null==c||null===(s=c.current)||void 0===s||s.addEditRecord(t,{position:o,newRecordType:l,parentKey:d});case 6:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}))}function F(e){var n,r,a=(0,f.YB)(),u=e.onTableChange,s=e.maxLength,y=(e.formItemProps,e.recordCreatorProps),F=e.rowKey,S=(e.controlled,e.defaultValue),U=(e.onChange,e.editableFormRef),k=(0,l.Z)(e,V),T=(0,x.useRef)(void 0),D=(0,x.useRef)(),E=(0,x.useRef)();(0,x.useImperativeHandle)(k.actionRef,(function(){return D.current}),[D.current]);var K=(0,Z.Z)((function(){return e.value||S||[]}),{value:e.value,onChange:e.onChange}),B=(0,o.Z)(K,2),O=B[0],A=B[1],N=x.useMemo((function(){return"function"==typeof F?F:function(e,n){return e[F]||n}}),[F]),M=(0,v.J)((function(n){if("number"==typeof n&&!e.name){if(n>=O.length)return n;var r=O&&O[n];return null==N?void 0:N(r,n)}if(("string"==typeof n||n>=O.length)&&e.name){var t=O.findIndex((function(e,r){var t;return(null==N||null===(t=N(e,r))||void 0===t?void 0:t.toString())===(null==n?void 0:n.toString())}));if(-1!==t)return t}return n}));(0,x.useImperativeHandle)(U,(function(){var n=function(n){var r,t;if(null==n)throw new Error("rowIndex is required");var o=M(n),l=[e.name,null!==(r=null==o?void 0:o.toString())&&void 0!==r?r:""].flat(1).filter(Boolean);return null===(t=E.current)||void 0===t?void 0:t.getFieldValue(l)};return(0,i.Z)((0,i.Z)({},E.current),{},{getRowData:n,getRowsData:function(){var n,r=[e.name].flat(1).filter(Boolean);if(Array.isArray(r)&&0===r.length){var t,o=null===(t=E.current)||void 0===t?void 0:t.getFieldsValue();return Array.isArray(o)?o:Object.keys(o).map((function(e){return o[e]}))}return null===(n=E.current)||void 0===n?void 0:n.getFieldValue(r)},setRowData:function(r,t){var o,l;if(null==r)throw new Error("rowIndex is required");var a=M(r),u=[e.name,null!==(o=null==a?void 0:a.toString())&&void 0!==o?o:""].flat(1).filter(Boolean),d=Object.assign({},(0,i.Z)((0,i.Z)({},n(r)),t||{})),c=(0,w.Z)({},u,d);return null===(l=E.current)||void 0===l||l.setFieldsValue(c),!0}})}),[M,e.name,E.current]),(0,x.useEffect)((function(){e.controlled&&(O||[]).forEach((function(e,n){var r;null===(r=E.current)||void 0===r||r.setFieldsValue((0,t.Z)({},"".concat(N(e,n)),e))}),{})}),[(0,p.ZP)(O),e.controlled]),(0,x.useEffect)((function(){var n;e.name&&(E.current=null==e||null===(n=e.editable)||void 0===n?void 0:n.form)}),[null===(n=e.editable)||void 0===n?void 0:n.form,e.name]);var J=y||{},L=J.record,q=J.position,H=J.creatorButtonText,W=J.newRecordType,Y=J.parentKey,z=J.style,G=(0,l.Z)(J,j),Q="top"===q,X=(0,x.useMemo)((function(){return!("number"==typeof s&&s<=(null==O?void 0:O.length))&&(!1!==y&&(0,R.jsx)(P,{record:(0,m.h)(L,null==O?void 0:O.length,O)||{},position:q,parentKey:(0,m.h)(Y,null==O?void 0:O.length,O),newRecordType:W,children:(0,R.jsx)(g.ZP,(0,i.Z)((0,i.Z)({type:"dashed",style:(0,i.Z)({display:"block",margin:"10px 0",width:"100%"},z),icon:(0,R.jsx)(d.Z,{})},G),{},{children:H||a.getMessage("editableTable.action.add","添加一行数据")}))}))}),[0==y,s,null==O?void 0:O.length]),$=(0,x.useMemo)((function(){return X?Q?{components:{header:{wrapper:function(e){var n,r=e.className,t=e.children;return(0,R.jsxs)("thead",{className:r,children:[t,(0,R.jsxs)("tr",{style:{position:"relative"},children:[(0,R.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:X}),(0,R.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:null===(n=k.columns)||void 0===n?void 0:n.length,children:X})]})]})}}}}:{tableViewRender:function(n,r){var t,o;return(0,R.jsxs)(R.Fragment,{children:[null!==(t=null===(o=e.tableViewRender)||void 0===o?void 0:o.call(e,n,r))&&void 0!==t?t:r,X]})}}:{}}),[Q,X]),_=(0,i.Z)({},e.editable),ee=(0,v.J)((function(n,r){var t,o,l,a;(null===(t=e.editable)||void 0===t||null===(o=t.onValuesChange)||void 0===o||o.call(t,n,r),null===(l=e.onValuesChange)||void 0===l||l.call(e,r,n),e.controlled)&&(null==e||null===(a=e.onChange)||void 0===a||a.call(e,r))}));return(null!=e&&e.onValuesChange||null!==(r=e.editable)&&void 0!==r&&r.onValuesChange||e.controlled&&null!=e&&e.onChange)&&(_.onValuesChange=ee),(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(I.Provider,{value:D,children:(0,R.jsx)(C.Z,(0,i.Z)((0,i.Z)((0,i.Z)({search:!1,options:!1,pagination:!1,rowKey:F,revalidateOnFocus:!1},k),$),{},{tableLayout:"fixed",actionRef:D,onChange:u,editable:(0,i.Z)((0,i.Z)({},_),{},{formProps:(0,i.Z)({formRef:E},_.formProps)}),dataSource:O,onDataSourceChange:function(n){if(A(n),e.name&&"top"===q){var r,t=(0,w.Z)({},[e.name].flat(1).filter(Boolean),n);null===(r=E.current)||void 0===r||r.setFieldsValue(t)}}}))}),e.name?(0,R.jsx)(c.Z,{name:[e.name],children:function(n){var r,t;if(!T.current)return T.current=O,null;var o=(0,b.Z)(n,[e.name].flat(1)),l=null==o?void 0:o.find((function(e,n){var r;return!(0,h.A)(e,null===(r=T.current)||void 0===r?void 0:r[n])}));return T.current=O,l?(null==e||null===(r=e.editable)||void 0===r||null===(t=r.onValuesChange)||void 0===t||t.call(r,l,o),null):null}}):null]})}function S(e){var n=s.ZP.useFormInstance();return e.name?(0,R.jsx)(y.Z.Item,(0,i.Z)((0,i.Z)({style:{maxWidth:"100%"}},null==e?void 0:e.formItemProps),{},{name:e.name,shouldUpdate:function(n,r){var t=[e.name].flat(1);try{return JSON.stringify((0,b.Z)(n,t))!==JSON.stringify((0,b.Z)(r,t))}catch(e){return!0}},children:(0,R.jsx)(F,(0,i.Z)((0,i.Z)({},e),{},{editable:(0,i.Z)((0,i.Z)({},e.editable),{},{form:n})}))})):(0,R.jsx)(F,(0,i.Z)({},e))}S.RecordCreator=P,n.Z=S},52850:function(e,n,r){var t=r(99938),o=r(50959),l=r(25492),a=r(12246),u=r(25844);n.Z=function(e,n){void 0===e&&(e={}),void 0===n&&(n={});var r=n.defaultValue,i=n.defaultValuePropName,d=void 0===i?"defaultValue":i,c=n.valuePropName,s=void 0===c?"value":c,f=n.trigger,v=void 0===f?"onChange":f,p=e[s],m=e.hasOwnProperty(s),h=(0,o.useMemo)((function(){return m?p:e.hasOwnProperty(d)?e[d]:r}),[]),g=(0,o.useRef)(h);m&&(g.current=p);var y=(0,u.Z)();return[g.current,(0,a.Z)((function(n){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var a=(0,l.mf)(n)?n(g.current):n;m||(g.current=a,y()),e[v]&&e[v].apply(e,(0,t.ev)([a],(0,t.CR)(r),!1))}))]}},59739:function(e,n,r){r.d(n,{Z:function(){return c}});var t,o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},l=new Uint8Array(16);function a(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(l)}for(var u=[],i=0;i<256;++i)u.push((i+256).toString(16).slice(1));function d(e,n=0){return(u[e[n+0]]+u[e[n+1]]+u[e[n+2]]+u[e[n+3]]+"-"+u[e[n+4]]+u[e[n+5]]+"-"+u[e[n+6]]+u[e[n+7]]+"-"+u[e[n+8]]+u[e[n+9]]+"-"+u[e[n+10]]+u[e[n+11]]+u[e[n+12]]+u[e[n+13]]+u[e[n+14]]+u[e[n+15]]).toLowerCase()}var c=function(e,n,r){if(o.randomUUID&&!n&&!e)return o.randomUUID();var t=(e=e||{}).random||(e.rng||a)();if(t[6]=15&t[6]|64,t[8]=63&t[8]|128,n){r=r||0;for(var l=0;l<16;++l)n[r+l]=t[l];return n}return d(t)}}}]);