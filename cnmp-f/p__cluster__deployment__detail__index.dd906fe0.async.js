"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[6677],{36367:function(e,a,n){n.r(a);var l=n(26068),t=n.n(l),r=n(48305),s=n.n(r),i=n(15268),c=n(79890),d=n(34654),u=n(2586),o=n(38218),p=n(21630),x=n(3827),m=n(70334),j=n(18772),h=n(96286),g=n(69180),b=(n(50959),n(11527)),Z=function(e){var a=e.onCancel,n=e.onOk,l=e.initialValues,r=p.Z.useForm(),c=s()(r,1)[0],d=(0,o.useParams)(),u=d.clusterName,g=void 0===u?"":u,Z=d.name,f=void 0===Z?"":Z,v=d.namespace,y=void 0===v?"":v,P=p.Z.useWatch("update_strategy_type",c);return(0,b.jsx)(x.Z,{title:"更新策略",open:!0,width:600,onCancel:a,onOk:function(){c.validateFields().then((function(e){(0,i.UP)(t()({cluster_name:g,name:f,namespace:y},e)).then((function(){n(),m.ZP.success("更新策略成功")}))}))},children:(0,b.jsxs)(p.Z,{form:c,labelCol:{span:7},initialValues:l,children:[(0,b.jsx)(p.Z.Item,{name:"update_strategy_type",label:"更新方式",initialValue:"RollingUpdate",children:(0,b.jsxs)(j.ZP.Group,{children:[(0,b.jsx)(j.ZP,{value:"RollingUpdate",children:"滚动更新 RollingUpdate"}),(0,b.jsx)(j.ZP,{value:"Recreate",children:"重新创建 Recreate"})]})}),"RollingUpdate"===P&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Z.Item,{name:"max_surge",label:"最大超出副本数",initialValue:"25%",rules:[{required:!0,message:"最大超出副本数不能为空"},{pattern:/^(?:[1-9][0-9]*|0)%?$/,message:"大于等于0的整数，或者正百分数"}],tooltip:{title:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{children:"maxSurge"}),(0,b.jsxs)("p",{children:["滚动更新过程中，可以超出期望副本数的最大值。",(0,b.jsx)("br",{}),"该取值可以是一个绝对值（例如：5），也可以是一个相对于期望副本数的百分比（例如：10%）；",(0,b.jsx)("br",{}),"如果填写百分比，则以期望副本数乘以该百分比后向上取整的方式计算对应的绝对值；",(0,b.jsx)("br",{}),"当最大不可用副本数 maxUnavailable 为 0 时，此数值（maxSurge）不能为 0；默认值为 25%。",(0,b.jsx)("br",{}),"例如：假设此值被设定为30%，当滚动更新开始时，新的副本集（ReplicaSet）可以立刻扩容， 但是旧 Pod 和新 Pod 的总数不超过 Deployment 期待副本数（spec.repilcas）的 130%。 一旦旧 Pod 被终止后，新的副本集可以进一步扩容，但是整个滚动更新过程中，新旧 Pod 的总 数不超过 Deployment 期待副本数（spec.repilcas）的 130%。"]})]}),overlayInnerStyle:{width:630}},children:(0,b.jsx)(h.Z,{placeholder:"大于等于0的整数，或者正百分数（default：25%）"})}),(0,b.jsx)(p.Z.Item,{name:"max_unavailable",label:"最大不可用副本数",rules:[{required:!0,message:"最大不可用副本数不能为空"},{pattern:/^(?:[1-9][0-9]*|0)%?$/,message:"大于等于0的整数，或者正百分数"}],initialValue:"25%",tooltip:{overlayInnerStyle:{width:630},title:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("p",{children:"maxUnavailable"}),(0,b.jsxs)("p",{children:["滚动更新过程中，不可用副本数的最大值。",(0,b.jsx)("br",{}),"该取值可以是一个绝对值（例如：5），也可以是一个相对于期望副本数的百分比（例如：10%）；",(0,b.jsx)("br",{}),"如果填写百分比，则以期望副本数乘以该百分比后向下取整的方式计算对应的绝对值；",(0,b.jsx)("br",{}),"当最大超出副本数 maxSurge 为 0 时，此数值（maxUnavailable）不能为 0；默认值为 25%；",(0,b.jsx)("br",{}),"例如：假设此值被设定为 30%，当滚动更新开始时，旧的副本集（ReplicaSet）可以缩容到期望 副本数的 70%；在新副本集扩容的过程中，一旦新的 Pod 已就绪，旧的副本集可以进一步缩容， 整个滚动更新过程中，确保新旧就绪副本数之和不低于期望副本数的 70%。"]})]})},children:(0,b.jsx)(h.Z,{placeholder:"大于等于0的整数，或者正百分数（default：25%）"})})]})]})})};a.default=function(){var e=(0,d.J)();return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(u.Z,{type:"deployment",operationRender:function(a){return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(c.Z,{modalRender:function(n){return(0,b.jsx)(Z,{initialValues:a.update_strategy,onCancel:n,onOk:function(){n(),e()}})},children:(0,b.jsx)(g.ZP,{children:"更新策略"})})})}})})}}}]);