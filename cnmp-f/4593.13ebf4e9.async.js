"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[4593],{23352:function(e,n,t){t.d(n,{S:function(){return d}});var i=t(48305),a=t.n(i),r=t(39585),s=t(3885),o=t(69005),c=t(36741),l=t(50959),u=t(11527),d=function(e){var n=e.modifiedContent,t=e.originalContent,i=e.showSimplify,d=(0,l.useRef)(null),f=(0,l.useRef)(null),h=(0,l.useState)(null==i||i),m=a()(h,2),p=m[0],v=m[1],g=(0,l.useState)(!1),y=a()(g,2),x=y[0],j=y[1];return(0,l.useEffect)((function(){return c.languages.register({id:"yaml"}),f.current=c.editor.createDiffEditor(d.current,{theme:"slush-poppies",automaticLayout:!0,readOnly:!0,renderSideBySide:!0,minimap:{enabled:!1}}),f.current.setModel({original:c.editor.createModel(t,"yaml"),modified:c.editor.createModel(n,"yaml")}),function(){f.current&&f.current.dispose()}}),[t,n]),(0,l.useEffect)((function(){i&&f.current&&f.current.setModel({original:c.editor.createModel((0,r.cw)(t,{simplify:p,hideStatus:x}),"yaml"),modified:c.editor.createModel((0,r.cw)(n,{simplify:p,hideStatus:x}),"yaml")})}),[p,x,t,n]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{style:{display:"flex",fontSize:14,fontWeight:"bold"},children:[(0,u.jsx)("div",{style:{width:"50%"},children:"变更前"}),(0,u.jsx)("div",{style:{width:"50%"},children:"变更后"})]}),(0,u.jsx)("div",{ref:d,style:{width:"100%",height:"500px",border:"1px solid #ddd"}}),(0,u.jsx)("div",{style:{position:"relative",height:0},children:(0,u.jsxs)(s.Z,{style:{position:"absolute",top:12},children:[(0,u.jsx)(o.Z,{checked:p,onChange:function(e){v(e.target.checked)},children:"精简字段"}),p&&(0,u.jsx)(o.Z,{checked:x,onChange:function(e){j(e.target.checked)},children:"隐藏status字段"})]})})]})}},79890:function(e,n,t){var i=t(48305),a=t.n(i),r=t(21630),s=t(50959),o=t(11527);n.Z=function(e){var n=e.children,t=e.modalRender,i=(0,s.useState)(!1),c=a()(i,2),l=c[0],u=c[1],d=r.Z.useForm(),f=a()(d,1)[0];return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{onClick:function(){u(!0)},children:n}),l&&(null==t?void 0:t((function(){u(!1)}),f))]})}},81798:function(e,n,t){var i=t(48305),a=t.n(i),r=t(23352),s=t(39585),o=t(32643),c=t(50959),l=t(11527);n.Z=function(e){var n=e.diff,t=e.hideStatus,i=e.onChange,u=e.readOnly,d=e.simplify,f=e.originalValue,h=void 0===f?"":f,m=e.height,p=void 0===m?300:m,v=e.value,g=void 0===v?"":v;(0,c.useEffect)((function(){h&&(d||t)||null==i||i(h);var e=(0,s.cw)(h,{simplify:d,hideStatus:t});null==i||i(e)}),[h,d,t]);var y=(0,c.useMemo)((function(){return n?[(0,s.cw)(h,{simplify:d,hideStatus:t}),g]:["",""]}),[n,d,t,h,g]),x=a()(y,2),j=x[0],Z=x[1];return n?(0,l.jsx)(r.S,{originalContent:j,modifiedContent:Z}):(0,l.jsx)(o.ZP,{theme:u?"slush-poppies":"vs-dark",language:"yaml",value:g,onChange:function(e){null==i||i(e||"")},height:p,options:{minimap:{enabled:!1},fontSize:14,readOnly:u,scrollBeyondLastLine:!1}})}},34654:function(e,n,t){t.d(n,{J:function(){return o}});var i=t(26068),a=t.n(i),r=t(38218),s=t(50959),o=function(){var e=(0,r.useNavigate)(),n=(0,r.useAppData)(),t=(0,r.useLocation)(),i=(0,r.useParams)();return(0,s.useCallback)((function(s){if(null!=s&&s.path)e(null==s?void 0:s.path);else if(null!=s&&s.params){var o="/";((0,r.matchRoutes)(n.clientRoutes,t)||[]).forEach((function(e){e.route.path&&(o=(0,r.resolvePath)(e.route.path,o).pathname)}));var c=(0,r.generatePath)(o,a()(a()({},i),s.params));e(c)}e("/refresh"),setTimeout((function(){e(-1)}),0)}),[e,t,i])}},34593:function(e,n,t){t.d(n,{Z:function(){return w}});var i=t(15558),a=t.n(i),r=t(26068),s=t.n(r),o=t(48305),c=t.n(o),l=t(79890),u=t(34654),d=t(35754),f=t(36954),h=t(38218),m=t(47802),p=t(33587),v=t(62193),g=t(3885),y=t(6294),x=t(69180),j=t(82187),Z=t.n(j),C=(t(50959),"container___hAS97"),k=t(11527),w=function(e){var n=e.items,t=e.sourceType,i=e.showNamespace,r=e.showCluster,o=void 0===r||r,j=e.showCreateYamlButton,w=void 0===j||j,S=e.className,P=e.style,b=e.footRender,A=e.onParamsChange,L=(0,h.useParams)(),M=L.clusterName,N=void 0===M?"":M,O=L.namespace,R=(0,p.Z)(!1),T=c()(R,2),F=T[0],E=T[1],Y=E.setFalse,z=E.setTrue,B=(0,u.J)();return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:Z()(C,S),style:s()({borderRadius:b?0:void 0},P),children:[(0,k.jsxs)(v.Z,{justify:"space-between",align:"center",children:[(0,k.jsxs)(g.Z,{children:[(0,k.jsx)(y.Z,{items:[].concat(a()(o?[{title:(0,k.jsx)(h.Link,{to:"/cluster-list",children:"集群列表"})},{title:(0,k.jsx)(l.Z,{modalRender:function(e){return(0,k.jsx)(d.Z,{onCancel:e,clusterName:N,onOk:function(n,t){A?null==A||A({clusterName:n,namespace:t}):B({params:{clusterName:n,namespace:t}}),e()}})},children:(0,k.jsxs)("a",{children:["集群名称: ",N]})})}]:[]),a()(i?[{title:(0,k.jsx)(l.Z,{modalRender:function(e){return(0,k.jsx)(d.Z,{onCancel:e,clusterName:N,onOk:function(n,t){A?null==A||A({clusterName:n,namespace:t}):B({params:{clusterName:n,namespace:t}}),e()}})},children:(0,k.jsxs)("a",{children:[" 命名空间名称: ",O]})})}]:[]),a()(n||[]))}),(0,k.jsx)("a",{children:(0,k.jsx)(m.Z,{onClick:function(){B()}})})]}),w&&(0,k.jsx)(x.ZP,{type:"primary",onClick:function(){z()},children:"YAML创建资源"})]}),F&&(0,k.jsx)(f.Z,{clusterName:N,onCancel:function(){Y(),B()},onOk:function(){},sourceType:t})]}),b&&b()]})}},36954:function(e,n,t){var i=t(48305),a=t.n(i),r=t(15268),s=t(81798),o=t(34654),c=t(3827),l=t(70334),u=t(91894),d=t(3885),f=t(99790),h=t(69180),m=t(69005),p=t(50959),v=t(11527);n.Z=function(e){var n=e.diffBeforeSubmit,t=void 0===n||n,i=e.onCancel,g=e.clusterName,y=e.defaultValue,x=e.readonly,j=e.title,Z=(0,p.useState)(y||""),C=a()(Z,2),k=C[0],w=C[1],S=(0,p.useState)(!1),P=a()(S,2),b=P[0],A=P[1],L=(0,p.useState)(!1),M=a()(L,2),N=M[0],O=M[1],R=(0,p.useState)("edit"),T=a()(R,2),F=T[0],E=T[1],Y=(0,o.J)();(0,p.useEffect)((function(){x||A(!0)}),[x]);var z=(0,p.useMemo)((function(){return t?"edit"===F?"编辑Yaml":"确认更新":null!=j?j:"YAML创建资源"}),[t,F]);return(0,v.jsxs)(c.Z,{title:z,open:!0,style:{top:20},onCancel:function(){"diff"!==F?null==i||i():E("edit")},maskClosable:!1,okButtonProps:x?{style:{display:"none"}}:{},cancelText:"diff"===F?"上一步":"取消",onOk:function(){k?t&&"edit"===F?E("diff"):(0,r.e7)({yaml:k,cluster_name:g}).then((function(e){c.Z.confirm({title:z,width:800,content:e.success?(0,v.jsx)(u.Z,{message:"检查通过，点击‘应用’执行变更",type:"success",showIcon:!0}):(0,v.jsx)(u.Z,{message:"检查未通过",type:"error",description:e.message,showIcon:!0}),okText:"应用",onOk:function(){(0,r.aA)({yaml:k,cluster_name:g}).then((function(){null==i||i(),l.ZP.success(t?"YAML创建资源成功":"编辑成功"),Y()})).catch((function(e){l.ZP.error(e.reason)}))}})})):l.ZP.warning("请输入YAML")},width:"80vw",children:[(0,v.jsx)(s.Z,{readOnly:x,simplify:b,hideStatus:N,originalValue:y||"",value:k,onChange:function(e){w(e||"")},height:"75vh",diff:"diff"===F}),"diff"!==F&&(0,v.jsx)("div",{style:{position:"relative",height:0},children:(0,v.jsxs)(d.Z,{style:{position:"absolute",top:12},children:[!x&&(0,v.jsx)(f.Z,{beforeUpload:function(e){var n=new FileReader;return n.readAsText(e),n.onload=function(e){var n,t=null===(n=e.target)||void 0===n?void 0:n.result;t&&w(t)},!1},accept:".yaml",showUploadList:!1,children:(0,v.jsx)(h.ZP,{type:"primary",onClick:function(){},children:"导入YAML"})}),(0,v.jsx)(h.ZP,{type:"primary",ghost:!0,onClick:function(){navigator.clipboard.writeText(k).then((function(){l.ZP.success("复制成功")}))},children:"复制"}),y&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(m.Z,{checked:b,onChange:function(e){A(e.target.checked)},children:"精简字段"}),b&&(0,v.jsx)(m.Z,{checked:N,onChange:function(e){O(e.target.checked)},children:"隐藏status字段"})]})]})})]})}},39585:function(e,n,t){t.d(n,{H9:function(){return s},cw:function(){return u},qk:function(){return o},yZ:function(){return c}});var i=t(80487),a=t(32699),r=t.n(a);function s(e){return e.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join("")}function o(e){return""===e||void 0===e?"":1===e.length?e.toLowerCase():e.replace(/([A-Z])([A-Z][a-z])/g,"$1-$2").replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/[^a-zA-Z0-9]+/g,"-").replace(/^-+|-+$/g,"").toLowerCase()}function c(e){if(!e)return"";if(e.startsWith(".")&&-1===e.indexOf(".",1))return e;var n=e.lastIndexOf(".");return n>0?e.slice(0,n):e}function l(e,n){if(e)if(r().isArray(n))n.forEach((function(n){l(e,n)}));else{for(var t=n.split("."),i=e,a=0;a<t.length-1;a++){if(null===i[t[a]])return e;i=i[t[a]]}delete i[t[t.length-1]]}}var u=function(e,n){var t=i.ZP.load(e);return null!=n&&n.simplify&&l(t,["metadata.creationTimestamp","metadata.generation","metadata.resourceVersion","metadata.uid","metadata.managedFields"]),null!=n&&n.hideStatus&&l(t,["status"]),i.ZP.dump(t)}}}]);