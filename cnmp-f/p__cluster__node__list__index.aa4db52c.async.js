"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[3173],{95530:function(e,n,t){t.r(n),t.d(n,{nodeStateMap:function(){return v}});var r=t(90228),a=t.n(r),l=t(87999),i=t.n(l),o=t(30813),s=t(69346),c=t(60148),u=t(13726),d=t(44908),h=t(32030),p=t(59614),m=t(97628),x=t(50959),f=t(11527),v={0:{label:"运行中",color:"#52C41A"},1:{label:"异常",color:"#FF4D4F"}};n.default=function(){var e=(0,h.useParams)().clusterName,n=(0,x.useRef)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.Z,{clusterName:e,items:[{title:"节点管理"}],sourceType:"node",switchCluster:!0}),(0,f.jsx)(s.Z,{actionRef:n,tableProps:{rowKey:"uid",scroll:{x:1800}},placeholder:"模糊搜索节点名称",request:function(){var n=i()(a()().mark((function n(t){var r;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,o.z_)({keyword:t.keyword,page:t.current,page_size:t.pageSize,cluster_name:e});case 2:return r=n.sent,n.abrupt("return",{total:r.total,data:r.list});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),columns:[{title:"名称",dataIndex:"name",render:function(n,t){return(0,f.jsx)(h.Link,{to:"/cluster/".concat(e,"/node/").concat(t.name),children:t.name})},width:160,ellipsis:!0},{title:"状态",dataIndex:"state",width:160,render:function(e,n){var t,r;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{style:{color:(null===(t=v[e])||void 0===t?void 0:t.color)||""},children:null===(r=v[e])||void 0===r?void 0:r.label}),n.unschedulable&&(0,f.jsx)("span",{style:{color:"#FF4D4F"},children:"(已封锁)"})]})}},{title:"健康检查",dataIndex:"health_state",width:240,render:function(e){return(0,f.jsx)(c.Z,{items:e.map((function(e){var n,t;return{value:null===(n=u.E[e])||void 0===n?void 0:n.label,color:null===(t=u.E[e])||void 0===t?void 0:t.color}})),max:3})}},{title:"角色",dataIndex:"roles",render:function(e){return e.join(",")}},{title:"IP",dataIndex:"internal_ip"},{title:"kubelet版本",width:220,dataIndex:"kubelet_version",ellipsis:!0},{title:"系统",width:220,dataIndex:"os_image",ellipsis:!0},{title:"容器引擎",width:220,dataIndex:"container_runtime_version",ellipsis:!0},{title:"创建时间",width:160,dataIndex:"create_time"},{title:"操作",dataIndex:"operation",fixed:"right",render:function(t,r){return(0,f.jsxs)(p.Z,{children:[(0,f.jsx)("a",{onClick:function(){(0,o.nt)({cluster_name:e,name:r.name,operation:"NodeDrain"}).then((function(){var e;m.ZP.success("驱逐成功"),null===(e=n.current)||void 0===e||e.reload()}))},children:"驱逐"}),(0,f.jsx)("a",{onClick:function(){(0,o.nt)({cluster_name:e,name:r.name,operation:r.unschedulable?"NodeUncordon":"NodeCordon"}).then((function(){var e;m.ZP.success(r.unschedulable?"取消封锁成功":"封锁成功"),null===(e=n.current)||void 0===e||e.reload()}))},children:r.unschedulable?"取消封锁":"封锁"})]})}}]})]})}}}]);