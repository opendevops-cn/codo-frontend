"use strict";(self.webpackChunkcnmp=self.webpackChunkcnmp||[]).push([[4348],{49991:function(e,n,a){a.r(n);var l=a(26068),s=a.n(l),r=a(48305),t=a.n(r),i=a(30813),c=a(60396),d=a(58082),o=a(44908),m=a(36970),u=a(32030),x=a(16639),p=a(88934),h=a(97628),j=a(470),Z=a(80699),v=a(24390),b=a(35028),P=(a(50959),a(11527)),f=function(e){var n=e.onCancel,a=e.onOK,l=x.Z.useForm(),r=t()(l,1)[0],c=(0,u.useParams)(),d=c.clusterName,o=void 0===d?"":d,m=c.name,v=void 0===m?"":m,b=c.namespace,f=void 0===b?"":b;return(0,P.jsx)(p.Z,{open:!0,title:"设置扩容步长",width:700,onCancel:n,onOk:function(){r.validateFields().then((function(e){(0,i.kd)(s()({cluster_name:o,name:v,namespace:f},e)).then((function(){a(),h.ZP.success("更新策略成功")}))}))},children:(0,P.jsxs)(x.Z,{labelCol:{span:8},wrapperCol:{span:16},style:{marginTop:20},form:r,children:[(0,P.jsx)(x.Z.Item,{name:"minReadySeconds",label:"minReadySeconds",children:(0,P.jsx)(j.Z,{min:0,placeholder:"请输入最小reday状态的秒数",style:{width:"100%"}})}),(0,P.jsx)(x.Z.Item,{name:"MaxUnavailable",label:"ScaleStrategy.MaxUnavailable",rules:[{pattern:/^-?\d+%?$/,message:"仅允许整数或者百分数"}],children:(0,P.jsx)(Z.Z,{placeholder:"请输入最大不可用pod数，允许整数或百分数"})})]})})},g=function(e){var n=e.onCancel,a=e.onOK,l=x.Z.useForm(),r=t()(l,1)[0],c=(0,u.useParams)(),d=c.clusterName,o=void 0===d?"":d,m=c.name,j=void 0===m?"":m,b=c.namespace,f=void 0===b?"":b;return(0,P.jsx)(p.Z,{title:"更新策略",open:!0,width:600,onCancel:n,onOk:function(){r.validateFields().then((function(e){(0,i.S8)(s()({cluster_name:o,name:j,namespace:f},e)).then((function(){a(),h.ZP.success("更新策略成功")}))}))},children:(0,P.jsxs)(x.Z,{form:r,labelCol:{span:6},children:[(0,P.jsx)(x.Z.Item,{name:"update_strategy_type",label:"更新方式",initialValue:0,children:(0,P.jsxs)(v.ZP.Group,{children:[(0,P.jsx)(v.ZP,{value:0,children:"优先原地升级 InPlaceIfPossible"}),(0,P.jsx)(v.ZP,{value:1,children:"仅原地升级 InPlaceOnly"}),(0,P.jsx)(v.ZP,{value:2,children:"重新创建 Recreate"})]})}),(0,P.jsx)(x.Z.Item,{name:"gracePeriodSeconds",label:"升级等待秒数",tooltip:{title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("p",{children:"gracePeriodSeconds"}),(0,P.jsx)("p",{children:"如果配置了 gracePeriodSeconds 这个字段，控制器在原地升级的过程中会先把 Pod status 改为 not-ready，然后等一段时间（gracePeriodSeconds），最后再去修改 Pod spec 中的镜像版本。"})]}),overlayInnerStyle:{width:630}},rules:[{required:!0,message:"分片不能为空"},{pattern:/^(0|[1-9]\d*)$/,message:"0或者正整数"}],children:(0,P.jsx)(Z.Z,{placeholder:"大于等于0的整数（default：0）"})}),(0,P.jsx)(x.Z.Item,{name:"max_surge",label:"最大超出副本数",initialValue:"25%",rules:[{required:!0,message:"最大超出副本数不能为空"},{pattern:/^(?:[0-9]\d*|100(?:\.0+)?|(?:[0-9]|[1-9]\d)(?:\.\d+)?)%$/,message:"大于等于0的整数，或者正百分数"}],tooltip:{title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("p",{children:"maxSurge"}),(0,P.jsxs)("p",{children:["滚动更新过程中，可以超出期望副本数的最大值。",(0,P.jsx)("br",{}),"该取值可以是一个绝对值（例如：5），也可以是一个相对于期望副本数的百分比（例如：10%）；",(0,P.jsx)("br",{}),"如果填写百分比，则以期望副本数乘以该百分比后向上取整的方式计算对应的绝对值；",(0,P.jsx)("br",{}),"当最大不可用副本数 maxUnavailable 为 0 时，此数值（maxSurge）不能为 0；默认值为 25%。",(0,P.jsx)("br",{}),"例如：假设此值被设定为30%，当滚动更新开始时，新的副本集（ReplicaSet）可以立刻扩容， 但是旧 Pod 和新 Pod 的总数不超过 Deployment 期待副本数（spec.repilcas）的 130%。 一旦旧 Pod 被终止后，新的副本集可以进一步扩容，但是整个滚动更新过程中，新旧 Pod 的总 数不超过 Deployment 期待副本数（spec.repilcas）的 130%。"]})]}),overlayInnerStyle:{width:630}},children:(0,P.jsx)(Z.Z,{placeholder:"大于等于0的整数，或者正百分数（default：25%）"})}),(0,P.jsx)(x.Z.Item,{name:"max_unavailable",label:"最大不可用副本数",initialValue:"25%",rules:[{required:!0,message:"最大不可用副本数不能为空"},{pattern:/^(?:[0-9]\d*|100(?:\.0+)?|(?:[0-9]|[1-9]\d)(?:\.\d+)?)%$/,message:"大于等于0的整数，或者正百分数"}],tooltip:{overlayInnerStyle:{width:630},title:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)("p",{children:"maxUnavailable"}),(0,P.jsxs)("p",{children:["滚动更新过程中，不可用副本数的最大值。",(0,P.jsx)("br",{}),"该取值可以是一个绝对值（例如：5），也可以是一个相对于期望副本数的百分比（例如：10%）；",(0,P.jsx)("br",{}),"如果填写百分比，则以期望副本数乘以该百分比后向下取整的方式计算对应的绝对值；",(0,P.jsx)("br",{}),"当最大超出副本数 maxSurge 为 0 时，此数值（maxUnavailable）不能为 0；默认值为 25%；",(0,P.jsx)("br",{}),"例如：假设此值被设定为 30%，当滚动更新开始时，旧的副本集（ReplicaSet）可以缩容到期望 副本数的 70%；在新副本集扩容的过程中，一旦新的 Pod 已就绪，旧的副本集可以进一步缩容， 整个滚动更新过程中，确保新旧就绪副本数之和不低于期望副本数的 70%。"]})]})},children:(0,P.jsx)(Z.Z,{placeholder:"大于等于0的整数，或者正百分数（default：25%）"})})]})})};n.default=function(){var e=(0,u.useParams)(),n=e.clusterName,a=void 0===n?"":n,l=e.name,s=void 0===l?"":l,r=(0,d.J)();return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(o.Z,{clusterName:a,items:[{title:(0,P.jsx)(u.Link,{to:"/cluster/".concat(a,"/workloads/clone-set"),children:"CloneSet"})},{title:"负载详情：".concat(s)}],sourceType:"clone-set"}),(0,P.jsx)(m.Z,{type:"clone-set",operationRender:function(){return(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(c.Z,{modalRender:function(e){return(0,P.jsx)(f,{onCancel:e,onOK:function(){e(),r()}})},children:(0,P.jsx)(b.ZP,{children:"设置扩容步长"})}),(0,P.jsx)(c.Z,{modalRender:function(e){return(0,P.jsx)(g,{onCancel:e,onOK:function(){e(),r()}})},children:(0,P.jsx)(b.ZP,{children:"更新策略"})})]})}})]})}}}]);